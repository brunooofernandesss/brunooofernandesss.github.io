<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Simulado SUS</title>
  <style>
    body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
    .quiz-container { max-width: 800px; width: 100%; }
    h1 { color: #333; text-align: center; margin-bottom: 30px; }
    .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
    .question { font-weight: bold; margin-bottom: 10px; color: #333; }
    .options { margin-top: 15px; }
    .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
    .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
    .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
    .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
    .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
    .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
    .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
    .submit-btn:hover { background-color: #0056b3; }
    .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
    .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
    .struck-through { text-decoration: line-through; color: #888; }
    .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
    .comment.show { display: block; }
    .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
    .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
    .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
    .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h1 style="text-align:center; margin-bottom: 30px;">Simulado SUS</h1>
    <div class="card-bloco" id="quiz"></div>
    <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
    <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
    <div class="results card-bloco" id="results"></div>
    <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
    <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
      <h2>Diagnóstico de Erros</h2>
      <p>Parece que você precisa revisar os seguintes assuntos:</p>
      <ul id="topicsToReview"></ul>
    </div>
    <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
      <h2>Novas Perguntas Geradas</h2>
      <div id="newQuestionsContent"></div>
    </div>
  </div>

  <script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};
    let totalAnsweredQuestionsByTopic = {};
    let hasErrors = false;

    const questions = [     {         question: "São exemplos de Redes de Atenção à Saúde: I. Rede de Atenção à Saúde Materna e Infantil - Rede Cegonha. II. Rede de Atenção às Urgências e Emergências (RUE). III. Rede de Atenção à Saúde das Pessoas com Doenças Crônicas. IV. Rede de Cuidados à Pessoa com Deficiência. V. Rede de Atenção Psicossocial. Estão corretas as afirmativas:",         options: ["I, II e III apenas", "II, III e V apenas", "I, II, III, IV e V", "II, IV e V apenas", "I, IV e V apenas"],         correctAnswer: "I, II, III, IV e V",         comment: "Todas as alternativas listadas representam redes temáticas prioritárias estabelecidas pelo Ministério da Saúde para organizar o cuidado no SUS.",         topic: "Redes de Atenção à Saúde (RAS)"     },     {         question: "As Redes de Atenção à Saúde (RAS) visam o cuidado integral. Sobre as funções da Atenção Básica nas RAS, preencha os parênteses com (V) para Verdadeiro ou (F) para Falso:\n\n( ) Ser a base: ser o primeiro contato e porta de entrada preferencial da rede.\n( ) Ser resolutiva: identificar riscos e resolver a maioria dos problemas de saúde.\n( ) Ser coordenadora: acompanhar e organizar o fluxo do usuário entre os pontos da rede.\n( ) Ser ordenadora: organizar a rede a partir das necessidades de saúde da população.\n\nA sequência correta é:",         options: ["V-F-V-V", "V-V-V-V", "F-V-V-F", "F-F-V-V"],         correctAnswer: "V-V-V-V",         comment: "A Atenção Básica possui quatro funções fundamentais: ser base, ser resolutiva, coordenar o cuidado e ordenar a rede de atenção.",         topic: "Funções da Atenção Básica"     },     {         question: "Sobre o Sistema Único de Saúde (SUS), qual das seguintes alternativas está correta?",         options: ["O SUS foi criado para atender apenas a população de baixa renda.", "O SUS é baseado nos princípios da universalidade, integralidade e equidade.", "O SUS é financiado exclusivamente por recursos privados.", "O SUS não permite a participação da sociedade nas decisões sobre políticas de saúde."],         correctAnswer: "O SUS é baseado nos princípios da universalidade, integralidade e equidade.",         comment: "Estes são os princípios doutrinários do SUS: acesso a todos (universalidade), cuidado completo (integralidade) e justiça social (equidade).",         topic: "Princípios do SUS"     },     {         question: "Qual o principal objetivo da Política Nacional de Atenção Básica (PNAB)?",         options: ["Financiar hospitais de alta complexidade.", "Organizar a atenção primária à saúde, garantindo o acesso universal e em tempo oportuno.", "Regulamentar a produção de medicamentos.", "Controlar a vigilância sanitária em portos e aeroportos."],         correctAnswer: "Organizar a atenção primária à saúde, garantindo o acesso universal e em tempo oportuno.",         comment: "A PNAB estabelece diretrizes nacionais para o funcionamento da atenção primária, focando no território e na proximidade com o cidadão.",         topic: "Política Nacional de Atenção Básica (PNAB)"     },     {         question: "Qual das seguintes alternativas descreve corretamente o papel dos Agentes Comunitários de Saúde (ACS) e Agentes de Combate a Endemias (ACE)?",         options: ["Realizar cirurgias de alta complexidade em hospitais.", "Coletar e analisar dados epidemiológicos em laboratórios.", "Realizar diagnóstico demográfico, social, cultural, ambiental, epidemiológico e sanitário do território em que atuam.", "Gerenciar os recursos financeiros do SUS em nível nacional."],         correctAnswer: "Realizar diagnóstico demográfico, social, cultural, ambiental, epidemiológico e sanitário do território em que atuam.",         comment: "O papel desses profissionais é fundamental na territorialização, servindo de elo entre a comunidade e a unidade de saúde.",         topic: "Papel do ACS e ACE"     },     {         question: "O que são os Determinantes Sociais da Saúde (DSS)?",         options: ["Medicamentos de alto custo utilizados no tratamento de doenças raras.", "Fatores sociais, econômicos, culturais, étnicos/raciais, psicológicos e comportamentais que influenciam a ocorrência de problemas de saúde.", "Equipamentos de alta tecnologia utilizados em hospitais de referência.", "Indicadores utilizados para medir a qualidade dos serviços de saúde."],         correctAnswer: "Fatores sociais, econômicos, culturais, étnicos/raciais, psicológicos e comportamentais que influenciam a ocorrência de problemas de saúde.",         comment: "Os DSS mostram que as condições em que as pessoas vivem e trabalham impactam diretamente em sua saúde.",         topic: "Determinantes Sociais da Saúde"     },     {         question: "Qual a importância da integração entre a Vigilância em Saúde (VS) e a Atenção Básica (AB)?",         options: ["Reduzir os custos dos serviços de saúde.", "Garantir a integralidade do cuidado e a efetividade das ações de promoção e prevenção.", "Centralizar o poder de decisão nas mãos dos gestores federais.", "Limitar o acesso da população aos serviços de saúde."],         correctAnswer: "Garantir a integralidade do cuidado e a efetividade das ações de promoção e prevenção.",         comment: "A integração garante que as informações sobre riscos no território (vigilância) gerem ações imediatas de cuidado (atenção básica).",         topic: "Integração Vigilância e Atenção Básica"     },     {         question: "Qual é a principal diferença entre as equipes de APS e as equipes de ABS no SUS?",         options: ["As equipes de APS são compostas apenas por médicos, enquanto as equipes de ABS são multiprofissionais.", "As equipes de ABS são focadas em ações de prevenção, enquanto as equipes de APS são focadas em tratamento.", "Não há diferença significativa entre as equipes de APS e as equipes de ABS, sendo os termos frequentemente usados como sinônimos.", "As equipes de APS atuam em áreas urbanas, enquanto as equipes de ABS atuam em áreas rurais."],         correctAnswer: "Não há diferença significativa entre as equipes de APS e as equipes de ABS, sendo os termos frequentemente usados como sinônimos.",         comment: "No Brasil, a PNAB utiliza os termos Atenção Básica e Atenção Primária à Saúde como equivalentes.",         topic: "Conceitos de APS e ABS"     },     {         question: "Qual das seguintes alternativas descreve corretamente a composição de uma equipe de APS?",         options: ["Médico, enfermeiro, técnico de enfermagem e agente comunitário de saúde.", "Médico, enfermeiro e dentista.", "Médico e enfermeiro.", "Médico, enfermeiro, assistente social e psicólogo."],         correctAnswer: "Médico, enfermeiro, técnico de enfermagem e agente comunitário de saúde.",         comment: "Esta é a composição mínima da Equipe de Saúde da Família (eSF) para garantir o cuidado multiprofissional no território.",         topic: "Composição da Equipe de Saúde"     },     {         question: "Qual é o principal objetivo das equipes de APS e ABS no SUS?",         options: ["Realizar cirurgias de alta complexidade.", "Coordenar o cuidado dos usuários na rede de atenção à saúde.", "Realizar exames de imagem de alta tecnologia.", "Gerenciar hospitais de grande porte."],         correctAnswer: "Coordenar o cuidado dos usuários na rede de atenção à saúde.",         comment: "A APS funciona como o 'maestro' da rede, garantindo que o paciente receba o cuidado necessário em todos os níveis.",         topic: "Objetivos da APS"     },     {         question: "Qual das seguintes alternativas descreve uma característica da atuação das equipes de APS e ABS?",         options: ["Atendimento pontual e focado em doenças específicas.", "Ações de promoção da saúde, prevenção de doenças e tratamento.", "Realização de transplantes de órgãos.", "Atendimento exclusivo a pacientes com doenças crônicas."],         correctAnswer: "Ações de promoção da saúde, prevenção de doenças e tratamento.",         comment: "O trabalho da APS é longitudinal e integral, abordando desde a promoção de hábitos saudáveis até o tratamento clínico.",         topic: "Atuação na Atenção Primária"     },     {         question: "Qual das seguintes alternativas descreve corretamente a relação entre APS e ABS no contexto do SUS?",         options: ["APS e ABS são modelos de atenção à saúde distintos, com objetivos e composições diferentes.", "APS é um modelo de atenção à saúde mais abrangente que o ABS.", "ABS é um modelo de atenção à saúde mais abrangente que o APS.", "APS e ABS são termos utilizados como sinônimos no contexto do SUS, referindo-se à atenção primária à saúde."],         correctAnswer: "APS e ABS são termos utilizados como sinônimos no contexto do SUS, referindo-se à atenção primária à saúde.",         comment: "A Política Nacional de Atenção Básica (PNAB) unifica esses conceitos no ordenamento jurídico do SUS.",         topic: "Relação APS e ABS"     },     {         question: "Qual o principal objetivo da PNAB?",         options: ["Financiar hospitais de alta complexidade.", "Fortalecer a atenção primária à saúde como porta de entrada do SUS.", "Regulamentar a produção de medicamentos.", "Controlar epidemias e pandemias."],         correctAnswer: "Fortalecer a atenção primária à saúde como porta de entrada do SUS.",         comment: "O fortalecimento da PNAB visa tornar a atenção básica a ordenadora de toda a rede de saúde.",         topic: "Objetivos da PNAB"     },     {         question: "Qual o principal objetivo da PNVS?",         options: ["Garantir o acesso a planos de saúde privados.", "Monitorar e responder a ameaças à saúde pública.", "Construir hospitais e unidades de saúde.", "Formar profissionais de saúde."],         correctAnswer: "Monitorar e responder a ameaças à saúde pública.",         comment: "A Política Nacional de Vigilância em Saúde foca na prevenção de agravos através do monitoramento contínuo de dados.",         topic: "Política Nacional de Vigilância em Saúde (PNVS)"     },     {         question: "Qual das seguintes características é central para a PNAB?",         options: ["Ênfase em procedimentos hospitalares complexos.", "Atuação em saúde individual e coletiva, com foco na prevenção.", "Centralização da gestão em nível federal.", "Atendimento exclusivo a casos de emergência."],         correctAnswer: "Atuação em saúde individual e coletiva, com foco na prevenção.",         comment: "A PNAB atua diretamente nas famílias e comunidades, focando na prevenção de doenças e promoção da saúde.",         topic: "Características da PNAB"     },     {         question: "Qual das seguintes características é central para a PNVS?",         options: ["Atendimento individualizado em consultórios privados.", "Monitoramento contínuo de riscos e agravos à saúde.", "Foco exclusivo em doenças transmissíveis.", "Gestão descentralizada, com participação da comunidade."],         correctAnswer: "Monitoramento contínuo de riscos e agravos à saúde.",         comment: "A vigilância monitora doenças transmissíveis, não transmissíveis e riscos ambientais.",         topic: "Características da PNVS"     },     {         question: "Como a PNAB e a PNVS se relacionam?",         options: ["São políticas independentes, sem interação.", "A PNAB financia a PNVS.", "A PNVS define as diretrizes para a PNAB.", "Ambas atuam de forma integrada na promoção, prevenção e proteção da saúde."],         correctAnswer: "Ambas atuam de forma integrada na promoção, prevenção e proteção da saúde.",         comment: "A integração entre estas políticas é o que garante que o SUS seja eficiente em prevenir doenças antes que elas se tornem graves.",         topic: "Integração PNAB e PNVS"     },     {         question: "Qual a importância da integração entre PNAB e PNVS?",         options: ["Reduzir custos com saúde pública.", "Garantir a continuidade do cuidado e a vigilância em saúde.", "Fortalecer a atuação de planos de saúde privados.", "Diminuir a participação da comunidade na gestão da saúde."],         correctAnswer: "Garantir a continuidade do cuidado e a vigilância em saúde.",         comment: "A integração permite um olhar territorial único, onde o cuidado clínico e o monitoramento epidemiológico caminham juntos.",         topic: "Importância da Integração"     },     {         question: "Qual das seguintes ações faz parte do escopo da PNVS?",         options: ["Realização de cirurgias de alta complexidade.", "Vacinação e controle de endemias.", "Prescrição de medicamentos controlados.", "Gestão de planos de saúde privados."],         correctAnswer: "Vacinação e controle de endemias.",         comment: "A vacinação é uma das principais estratégias de vigilância epidemiológica no Brasil.",         topic: "Ações de Vigilância em Saúde"     },     {         question: "Qual das seguintes ações faz parte do escopo da PNAB?",         options: ["Monitoramento da qualidade da água e do ar.", "Realização de exames laboratoriais de alta complexidade.", "Acompanhamento de doenças crônicas e promoção da saúde.", "Controle de vetores de doenças transmissíveis."],         correctAnswer: "Acompanhamento de doenças crônicas e promoção da saúde.",         comment: "O acompanhamento de hipertensos e diabéticos no território é uma atividade típica e essencial da Atenção Básica.",         topic: "Ações da Atenção Básica"     },     {         question: "O que significa \"população adscrita\" no contexto do SUS?",         options: ["A população que utiliza planos de saúde privados.", "O número total de habitantes de um município.", "O grupo de pessoas sob a responsabilidade de uma equipe de saúde em uma UBS.", "A população que necessita de atendimento hospitalar de alta complexidade."],         correctAnswer: "O grupo de pessoas sob a responsabilidade de uma equipe de saúde em uma UBS.",         comment: "A adscrição cria um vínculo de responsabilidade mútua entre o cidadão e os profissionais de saúde.",         topic: "População Adscrita"     },     {         question: "Qual o principal objetivo da adscrição da população no SUS?",         options: ["Reduzir o número de pacientes nas UBSs.", "Criar um vínculo entre a equipe de saúde e a população, promovendo cuidado contínuo.", "Facilitar o acesso a planos de saúde privados.", "Centralizar o atendimento em grandes hospitais."],         correctAnswer: "Criar um vínculo entre a equipe de saúde e a população, promovendo cuidado contínuo.",         comment: "Ao adscrever uma população, garante-se que ninguém fique sem referência de cuidado no sistema.",         topic: "Objetivos da Adscrição"     },     {         question: "Como a territorialização se relaciona com a população adscrita?",         options: ["A territorialização ignora a localização geográfica dos pacientes.", "A população adscrita é definida por um território geográfico específico.", "A territorialização se aplica apenas a hospitais, não a UBSs.", "A territorialização dificulta o planejamento de ações de saúde."],         correctAnswer: "A população adscrita é definida por um território geográfico específico.",         comment: "A territorialização divide o município em áreas menores para que cada equipe cuide de quem mora ali.",         topic: "Territorialização"     },     {         question: "Qual a importância da população adscrita para o planejamento e gestão do SUS?",         options: ["Não há relação entre a população adscrita e o planejamento do SUS.", "A população adscrita dificulta a organização dos serviços de saúde.", "O conhecimento da população adscrita permite adequar a oferta de serviços às necessidades da demanda.", "A população adscrita só é relevante para hospitais privados."],         correctAnswer: "O conhecimento da população adscrita permite adequar a oferta de serviços às necessidades da demanda.",         comment: "Ao conhecer o perfil de quem mora no território, o gestor pode planejar ações específicas para aquele perfil populacional.",         topic: "Gestão e Planejamento"     },     {         question: "Qual das seguintes alternativas descreve melhor o benefício da adscrição para o paciente?",         options: ["O paciente precisa procurar atendimento em diferentes UBSs a cada consulta.", "O paciente tem um ponto de referência para o cuidado de sua saúde, facilitando o acompanhamento.", "O paciente só tem acesso a atendimentos de emergência.", "O paciente é encaminhado diretamente para hospitais de alta complexidade."],         correctAnswer: "O paciente tem um ponto de referência para o cuidado de sua saúde, facilitando o acompanhamento.",         comment: "A adscrição reduz a fragmentação do cuidado, pois o paciente sabe exatamente a quem recorrer.",         topic: "Benefícios da Adscrição"     },     {         question: "Qual dos seguintes órgãos é responsável por formular políticas nacionais de saúde no Brasil?",         options: ["Secretaria Estadual de Saúde", "Ministério da Saúde", "Conselho Municipal de Saúde", "Comissão Intergestores Bipartite (CIB)"],         correctAnswer: "Ministério da Saúde",         comment: "O Ministério da Saúde é o gestor federal e tem a função de normatizar as políticas para todo o território nacional.",         topic: "Gestão do SUS"     },     {         question: "As Comissões Intergestores Tripartite (CIT) e Bipartite (CIB) têm como principal função:",         options: ["Fiscalizar a aplicação de recursos do SUS.", "Negociar e pactuar diretrizes de saúde entre os níveis de governo.", "Coordenar a vigilância sanitária em áreas estratégicas.", "Fornecer a lista municipal de medicamentos."],         correctAnswer: "Negociar e pactuar diretrizes de saúde entre os níveis de governo.",         comment: "A CIT ocorre no nível federal (União, Estados e Municípios) e a CIB no nível estadual (Estado e Municípios).",         topic: "Instâncias de Pactuação"     },     {         question: "Qual nível de governo é responsável por coordenar o sistema de saúde local?",         options: ["Governo Federal", "Governo Estadual", "Governo Municipal", "Todos os níveis de governo"],         correctAnswer: "Governo Municipal",         comment: "A saúde é municipalizada no Brasil, cabendo ao município a gestão direta da maioria dos serviços de saúde.",         topic: "Níveis de Governo no SUS"     },     {         question: "Os Conselhos de Saúde, em suas diferentes esferas (nacional, estadual e municipal), representam:",         options: ["Apenas os profissionais de saúde.", "Apenas o governo.", "A sociedade civil e fiscalizam a gestão do SUS.", "Apenas os prestadores de serviços privados de saúde."],         correctAnswer: "A sociedade civil e fiscalizam a gestão do SUS.",         comment: "O conselho é um órgão paritário: 50% são usuários, 25% trabalhadores da saúde e 25% gestores/prestadores.",         topic: "Controle Social"     },     {         question: "A Câmara de Regulação do Mercado de Medicamentos tem como atribuição:",         options: ["Coordenar a vigilância sanitária.", "Definir os preços dos medicamentos.", "Financiar serviços de saúde locais.", "Organizar o sistema de saúde regional."],         correctAnswer: "Definir os preços dos medicamentos.",         comment: "A CMED regula o teto de preços para garantir a sustentabilidade do sistema e o acesso da população.",         topic: "Regulação em Saúde"     },     {         question: "A entrega de programas estratégicos e medicamentos é responsabilidade de qual nível de governo?",         options: ["Governo Federal", "Governo Estadual", "Governo Municipal", "Todos os níveis de governo, em conjunto"],         correctAnswer: "Governo Estadual",         comment: "Os estados atuam no apoio logístico e na distribuição de itens de programas estratégicos para as prefeituras.",         topic: "Responsabilidades Federativas"     },     {         question: "As Conferências de Saúde são espaços para:",         options: ["Apenas profissionais de saúde discutirem questões técnicas.", "Apenas o governo definir as políticas de saúde.", "A sociedade civil debater e formular políticas de saúde."],         correctAnswer: "A sociedade civil debater e formular políticas de saúde.",         comment: "A conferência é o momento máximo da democracia no SUS, onde usuários e governo planejam os próximos 4 anos.",         topic: "Participação Social"     } ];

    function buildQuiz() {
      const output = [];
      questions.forEach((currentQuestion, questionNumber) => {
        const options = [];
        for (let i = 0; i < currentQuestion.options.length; i++) {
          options.push(`<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}"><img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">${currentQuestion.options[i]}</label>`);
        }
        output.push(`<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}"><div class="question">${currentQuestion.question}</div><div class="options">${options.join("")}</div><div class="comment" id="comment-${questionNumber}"></div></div>`);
      });
      quizContainer.innerHTML = output.join("");
    }

    function showResults() {
      // Lógica de resultados... (simplificada para o exemplo)
    }

    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '⏳ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        const topics = Object.keys(errorCountByTopic).filter(topic => (errorCountByTopic[topic] || 0) > 0);
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];
        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            const data = await response.json();
            newQuestionsContent.innerHTML = '';
            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            }
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '✅ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '❌ Erro: ' + error.message;
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
  </script>
  <script src="conexao_firebase.js"></script>
  <script src="navegacao.js"></script>
  <script type="module" src="padrao_simulado.js"></script>
</body>
</html>
