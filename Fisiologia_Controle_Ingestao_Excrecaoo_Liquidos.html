<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Controle de Ingest√£o e Excre√ß√£o de L√≠quidos</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      min-height: 100vh;
      background-color: #f4f4f4;
    }

    .quiz-container {
      max-width: 800px;
      width: 100%;
    }

    h1 {
      color: #333;
      text-align: center;
      margin-bottom: 30px;
    }

    .card {
      background-color: white;
      border-radius: 8px;
      padding: 20px;
      margin-bottom: 20px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .question {
      font-weight: bold;
      margin-bottom: 10px;
      color: #333;
    }

    .options {
      margin-top: 15px;
    }

    /* Estilos unificados para todas as op√ß√µes (est√°ticas e din√¢micas) */
    .option, label.option, label, #newQuestionsContent label {
      display: flex; /* Para alinhar imagem e texto */
      align-items: center;
      margin-bottom: 10px;
      padding: 10px;
      border: 1px solid #ddd;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      position: relative; /* Para posicionar a tesoura */
    }

    /* FOR√áA a remo√ß√£o de inputs de radio em QUALQUER lugar */
    .option input[type="radio"], 
    label input[type="radio"],
    #newQuestionsContent input[type="radio"],
    #newQuestionsContent label input[type="radio"] {
        display: none !important;
        visibility: hidden !important;
        opacity: 0 !important;
        position: absolute !important;
        left: -9999px !important;
    }

    .option:hover, 
    label.option:hover, 
    label:hover,
    #newQuestionsContent label:hover {
      background-color: #e9e9e9;
    }

    .option.selected, 
    label.option.selected, 
    label.selected,
    #newQuestionsContent label.selected {
      background-color: #d1e7dd;
      border-color: #28a745;
    }

    .option.correct, 
    label.option.correct, 
    label.correct,
    #newQuestionsContent label.correct {
      background-color: #d4edda;
      border-color: #28a745;
    }

    .option.incorrect, 
    label.option.incorrect, 
    label.incorrect,
    #newQuestionsContent label.incorrect {
      background-color: #f8d7da;
      border-color: #dc3545;
    }

    .submit-btn {
      display: block;
      width: 100%;
      padding: 15px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 18px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 30px;
    }

    .submit-btn:hover {
      background-color: #0056b3;
    }

    .results {
      text-align: center;
      margin-top: 30px;
      font-size: 20px;
      font-weight: bold;
      color: #333;
    }

    .scissor-icon {
      margin-right: 10px; /* Espa√ßo entre a tesoura e o texto da op√ß√£o */
      width: 20px; /* Ajuste conforme o tamanho da sua imagem */
      height: 20px; /* Ajuste conforme o tamanho da sua imagem */
      opacity: 0.5; /* Transpar√™ncia como no original */
      cursor: pointer;
    }

    .scissor-icon.hidden {
      display: none;
    }

    .struck-through {
      text-decoration: line-through;
      color: #888;
    }

    .comment {
      margin-top: 10px;
      padding: 10px;
      background-color: #f0f0f0;
      border-left: 4px solid #007bff;
      font-style: italic;
      color: #555;
      display: none; /* Escondido por padr√£o */
    }
    .comment.show {
      display: block; /* Mostrado quando ativado */
    }

    /* Estilos para o bot√£o de navega√ß√£o de erro / diagn√≥stico */
    .error-nav-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background-color: #dc3545; /* Vermelho para erro */
      color: white;
      border: none;
      border-radius: 50%; /* Torna o bot√£o redondo */
      width: 60px;
      height: 60px;
      font-size: 24px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      z-index: 1000;
      display: none; /* Escondido por padr√£o */
      flex-direction: column; /* Para empilhar o √≠cone e o contador */
      padding: 5px; /* Ajuste o padding para acomodar texto maior */
      box-sizing: border-box; /* Garante que padding n√£o aumente o tamanho total */
      text-align: center;
    }

    .error-nav-btn:hover {
      background-color: #c82333;
    }

    .error-nav-btn .arrow-icon {
      font-size: 30px; /* Tamanho da seta */
      line-height: 1; /* Ajuste para centralizar */
    }

    .error-nav-btn .button-text {
      font-size: 12px; /* Tamanho do texto abaixo da seta */
      line-height: 1;
      margin-top: 2px; /* Espa√ßo entre a seta e o texto */
    }

    /* Estilos para a se√ß√£o de diagn√≥stico de erros */
    .error-diagnosis-section {
        margin-top: 50px;
        padding: 30px;
        background-color: #ffe0b2; /* Um laranja claro ou similar */
        border-radius: 8px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        display: none; /* Escondido por padr√£o */
        text-align: center;
        font-size: 1.1em;
        color: #333;
    }

    .error-diagnosis-section h2 {
        color: #e65100; /* Laranja mais escuro */
        margin-bottom: 20px;
        font-size: 1.8em;
    }

    .error-diagnosis-section ul {
        list-style: none; /* Remove marcadores de lista */
        padding: 0;
        margin: 0;
    }

    .error-diagnosis-section li {
        background-color: #ff9800; /* Laranja */
        color: white;
        padding: 8px 15px;
        margin: 8px 0;
        border-radius: 5px;
        display: inline-block; /* Para que os itens fiquem lado a lado */
        margin-right: 10px;
        font-weight: bold;
    }
    .error-diagnosis-section li:last-child {
        margin-right: 0;
    }
 .card-bloco {
      border: 1px solid #ddd;
      border-radius: 6px;
      padding: 10px;
      background: #fff;
      margin-bottom: 20px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }
  </style>
</head>
<body>
  <div class="quiz-container">
    <h1 style="text-align:center; margin-bottom: 30px;">Controle de Ingest√£o e Excre√ß√£o de L√≠quidos</h1>
    <div class="card-bloco" id="quiz"></div>
    <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>

    <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">
      Gerar Novas Perguntas
    </button>

    <div class="results card-bloco" id="results"></div>
    <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>

    <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
      <h2>Diagn√≥stico de Erros</h2>
      <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
      <ul id="topicsToReview"></ul>
    </div>

    <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
      <h2>Novas Perguntas Geradas</h2>
      <div id="newQuestionsContent"></div>
    </div>
  </div>
  
  <button class="error-nav-btn" id="errorNavBtn" style="display:none;">
    <span class="arrow-icon"></span>
    <span class="button-text"></span>
  </button>

  <script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorNavBtn = document.getElementById("errorNavBtn");
    const arrowIcon = errorNavBtn.querySelector(".arrow-icon");
    const buttonText = errorNavBtn.querySelector(".button-text");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};
    let totalAnsweredQuestionsByTopic = {};
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;
    let isShowingErrors = false;
    let isShowingDiagnosis = false;

    // Inicializa a visibilidade das se√ß√µes no carregamento
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

          const questions = [         {           question:             "1. Qual √© a porcentagem aproximada de √°gua no organismo humano adulto, conforme o slide de introdu√ß√£o?",           options: [             "a) 40% a 50%",             "b) 60% a 70%",             "c) 80% a 90%",             "d) 30% a 40%",           ],           correctAnswer: "b) 60% a 70%",           comment:             "O primeiro slide informa que o organismo humano √© composto por aproximadamente 60% a 70% de √°gua, sendo um valor m√©dio para adultos.",           topic: "√Ågua Corporal Total",         },         {           question:             "2. Comparando homens e mulheres adultos, quem geralmente possui maior quantidade de √°gua no corpo e por qual motivo, segundo os slides?",           options: [             "a) Mulheres, devido √† maior massa muscular.",             "b) Homens, devido √† maior massa muscular.",             "c) Mulheres, devido √† maior propor√ß√£o de c√©lulas adiposas.",             "d) Homens, devido √† menor propor√ß√£o de c√©lulas adiposas.",           ],           correctAnswer: "b) Homens, devido √† maior massa muscular.",           comment:             "Os slides mencionam que homens geralmente possuem maior quantidade de √°gua devido √† maior massa muscular, j√° que o tecido muscular cont√©m mais √°gua que o tecido adiposo.",           topic: "Varia√ß√£o da √Ågua Corporal",         },         {           question:             "3. Qual √© a principal fun√ß√£o do Compartimento Intracelular (LIC)?",           options: [             "a) Transporte de nutrientes e oxig√™nio para as c√©lulas.",             "b) Armazenamento de eletr√≥litos e sol√∫veis para uso futuro.",             "c) Desempenhar papel fundamental em processos celulares como metabolismo e fun√ß√£o enzim√°tica.",             "d) Manter a press√£o arterial est√°vel.",           ],           correctAnswer: "c) Desempenhar papel fundamental em processos celulares como metabolismo e fun√ß√£o enzim√°tica.",           comment:             "O Compartimento Intracelular (LIC) √© o fluido dentro das c√©lulas, onde ocorrem a maioria das rea√ß√µes metab√≥licas e as fun√ß√µes vitais da c√©lula.",           topic: "Compartimento Intracelular",         },         {           question:             "4. Qual eletr√≥lito √© o principal c√°tion no l√≠quido extracelular (LEC)?",           options: [             "a) Pot√°ssio (K‚Å∫).",             "b) C√°lcio (Ca¬≤‚Å∫).",             "c) S√≥dio (Na‚Å∫).",             "d) Magn√©sio (Mg¬≤‚Å∫).",           ],           correctAnswer: "c) S√≥dio (Na‚Å∫).",           comment:             "O s√≥dio (Na‚Å∫) √© o eletr√≥lito mais abundante e o principal c√°tion no l√≠quido extracelular, sendo crucial para a osmolalidade e o volume do LEC.",           topic: "Eletr√≥litos do LEC",         },         {           question:             "5. A barreira que separa o l√≠quido intravascular do l√≠quido intersticial √©:",           options: [             "a) A membrana celular.",             "b) A membrana nuclear.",             "c) A parede capilar.",             "d) A membrana plasm√°tica.",           ],           correctAnswer: "c) A parede capilar.",           comment:             "A parede capilar √© a barreira semiperme√°vel que permite a troca de √°gua e pequenos solutos entre o plasma (l√≠quido intravascular) e o l√≠quido intersticial.",           topic: "Barreiras entre Compartimentos",         },         {           question:             "6. A ingest√£o di√°ria de l√≠quidos (principalmente √°gua) por um adulto, proveniente de l√≠quidos e alimentos, √© de aproximadamente:",           options: [             "a) 500 mL.",             "b) 1.000 mL.",             "c) 2.000 a 2.500 mL.",             "d) 5.000 mL.",           ],           correctAnswer: "c) 2.000 a 2.500 mL.",           comment:             "Os slides indicam que a ingest√£o di√°ria total de l√≠quidos, incluindo l√≠quidos ingeridos e √°gua presente nos alimentos, √© de cerca de 2.000 a 2.500 mL.",           topic: "Balan√ßo H√≠drico: Ingest√£o",         },         {           question:             "7. Qual √© a principal forma de perda de l√≠quidos no organismo, al√©m da excre√ß√£o renal?",           options: [             "a) Perdas gastrointestinais (fezes).",             "b) Perdas insens√≠veis (pele e respira√ß√£o).",             "c) Suor.",             "d) Perda por v√¥mito.",           ],           correctAnswer: "b) Perdas insens√≠veis (pele e respira√ß√£o).",           comment:             "As perdas insens√≠veis (√°gua que se evapora da pele e do trato respirat√≥rio) s√£o uma forma cont√≠nua e n√£o mensur√°vel de perda de l√≠quidos, que ocorre mesmo em repouso e sem suor vis√≠vel.",           topic: "Balan√ßo H√≠drico: Perdas Insens√≠veis",         },         {           question:             "8. A 'sede' √© um mecanismo fisiol√≥gico que responde principalmente a qual altera√ß√£o no organismo?",           options: [             "a) Aumento da press√£o arterial.",             "b) Diminui√ß√£o da osmolalidade plasm√°tica.",             "c) Aumento da osmolalidade plasm√°tica (desidrata√ß√£o celular).",             "d) Aumento do volume sangu√≠neo.",           ],           correctAnswer: "c) Aumento da osmolalidade plasm√°tica (desidrata√ß√£o celular).",           comment:             "A sede √© o principal mecanismo de controle da ingest√£o de √°gua, sendo ativada pelos osmorreceptores hipotal√¢micos em resposta a um aumento na osmolalidade plasm√°tica (ou seja, quando o plasma fica mais concentrado e as c√©lulas desidratam).",           topic: "Mecanismo da Sede",         },         {           question:             "9. Qual horm√¥nio √© liberado pela neuro-hip√≥fise em resposta a um aumento da osmolalidade plasm√°tica e/ou diminui√ß√£o do volume sangu√≠neo?",           options: [             "a) Aldosterona.",             "b) Horm√¥nio Antidiur√©tico (ADH) ou Vasopressina.",             "c) Pept√≠deo Natriur√©tico Atrial (ANP).",             "d) Angiotensina II.",           ],           correctAnswer: "b) Horm√¥nio Antidiur√©tico (ADH) ou Vasopressina.",           comment:             "O ADH √© o principal horm√¥nio que regula a reabsor√ß√£o de √°gua nos t√∫bulos renais. Sua libera√ß√£o √© estimulada pelo aumento da osmolalidade plasm√°tica e pela diminui√ß√£o do volume sangu√≠neo, visando reter √°gua no corpo.",           topic: "Horm√¥nio Antidiur√©tico (ADH)",         },         {           question:             "10. O ADH atua principalmente em qual parte do n√©fron para aumentar a reabsor√ß√£o de √°gua?",           options: [             "a) Glom√©rulo.",             "b) T√∫bulo contorcido proximal.",             "c) Al√ßa de Henle ascendente.",             "d) T√∫bulos coletores e t√∫bulo contorcido distal.",           ],           correctAnswer: "d) T√∫bulos coletores e t√∫bulo contorcido distal.",           comment:             "O ADH aumenta a permeabilidade √† √°gua nos t√∫bulos coletores e no t√∫bulo contorcido distal, inserindo aquaporinas e permitindo a reabsor√ß√£o de √°gua livre para o interst√≠cio medular concentrado.",           topic: "A√ß√£o do ADH no Rim",         },         {           question:             "11. Qual √© o principal efeito do sistema Renina-Angiotensina-Aldosterona (SRAA) na regula√ß√£o do volume de l√≠quidos?",           options: [             "a) Aumento da excre√ß√£o de s√≥dio e √°gua.",             "b) Vasodilata√ß√£o e diminui√ß√£o da press√£o arterial.",             "c) Reabsor√ß√£o de s√≥dio e √°gua, e vasoconstri√ß√£o, aumentando a press√£o arterial.",             "d) Inibi√ß√£o da sede.",           ],           correctAnswer: "c) Reabsor√ß√£o de s√≥dio e √°gua, e vasoconstri√ß√£o, aumentando a press√£o arterial.",           comment:             "O SRAA √© ativado em resposta √† diminui√ß√£o do volume sangu√≠neo e da press√£o arterial. A angiotensina II e a aldosterona agem para reter s√≥dio e √°gua, al√©m de causar vasoconstri√ß√£o, elevando o volume e a press√£o.",           topic: "Sistema Renina-Angiotensina-Aldosterona (SRAA)",         },         {           question:             "12. A aldosterona, horm√¥nio do SRAA, atua principalmente para aumentar a reabsor√ß√£o de:",           options: [             "a) √Ågua no t√∫bulo distal.",             "b) S√≥dio e secre√ß√£o de pot√°ssio nos t√∫bulos renais.",             "c) Glicose no t√∫bulo proximal.",             "d) Bicarbonato.",           ],           correctAnswer: "b) S√≥dio e secre√ß√£o de pot√°ssio nos t√∫bulos renais.",           comment:             "A aldosterona, liberada pelo c√≥rtex adrenal, age nos t√∫bulos distais e coletores do rim para aumentar a reabsor√ß√£o de s√≥dio (e, consequentemente, √°gua) e a secre√ß√£o de pot√°ssio e √≠ons hidrog√™nio.",           topic: "A√ß√£o da Aldosterona",         },         {           question:             "13. O Pept√≠deo Natriur√©tico Atrial (ANP) √© liberado em resposta a qual est√≠mulo?",           options: [             "a) Diminui√ß√£o da press√£o arterial.",             "b) Aumento do volume sangu√≠neo (estiramento atrial).",             "c) Aumento da osmolalidade plasm√°tica.",             "d) Hipocalemia.",           ],           correctAnswer: "b) Aumento do volume sangu√≠neo (estiramento atrial).",           comment:             "O ANP √© um horm√¥nio liberado pelos √°trios card√≠acos em resposta ao estiramento atrial (indicando aumento do volume sangu√≠neo). Ele atua para promover a natriurese (excre√ß√£o de s√≥dio) e a diurese (excre√ß√£o de √°gua), ajudando a reduzir o volume sangu√≠neo e a press√£o arterial.",           topic: "Pept√≠deo Natriur√©tico Atrial (ANP)",         },         {           question:             "14. Qual √© o efeito principal do ANP na fun√ß√£o renal?",           options: [             "a) Aumento da reabsor√ß√£o de s√≥dio.",             "b) Diminui√ß√£o da taxa de filtra√ß√£o glomerular (TFG).",             "c) Aumento da excre√ß√£o de s√≥dio e √°gua.",             "d) Est√≠mulo √† libera√ß√£o de ADH.",           ],           correctAnswer: "c) Aumento da excre√ß√£o de s√≥dio e √°gua.",           comment:             "O ANP promove a natriurese e a diurese ao aumentar a TFG, inibir a reabsor√ß√£o de s√≥dio e inibir a libera√ß√£o de renina e aldosterona, ajudando a diminuir o volume sangu√≠neo.",           topic: "Efeitos do ANP",         },         {           question:             "15. A hipernatremia (s√≥dio elevado no sangue) √© mais frequentemente associada a qual desequil√≠brio h√≠drico?",           options: [             "a) Hipervolemia.",             "b) Hipovolemia.",             "c) Desidrata√ß√£o (perda de √°gua maior que a de s√≥dio).",             "d) Edema.",           ],           correctAnswer: "c) Desidrata√ß√£o (perda de √°gua maior que a de s√≥dio).",           comment:             "A hipernatremia geralmente indica um d√©ficit de √°gua em rela√ß√£o ao s√≥dio no corpo. Isso pode ser por perda excessiva de √°gua (como em diabetes insipidus ou febre alta) ou ingest√£o insuficiente de √°gua, resultando em desidrata√ß√£o celular.",           topic: "Hipernatremia",         },         {           question:             "16. A hiponatremia (s√≥dio baixo no sangue) pode ser causada por:",           options: [             "a) Desidrata√ß√£o severa.",             "b) Ingest√£o excessiva de s√≥dio.",             "c) Ingest√£o excessiva de √°gua em rela√ß√£o ao s√≥dio ou perda excessiva de s√≥dio.",             "d) Diabetes insipidus.",           ],           correctAnswer: "c) Ingest√£o excessiva de √°gua em rela√ß√£o ao s√≥dio ou perda excessiva de s√≥dio.",           comment:             "A hiponatremia ocorre quando h√° um excesso de √°gua em rela√ß√£o ao s√≥dio no plasma (dilui√ß√£o) ou uma perda real de s√≥dio do corpo, como em casos de SIADH (s√≠ndrome de secre√ß√£o inapropriada de ADH) ou diur√©ticos que promovem a excre√ß√£o de s√≥dio.",           topic: "Hiponatremia",         },         {           question:             "17. Qual √© a principal consequ√™ncia da hipercalemia (pot√°ssio elevado no sangue)?",           options: [             "a) Aumento da press√£o arterial.",             "b) Dist√∫rbios card√≠acos graves (arritmias).",             "c) Edema generalizado.",             "d) Aumento da produ√ß√£o de urina.",           ],           correctAnswer: "b) Dist√∫rbios card√≠acos graves (arritmias).",           comment:             "A hipercalemia √© uma emerg√™ncia m√©dica devido aos seus efeitos potencialmente fatais no cora√ß√£o, podendo causar arritmias e parada card√≠aca.",           topic: "Hipercalemia",         },         {           question:             "18. A principal causa de hipocalemia (pot√°ssio baixo no sangue) √© frequentemente associada a:",           options: [             "a) Insufici√™ncia renal cr√¥nica.",             "b) Uso de diur√©ticos de al√ßa ou tiaz√≠dicos, v√¥mitos e diarreia.",             "c) Ingest√£o excessiva de pot√°ssio.",             "d) Trauma muscular.",           ],           correctAnswer: "b) Uso de diur√©ticos de al√ßa ou tiaz√≠dicos, v√¥mitos e diarreia.",           comment:             "Diur√©ticos (especialmente os de al√ßa e tiaz√≠dicos) e perdas gastrointestinais (v√¥mitos e diarreia) s√£o causas comuns de hipocalemia, pois promovem a excre√ß√£o de pot√°ssio.",           topic: "Hipocalemia",         },         {           question:             "19. Em casos de choque hipovol√™mico, o corpo tenta compensar a perda de volume sangu√≠neo ativando qual sistema?",           options: [             "a) Sistema Parassimp√°tico.",             "b) Sistema Renina-Angiotensina-Aldosterona (SRAA).",             "c) Libera√ß√£o de Pept√≠deo Natriur√©tico Atrial (ANP).",             "d) Diminui√ß√£o da libera√ß√£o de ADH.",           ],           correctAnswer: "b) Sistema Renina-Angiotensina-Aldosterona (SRAA).",           comment:             "O SRAA √© um dos principais sistemas de defesa do corpo contra a hipovolemia. Ele √© ativado pela diminui√ß√£o da perfus√£o renal e atua para reter s√≥dio e √°gua e causar vasoconstri√ß√£o, ajudando a restaurar o volume sangu√≠neo e a press√£o arterial.",           topic: "Choque Hipovol√™mico e SRAA",         },         {           question:             "20. Qual √© a fun√ß√£o prim√°ria dos rins na regula√ß√£o do balan√ßo h√≠drico e eletrol√≠tico?",           options: [             "a) Produ√ß√£o de horm√¥nios digestivos.",             "b) Excre√ß√£o de CO‚ÇÇ.",             "c) Filtrar o sangue, reabsorver subst√¢ncias √∫teis e excretar res√≠duos e excessos de √°gua e eletr√≥litos.",             "d) Armazenar glicog√™nio.",           ],           correctAnswer: "c) Filtrar o sangue, reabsorver subst√¢ncias √∫teis e excretar res√≠duos e excessos de √°gua e eletr√≥litos.",           comment:             "Os rins s√£o os √≥rg√£os centrais na homeostase de l√≠quidos e eletr√≥litos, ajustando a excre√ß√£o de √°gua, s√≥dio, pot√°ssio e outros solutos para manter o equil√≠brio interno.",           topic: "Fun√ß√£o Renal no Balan√ßo H√≠drico",         },         {           question:             "21. A Diurese Osm√≥tica ocorre quando:",           options: [             "a) H√° um excesso de ADH.",             "b) H√° presen√ßa de solutos n√£o reabsorv√≠veis no filtrado renal, arrastando √°gua consigo.",             "c) H√° uma diminui√ß√£o da TFG.",             "d) A ingest√£o de l√≠quidos √© muito baixa.",           ],           correctAnswer: "b) H√° presen√ßa de solutos n√£o reabsorv√≠veis no filtrado renal, arrastando √°gua consigo.",           comment:             "Na diurese osm√≥tica (como no diabetes mellitus n√£o controlado, onde a glicose age como um diur√©tico osm√≥tico), solutos que n√£o s√£o reabsorvidos pelos t√∫bulos renais ret√™m √°gua osmoticamente no l√∫men tubular, aumentando o volume de urina.",           topic: "Diurese Osm√≥tica",         },         {           question:             "22. Qual dos seguintes sintomas √© caracter√≠stico de edema (excesso de l√≠quido no espa√ßo intersticial)?",           options: [             "a) Boca seca.",             "b) Diminui√ß√£o do peso corporal.",             "c) Incha√ßo e ganho de peso.",             "d) Aumento da diurese.",           ],           correctAnswer: "c) Incha√ßo e ganho de peso.",           comment:             "Edema √© o ac√∫mulo de fluido nos tecidos intersticiais, manifestando-se como incha√ßo vis√≠vel e, em casos generalizados, ganho de peso.",           topic: "Edema",         },         {           question:             "23. A SIADH (S√≠ndrome de Secre√ß√£o Inapropriada de ADH) leva a qual desequil√≠brio h√≠drico?",           options: [             "a) Desidrata√ß√£o e hipernatremia.",             "b) Hipervolemia e hipernatremia.",             "c) Hiponatremia dilucional (excesso de √°gua em rela√ß√£o ao s√≥dio).",             "d) Diabetes insipidus.",           ],           correctAnswer: "c) Hiponatremia dilucional (excesso de √°gua em rela√ß√£o ao s√≥dio).",           comment:             "Na SIADH, h√° secre√ß√£o excessiva e inapropriada de ADH, levando √† reten√ß√£o de √°gua e √† dilui√ß√£o do s√≥dio no plasma, resultando em hiponatremia dilucional.",           topic: "SIADH",         },         {           question:             "24. O 'Diabetes Insipidus' √© uma condi√ß√£o caracterizada por defici√™ncia ou resist√™ncia √† qual horm√¥nio?",           options: [             "a) Insulina.",             "b) Aldosterona.",             "c) Horm√¥nio Antidiur√©tico (ADH).",             "d) Pept√≠deo Natriur√©tico Atrial (ANP).",           ],           correctAnswer: "c) Horm√¥nio Antidiur√©tico (ADH).",           comment:             "O Diabetes Insipidus √© causado pela incapacidade de produzir (central) ou de responder (nefrog√™nico) ao ADH, resultando em poli√∫ria (excre√ß√£o de grandes volumes de urina dilu√≠da) e polidipsia (sede intensa).",           topic: "Diabetes Insipidus",         },         {           question:             "25. A Regula√ß√£o da osmolalidade plasm√°tica √© mantida principalmente por qual mecanismo?",           options: [             "a) Ajuste da excre√ß√£o de pot√°ssio.",             "b) Regula√ß√£o da ingest√£o e excre√ß√£o de √°gua pelo sistema ADH-sede.",             "c) Ajuste da excre√ß√£o de bicarbonato.",             "d) Controle da press√£o arterial.",           ],           correctAnswer: "b) Regula√ß√£o da ingest√£o e excre√ß√£o de √°gua pelo sistema ADH-sede.",           comment:             "A osmolalidade plasm√°tica, que reflete a concentra√ß√£o de solutos no sangue, √© finamente controlada pela regula√ß√£o da ingest√£o de √°gua (sede) e da excre√ß√£o de √°gua livre pelos rins, mediada pelo ADH.",           topic: "Regula√ß√£o da Osmolalidade",         },         {           question:             "26. O que significa 'perda de volume' (hipovolemia) no contexto dos desequil√≠brios h√≠dricos?",           options: [             "a) Excesso de √°gua no corpo com s√≥dio normal.",             "b) Diminui√ß√£o da press√£o arterial devido √† vasodilata√ß√£o.",             "c) Redu√ß√£o do volume de l√≠quido no espa√ßo extracelular, que pode ocorrer por perda de √°gua e eletr√≥litos ou apenas de √°gua.",             "d) Aumento do volume intracelular.",           ],           correctAnswer: "c) Redu√ß√£o do volume de l√≠quido no espa√ßo extracelular, que pode ocorrer por perda de √°gua e eletr√≥litos ou apenas de √°gua.",           comment:             "Hipovolemia √© a diminui√ß√£o do volume de fluido no compartimento extracelular. Pode ser isot√¥nica (perda proporcional de √°gua e solutos), hipot√¥nica (perda maior de solutos) ou hipert√¥nica (perda maior de √°gua, levando √† desidrata√ß√£o).",           topic: "Hipovolemia",         },         {           question:             "27. Qual dos seguintes sintomas √© caracter√≠stico de desidrata√ß√£o?",           options: [             "a) Aumento da press√£o arterial.",             "b) Edema (incha√ßo).",             "c) Boca seca e urina escura.",             "d) Aumento do apetite.",           ],           correctAnswer: "c) Boca seca e urina escura.",           comment:             "Boca seca e urina escura s√£o sinais cl√°ssicos de desidrata√ß√£o, indicando a necessidade de reposi√ß√£o h√≠drica e a concentra√ß√£o da urina pelos rins.",           topic: "Sintomas de Desidrata√ß√£o",         },         {           question:             "28. Beb√™s e idosos s√£o considerados mais vulner√°veis a desequil√≠brios h√≠dricos por qu√™?",           options: [             "a) Possuem maior sensa√ß√£o de sede.",             "b) T√™m maior capacidade renal de reter √°gua.",             "c) S√£o mais propensos √† desidrata√ß√£o e t√™m menor capacidade de regula√ß√£o.",             "d) Possuem maior porcentagem de massa muscular.",           ],           correctAnswer: "c) S√£o mais propensos √† desidrata√ß√£o e t√™m menor capacidade de regula√ß√£o.",           comment:             "Beb√™s t√™m uma maior propor√ß√£o de √°gua corporal e maior taxa metab√≥lica, enquanto idosos podem ter menor sensa√ß√£o de sede e menor fun√ß√£o renal, tornando ambos os grupos mais suscet√≠veis a desequil√≠brios.",           topic: "Vulnerabilidade a Desequil√≠brios H√≠dricos",         },         {           question:             "29. A imagem final do slide de conclus√£o (Slide 12) destaca qual estrutura anat√¥mica para refor√ßar o papel do rim no controle do volume e da osmolalidade da urina?",           options: [             "a) O glom√©rulo.",             "b) O n√©fron.",             "c) O ducto coletor.",             "d) O c√≥rtex renal.",           ],           correctAnswer: "b) O n√©fron.",           comment:             "Embora o glom√©rulo e o ducto coletor sejam partes importantes, a imagem no slide 12 mostra a estrutura completa do n√©fron, que √© a unidade funcional do rim respons√°vel pela filtra√ß√£o, reabsor√ß√£o e secre√ß√£o, essencial para o controle h√≠drico e eletrol√≠tico.",           topic: "N√©fron e Controle H√≠drico",         },         {           question:             "30. O que significa 'perda insens√≠vel de √°gua'?",           options: [             "a) Perda de √°gua atrav√©s da urina.",             "b) Perda de √°gua atrav√©s das fezes.",             "c) Perda de √°gua por evapora√ß√£o da pele e do trato respirat√≥rio que n√£o √© percebida.",             "d) Perda de √°gua por suor excessivo.",           ],           correctAnswer: "c) Perda de √°gua por evapora√ß√£o da pele e do trato respirat√≥rio que n√£o √© percebida.",           comment:             "Perdas insens√≠veis s√£o as perdas cont√≠nuas de √°gua que n√£o s√£o facilmente mensur√°veis e n√£o s√£o acompanhadas por uma percep√ß√£o consciente da perda (diferente do suor excessivo ou da urina).",           topic: "Perda Insens√≠vel de √Ågua",         },       ];

    function buildQuiz() {
      const output = [];

      questions.forEach((currentQuestion, questionNumber) => {
        const options = [];
        for (let i = 0; i < currentQuestion.options.length; i++) {
          options.push(
            `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
              <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
              ${currentQuestion.options[i]}
            </label>`
          );
        }

        output.push(
          `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
            <div class="question">${currentQuestion.question}</div>
            <div class="options">${options.join("")}</div>
            <div class="comment" id="comment-${questionNumber}"></div>
          </div>`
        );
      });

      quizContainer.innerHTML = output.join("");
    }

    function showResults() {
      wrongQuestionIndices = [];
      errorCountByTopic = {};
      totalAnsweredQuestionsByTopic = {};
      currentWrongQuestionIndex = -1;
      hasErrors = false;
      isShowingErrors = false;
      isShowingDiagnosis = false;

      errorDiagnosisSection.style.display = 'none';
      topicsToReviewList.innerHTML = '';
      statusMessage.textContent = '';

      // Busca por todas as perguntas: est√°ticas e din√¢micas
      const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
      let correctAnswersCount = 0;
      let totalQuestionsAnswered = 0;

      console.log('üîç Verificando', allQuestionCards.length, 'perguntas...');

      allQuestionCards.forEach((card, index) => {
        const questionEl = card.querySelector('.question') || card.querySelector('p');
        if (!questionEl) return;

        const questionText = questionEl.textContent.trim();
        const optionsContainer = card.querySelector('.options') || card;
        const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
        const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
        const commentDiv = card.querySelector('.comment');

        const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";
        
        console.log(`üìù Pergunta ${index + 1}: T√≥pico = "${questionTopic}"`);
        console.log(`üîç Encontradas ${allOptions.length} alternativas`);
        
        // Remove classes anteriores
        allOptions.forEach(option => {
          option.classList.remove('correct', 'incorrect', 'selected');
        });
        if (commentDiv) commentDiv.classList.remove('show');

        let correctAnswerValue = null;
        let questionComment = null;

        // Verifica se √© pergunta est√°tica ou din√¢mica
        const isStatic = card.id && card.id.startsWith('question-');
        if (isStatic) {
          // Pergunta est√°tica - busca nos dados originais
          const questionData = questions.find(q => q.question.trim() === questionText);
          if (questionData) {
            correctAnswerValue = questionData.correctAnswer.trim();
            questionComment = questionData.comment;
          }
        } else {
          // Pergunta din√¢mica - busca pela op√ß√£o marcada como correta
          const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
          if (correctOpt) {
            correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
            console.log(`‚úÖ Resposta correta encontrada: "${correctAnswerValue}"`);
          } else {
            console.log('‚ùå Nenhuma resposta correta encontrada para pergunta din√¢mica');
          }
          
          // Busca coment√°rio no pr√≥prio card ou no div comment
          const commentElement = card.querySelector('.comment');
          if (commentElement && commentElement.textContent.trim()) {
            questionComment = commentElement.textContent.trim();
          }
        }

        // Processa resposta do usu√°rio e aplica colora√ß√£o
        let userAnswer = null;
        if (userAnswerElement) {
          userAnswerElement.classList.add('selected');
          userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
          totalQuestionsAnswered++;
          totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

          console.log(`üë§ Resposta do usu√°rio: "${userAnswer}"`);
          console.log(`üéØ Resposta correta: "${correctAnswerValue}"`);

          // Verifica se a resposta est√° correta
          if (userAnswer === correctAnswerValue) {
            correctAnswersCount++;
            console.log(`‚úÖ Resposta correta!`);
          } else {
            hasErrors = true;
            errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
            console.log(`‚ùå Resposta incorreta para t√≥pico: ${questionTopic}`);
          }
        }

        // Aplica colora√ß√£o: SEMPRE marca a correta de verde, e a errada de vermelho se foi marcada
        allOptions.forEach(option => {
          const optionValue = option.dataset.value?.trim() || option.textContent.trim();
          
          // Marca a resposta correta de verde SEMPRE
          if (optionValue === correctAnswerValue) {
            option.classList.add('correct');
            console.log(`üü¢ Marcando como correta: "${optionValue}"`);
          }
          
          // Se o usu√°rio marcou uma resposta E ela est√° errada, marca de vermelho
          if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) {
            option.classList.add('incorrect');
            console.log(`üî¥ Marcando como incorreta: "${optionValue}"`);
          }
        });

        // Mostra coment√°rio se dispon√≠vel
        if (commentDiv && questionComment) {
          commentDiv.textContent = questionComment;
          commentDiv.classList.add('show');
        }
      });

      // Exibe resultados
      resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

      console.log('üìä Erros por t√≥pico:', errorCountByTopic);
      console.log('üìä Total por t√≥pico:', totalAnsweredQuestionsByTopic);

      // Gera diagn√≥stico de erros
      if (hasErrors) {
        for (const topic in errorCountByTopic) {
          const errors = errorCountByTopic[topic];
          const total = totalAnsweredQuestionsByTopic[topic] || 0;
          if (total > 0) {
            const percent = ((errors / total) * 100).toFixed(1);
            const li = document.createElement('li');
            li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes respondidas)`;
            topicsToReviewList.appendChild(li);
          }
        }
      } else {
        const li = document.createElement('li');
        li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
        topicsToReviewList.appendChild(li);
      }

      errorDiagnosisSection.style.display = 'block';
      generatedQuestionsSection.style.display = 'block';
      generateNewQuestionsBtn.style.display = 'block';
      scrollToDiagnosis();
    }

    function scrollToQuestion(index) {
      const questionCard = document.getElementById(`question-${index}`);
      if (questionCard) {
        questionCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }
    }

    function scrollToDiagnosis() {
        errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    function scrollToGeneratedQuestions() {
        generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // Event listener para sele√ß√£o de op√ß√µes (funciona para est√°ticas e din√¢micas)
    document.addEventListener("click", function (event) {
      const clickedElement = event.target;
      const optionElement = clickedElement.closest('.option');

      if (optionElement) {
          if (clickedElement.classList.contains("scissor-icon")) {
              event.stopPropagation();
              optionElement.classList.toggle("struck-through");
          }
          else {
              const parentCard = optionElement.closest('.card');
              const currentQuestionOptions = parentCard.querySelectorAll('.option');

              currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
              optionElement.classList.add("selected");
          }
      }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;

        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });

        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();

            newQuestionsContent.innerHTML = '';
            if (data && data.html) {
                console.log('üì• HTML recebido do Flask:', data.html);
                
                // Insere o HTML diretamente sem reconstru√ß√£o complexa
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                // Adiciona tesouras e ajusta formata√ß√£o apenas se necess√°rio
                newQuestionsContent.querySelectorAll('.card').forEach((card, cardIndex) => {
                    // Garante que o elemento de pergunta tenha a classe correta
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) {
                       questionElement.classList.add('question');
                    }

                    // Remove qualquer input de radio que possa existir e adiciona tesouras
                    card.querySelectorAll('label').forEach((label) => {
                        // Remove inputs de radio MAS preserva o atributo data-answer
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            // PRESERVA o atributo data-answer do input no label
                            if (radioInput.hasAttribute('data-answer')) {
                                label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            }
                            radioInput.remove();
                        }
                        
                        // Garante que tenha a classe option
                        if (!label.classList.contains('option')) {
                            label.classList.add('option');
                        }

                        // Garante que tenha data-value
                        if (!label.dataset.value) {
                            label.dataset.value = label.textContent.trim();
                        }

                        // Adiciona tesoura se n√£o existir
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) {
                                e.stopPropagation();
                                label.classList.toggle('struck-through');
                            };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });

                    console.log(`üè∑Ô∏è Card ${cardIndex}: data-topic = "${card.dataset.topic}"`);
                    
                    // Verifica se h√° op√ß√£o correta marcada
                    const correctOption = card.querySelector('label[data-answer="true"]');
                    if (correctOption) {
                        console.log(`‚úÖ Op√ß√£o correta encontrada: "${correctOption.dataset.value}"`);
                    } else {
                        console.log('‚ùå Nenhuma op√ß√£o correta encontrada');
                    }
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas para os t√≥picos selecionados.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            scrollToGeneratedQuestions();
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);

        } catch (error) {
            console.error('Erro ao gerar novas perguntas:', error);
            newQuestionsContent.innerHTML = `<p>Erro ao carregar novas perguntas: ${error.message}. Por favor, tente novamente.</p>`;
            generatedQuestionsSection.style.display = 'block';
            scrollToGeneratedQuestions();
            statusMessage.textContent = '‚ùå Erro na requisi√ß√£o: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    // Inicializa√ß√£o
    buildQuiz();
    errorDiagnosisSection.style.display = 'none';
    generatedQuestionsSection.style.display = 'none';
    generateNewQuestionsBtn.style.display = 'none';

    // Event listener para o bot√£o de verificar respostas
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
  </script>
  <script src="conexao_firebase.js"></script><script src="navegacao.js"></script><script type="module" src="padrao_simulado.js"></script>

</body>
</html>
