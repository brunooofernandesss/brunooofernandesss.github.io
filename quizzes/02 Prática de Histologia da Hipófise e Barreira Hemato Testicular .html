
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>02 Pr√°tica de Histologia da Hip√≥fise e Barreira Hemato Testicular </title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>02 Pr√°tica de Histologia da Hip√≥fise e Barreira Hemato Testicular </h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "O que √© a l√¢mina pr√≥pria, de acordo com o texto?",
  options: [
    "A) A camada mais superficial do epit√©lio vaginal",
    "B) A camada de tecido que fica imediatamente abaixo do epit√©lio",
    "C) Uma camada de tecido muscular liso",
    "D) A barreira externa da vagina"
  ],
  correctAnswer: "B) A camada de tecido que fica imediatamente abaixo do epit√©lio",
  comment: "A l√¢mina pr√≥pria √© definida como a camada de tecido que se encontra imediatamente abaixo do epit√©lio.",
  topic: "Defini√ß√£o e Localiza√ß√£o da L√¢mina Pr√≥pria"
},
{
  question: "De que tipo de tecido conjuntivo √© constitu√≠da a l√¢mina pr√≥pria da vagina?",
  options: [
    "A) Tecido conjuntivo frouxo",
    "B) Tecido conjuntivo denso n√£o modelado",
    "C) Tecido conjuntivo el√°stico modelado",
    "D) Tecido conjuntivo reticular"
  ],
  correctAnswer: "B) Tecido conjuntivo denso n√£o modelado",
  comment: "O texto especifica que a l√¢mina pr√≥pria da vagina √© constitu√≠da por tecido conjuntivo denso n√£o modelado.",
  topic: "Composi√ß√£o Tecidual da L√¢mina Pr√≥pria"
},
{
  question: "O que significa o termo 'denso' na descri√ß√£o do tecido da l√¢mina pr√≥pria da vagina?",
  options: [
    "A) Que possui poucas c√©lulas e muita matriz extracelular aquosa",
    "B) Que h√° uma grande concentra√ß√£o de fibras, como col√°geno",
    "C) Que √© um tecido r√≠gido e sem elasticidade",
    "D) Que √© predominantemente composto por adip√≥citos"
  ],
  correctAnswer: "B) Que h√° uma grande concentra√ß√£o de fibras, como col√°geno",
  comment: "O termo 'denso' √© explicado como uma grande concentra√ß√£o de fibras, principalmente col√°geno.",
  topic: "Caracter√≠sticas do Tecido Denso"
},
{
  question: "Qual a principal caracter√≠stica que a grande concentra√ß√£o de fibras confere ao canal vaginal, segundo o texto?",
  options: [
    "A) Transpar√™ncia e leveza",
    "B) Resist√™ncia e elasticidade",
    "C) Capacidade de absor√ß√£o de nutrientes",
    "D) Imunidade ativa contra v√≠rus"
  ],
  correctAnswer: "B) Resist√™ncia e elasticidade",
  comment: "A grande concentra√ß√£o de fibras confere resist√™ncia e elasticidade ao canal vaginal.",
  topic: "Fun√ß√£o das Fibras no Tecido"
},
{
  question: "Por que o tecido da l√¢mina pr√≥pria √© classificado como 'n√£o modelado'?",
  options: [
    "A) As fibras est√£o dispostas paralelamente",
    "B) As fibras est√£o dispostas em v√°rias dire√ß√µes",
    "C) N√£o possui fibras de col√°geno",
    "D) √â um tecido em constante remodela√ß√£o celular"
  ],
  correctAnswer: "B) As fibras est√£o dispostas em v√°rias dire√ß√µes",
  comment: "O termo 'n√£o modelado' significa que as fibras est√£o dispostas em v√°rias dire√ß√µes.",
  topic: "Caracter√≠sticas do Tecido N√£o Modelado"
},
{
  question: "Qual a import√¢ncia da disposi√ß√£o 'n√£o modelada' das fibras da l√¢mina pr√≥pria da vagina?",
  options: [
    "A) Facilita a passagem de sangue e oxig√™nio",
    "B) Permite que o tecido suporte estiramento em diferentes sentidos",
    "C) Garante a impermeabilidade do canal vaginal",
    "D) Favorece a forma√ß√£o de gl√¢ndulas secretoras"
  ],
  correctAnswer: "B) Permite que o tecido suporte estiramento em diferentes sentidos",
  comment: "A disposi√ß√£o 'n√£o modelada' permite que o tecido suporte estiramento em diferentes sentidos.",
  topic: "Fun√ß√£o da Disposi√ß√£o das Fibras"
},
{
  question: "Em que situa√ß√µes a capacidade de estiramento em diferentes sentidos do tecido vaginal √© particularmente importante?",
  options: [
    "A) Durante a menstrua√ß√£o e ovula√ß√£o",
    "B) Durante o coito e o parto",
    "C) Durante a mic√ß√£o e a defeca√ß√£o",
    "D) Durante a fase de repouso sexual"
  ],
  correctAnswer: "B) Durante o coito e o parto",
  comment: "A capacidade de estiramento √© importante durante o coito e o parto.",
  topic: "Relev√¢ncia Cl√≠nica do Estiramento Vaginal"
},
{
  question: "Por que a l√¢mina pr√≥pria da vagina atua como uma segunda linha de defesa?",
  options: [
    "A) Porque a vagina √© um √≥rg√£o est√©ril",
    "B) Porque a vagina comunica o meio interno com o externo e √© colonizada por microrganismos",
    "C) Porque a vagina √© uma barreira mec√¢nica intranspon√≠vel",
    "D) Porque a l√¢mina pr√≥pria produz anticorpos espec√≠ficos"
  ],
  correctAnswer: "B) Porque a vagina comunica o meio interno com o externo e √© colonizada por microrganismos",
  comment: "A l√¢mina pr√≥pria atua como segunda linha de defesa porque a vagina comunica o meio interno com o externo e √© naturalmente colonizada por microrganismos.",
  topic: "Barreira Imunol√≥gica"
},
{
  question: "Que tipo de c√©lulas de defesa √© muito comum encontrar infiltradas na l√¢mina pr√≥pria da vagina?",
  options: [
    "A) Eritr√≥citos e plaquetas",
    "B) Leuc√≥citos e neutr√≥filos",
    "C) C√©lulas musculares e nervosas",
    "D) C√©lulas epiteliais e glandulares"
  ],
  correctAnswer: "B) Leuc√≥citos e neutr√≥filos",
  comment: "O texto menciona que √© muito comum encontrar leuc√≥citos e neutr√≥filos infiltrados nesse tecido.",
  topic: "C√©lulas de Defesa na L√¢mina Pr√≥pria"
},
{
  question: "Qual a principal fun√ß√£o das c√©lulas de defesa na l√¢mina pr√≥pria da vagina?",
  options: [
    "A) Produzir horm√¥nios sexuais",
    "B) Controlar a prolifera√ß√£o microbiana e evitar invas√£o de tecidos mais profundos",
    "C) Sintetizar fibras de col√°geno para dar suporte",
    "D) Promover a lubrifica√ß√£o do canal vaginal"
  ],
  correctAnswer: "B) Controlar a prolifera√ß√£o microbiana e evitar invas√£o de tecidos mais profundos",
  comment: "A fun√ß√£o dessas c√©lulas √© controlar a prolifera√ß√£o microbiana e evitar que bact√©rias e fungos invadam tecidos mais profundos.",
  topic: "Fun√ß√£o Imunol√≥gica das C√©lulas"
},
{
  question: "Um exemplo de fungo que as c√©lulas de defesa da l√¢mina pr√≥pria ajudam a controlar √©:",
  options: [
    "A) Saccharomyces",
    "B) Aspergillus",
    "C) Candida",
    "D) Penicillium"
  ],
  correctAnswer: "C) Candida",
  comment: "O texto menciona a Candida como um fungo que as c√©lulas de defesa ajudam a controlar.",
  topic: "Microrganismos Patog√™nicos"
},
{
  question: "Em que situa√ß√µes as c√©lulas de defesa da l√¢mina pr√≥pria se tornam cruciais para evitar invas√£o de tecidos mais profundos?",
  options: [
    "A) Apenas durante a gravidez",
    "B) Quando a barreira epitelial falha ou a imunidade baixa",
    "C) Constantemente, sem varia√ß√µes",
    "D) Somente ap√≥s o parto"
  ],
  correctAnswer: "B) Quando a barreira epitelial falha ou a imunidade baixa",
  comment: "As c√©lulas de defesa s√£o importantes para evitar invas√£o caso a barreira epitelial falhe ou a imunidade baixe.",
  topic: "Condi√ß√µes que Afetam a Defesa Imunol√≥gica"
},
{
  question: "Qual √© o 'ponto que costuma gerar confus√£o' e √© destacado como 'curioso' em rela√ß√£o √† l√¢mina pr√≥pria da vagina?",
  options: [
    "A) Sua capacidade de estiramento",
    "B) A aus√™ncia de gl√¢ndulas pr√≥prias e a lubrifica√ß√£o",
    "C) A presen√ßa de leuc√≥citos",
    "D) Sua composi√ß√£o de tecido conjuntivo denso n√£o modelado"
  ],
  correctAnswer: "B) A aus√™ncia de gl√¢ndulas pr√≥prias e a lubrifica√ß√£o",
  comment: "O texto aponta a aus√™ncia de gl√¢ndulas pr√≥prias e a quest√£o da lubrifica√ß√£o como um ponto curioso e gerador de confus√£o.",
  topic: "Particularidades da L√¢mina Pr√≥pria"
},
{
  question: "A l√¢mina pr√≥pria da vagina possui gl√¢ndulas pr√≥prias para produ√ß√£o de secre√ß√µes locais?",
  options: [
    "A) Sim, produz suor e √≥leos",
    "B) Sim, mas apenas muco",
    "C) N√£o, ela n√£o possui gl√¢ndulas pr√≥prias",
    "D) Apenas gl√¢ndulas seb√°ceas"
  ],
  correctAnswer: "C) N√£o, ela n√£o possui gl√¢ndulas pr√≥prias",
  comment: "A l√¢mina pr√≥pria da vagina n√£o possui gl√¢ndulas pr√≥prias, diferentemente de outras mucosas do corpo.",
  topic: "Aus√™ncia de Gl√¢ndulas"
},
{
  question: "De onde prov√©m a lubrifica√ß√£o e umidade da vagina, j√° que sua l√¢mina pr√≥pria n√£o possui gl√¢ndulas secretoras?",
  options: [
    "A) Da produ√ß√£o de gl√¢ndulas sudor√≠paras na pr√≥pria parede vaginal",
    "B) De gl√¢ndulas localizadas no √∫tero (c√©rvix/colo do √∫tero)",
    "C) Da absor√ß√£o de umidade do ar externo",
    "D) De gl√¢ndulas localizadas nos l√°bios maiores"
  ],
  correctAnswer: "B) De gl√¢ndulas localizadas no √∫tero (c√©rvix/colo do √∫tero)",
  comment: "A lubrifica√ß√£o prov√©m de gl√¢ndulas localizadas no √∫tero (c√©rvix/colo do √∫tero).",
  topic: "Mecanismo de Lubrifica√ß√£o Vaginal"
},
{
  question: "Qual parte do √∫tero √© especificamente mencionada como respons√°vel pela produ√ß√£o de muco que escorre para o canal vaginal?",
  options: [
    "A) Fundo uterino",
    "B) Endom√©trio",
    "C) Miom√©trio",
    "D) Colo do √∫tero (c√©rvix)"
  ],
  correctAnswer: "D) Colo do √∫tero (c√©rvix)",
  comment: "O muco que lubrifica a vagina √© produzido no colo do √∫tero (c√©rvix).",
  topic: "Origem do Muco Vaginal"
},
{
  question: "O que estimula a produ√ß√£o de muco no colo do √∫tero?",
  options: [
    "A) A ingest√£o de √°gua",
    "B) Os horm√¥nios do ciclo menstrual",
    "C) A atividade f√≠sica intensa",
    "D) A temperatura corporal"
  ],
  correctAnswer: "B) Os horm√¥nios do ciclo menstrual",
  comment: "A produ√ß√£o de muco no √∫tero √© estimulada pelos horm√¥nios do ciclo menstrual.",
  topic: "Regula√ß√£o Hormonal da Secre√ß√£o"
},
{
  question: "Como a produ√ß√£o de muco no √∫tero se reflete na umidade da vagina?",
  options: [
    "A) Aumenta a temperatura vaginal",
    "B) Diminui a acidez do ambiente vaginal",
    "C) Contribui diretamente para a umidade vaginal",
    "D) Causa ressecamento vaginal"
  ],
  correctAnswer: "C) Contribui diretamente para a umidade vaginal",
  comment: "A produ√ß√£o de muco no √∫tero acaba refletindo na umidade da vagina.",
  topic: "Impacto da Secre√ß√£o Uterina"
},
{
  question: "Do ponto de vista histol√≥gico, como a vagina √© caracterizada em rela√ß√£o √† produ√ß√£o de l√≠quido, segundo o resumo?",
  options: [
    "A) Como um √≥rg√£o secretor prim√°rio",
    "B) Como um canal de drenagem para secre√ß√µes produzidas acima dela",
    "C) Como uma gl√¢ndula end√≥crina",
    "D) Como um reservat√≥rio de fluidos"
  ],
  correctAnswer: "B) Como um canal de drenagem para secre√ß√µes produzidas acima dela",
  comment: "Histologicamente, a vagina funciona mais como um canal de drenagem para as secre√ß√µes produzidas acima dela (no √∫tero).",
  topic: "Histologia e Fun√ß√£o Vaginal"
},
{
  question: "Al√©m das secre√ß√µes uterinas, qual outra fonte de umidade pode contribuir para a lubrifica√ß√£o vaginal, conforme o resumo?",
  options: [
    "A) Secre√ß√µes das gl√¢ndulas mam√°rias",
    "B) Transudatos das paredes vasculares",
    "C) Suor produzido nas virilhas",
    "D) L√≠quido amni√≥tico"
  ],
  correctAnswer: "B) Transudatos das paredes vasculares",
  comment: "O resumo menciona que a vagina funciona como um canal de drenagem para secre√ß√µes do √∫tero e transudatos das paredes vasculares.",
  topic: "Fontes de Umidade Vaginal"
},
{
  question: "Qual camada de tecido fica 'imediatamente abaixo do epit√©lio' na vagina?",
  options: [
    "A) Muscular externa",
    "B) Submucosa",
    "C) L√¢mina pr√≥pria",
    "D) Serosa"
  ],
  correctAnswer: "C) L√¢mina pr√≥pria",
  comment: "A l√¢mina pr√≥pria √© a camada que fica imediatamente abaixo do epit√©lio.",
  topic: "Camadas Teciduais"
},
{
  question: "A l√¢mina pr√≥pria da vagina √© um exemplo de qual tipo de tecido conjuntivo em termos de densidade e organiza√ß√£o de fibras?",
  options: [
    "A) Conjuntivo frouxo irregular",
    "B) Conjuntivo denso regular",
    "C) Conjuntivo denso n√£o modelado",
    "D) Conjuntivo el√°stico"
  ],
  correctAnswer: "C) Conjuntivo denso n√£o modelado",
  comment: "O texto define a l√¢mina pr√≥pria da vagina como tecido conjuntivo denso n√£o modelado.",
  topic: "Classifica√ß√£o do Tecido Conjuntivo"
},
{
  question: "As fibras da l√¢mina pr√≥pria da vagina, sendo 'n√£o modeladas', est√£o dispostas de que maneira?",
  options: [
    "A) Paralelas umas √†s outras",
    "B) Aleatoriamente em v√°rias dire√ß√µes",
    "C) Em camadas conc√™ntricas",
    "D) De forma longitudinal apenas"
  ],
  correctAnswer: "B) Aleatoriamente em v√°rias dire√ß√µes",
  comment: "As fibras 'n√£o modeladas' est√£o dispostas em v√°rias dire√ß√µes.",
  topic: "Organiza√ß√£o das Fibras"
},
{
  question: "Qual √© o principal componente fibrilar que confere resist√™ncia √† l√¢mina pr√≥pria densa?",
  options: [
    "A) Fibras el√°sticas",
    "B) Fibras reticulares",
    "C) Col√°geno",
    "D) Actina"
  ],
  correctAnswer: "C) Col√°geno",
  comment: "A concentra√ß√£o de fibras de col√°geno confere resist√™ncia e elasticidade.",
  topic: "Componentes do Tecido Conjuntivo"
},
{
  question: "A vagina √© naturalmente colonizada por microrganismos. Como essa cole√ß√£o de microrganismos √© denominada no texto?",
  options: [
    "A) Pat√≥genos",
    "B) Microbiota",
    "C) Parasitas",
    "D) Bact√©rias virais"
  ],
  correctAnswer: "B) Microbiota",
  comment: "A cole√ß√£o de microrganismos que colonizam a vagina √© referida como microbiota.",
  topic: "Microbiota Vaginal"
},
{
  question: "A presen√ßa de leuc√≥citos e neutr√≥filos na l√¢mina pr√≥pria da vagina √© um achado esperado ou incomum?",
  options: [
    "A) Incomum, indica infec√ß√£o grave",
    "B) Esperado e muito comum",
    "C) Sempre indica uma condi√ß√£o pr√©-cancerosa",
    "D) Ocorre apenas em mulheres idosas"
  ],
  correctAnswer: "B) Esperado e muito comum",
  comment: "A aula destaca que √© muito comum encontrar c√©lulas de defesa (leuc√≥citos e neutr√≥filos) infiltradas nesse tecido.",
  topic: "Achados Histol√≥gicos Normais"
},
{
  question: "O que a l√¢mina pr√≥pria da vagina N√ÉO possui, de forma diferente de outras mucosas do corpo que produzem sua pr√≥pria secre√ß√£o localmente?",
  options: [
    "A) Fibras de col√°geno",
    "B) C√©lulas de defesa",
    "C) Gl√¢ndulas pr√≥prias",
    "D) Vasos sangu√≠neos"
  ],
  correctAnswer: "C) Gl√¢ndulas pr√≥prias",
  comment: "A l√¢mina pr√≥pria da vagina n√£o possui gl√¢ndulas pr√≥prias, diferentemente de outras mucosas.",
  topic: "Diferencia√ß√£o de Mucosas"
},
{
  question: "A parede vaginal em si, atrav√©s de gl√¢ndulas em sua l√¢mina pr√≥pria, secreta qual dos seguintes?",
  options: [
    "A) Suor",
    "B) √ìleos",
    "C) Muco",
    "D) Nenhuma das op√ß√µes acima"
  ],
  correctAnswer: "D) Nenhuma das op√ß√µes acima",
  comment: "A l√¢mina pr√≥pria da vagina n√£o secreta suor, √≥leos ou muco atrav√©s de gl√¢ndulas nesta camada.",
  topic: "Secre√ß√£o Vaginal"
},
{
  question: "Qual o destino do muco produzido no colo do √∫tero em rela√ß√£o ao canal vaginal?",
  options: [
    "A) √â absorvido pelo √∫tero",
    "B) Escre para o canal vaginal",
    "C) √â eliminado diretamente para a bexiga",
    "D) Fica retido no colo do √∫tero"
  ],
  correctAnswer: "B) Escre para o canal vaginal",
  comment: "O muco produzido no colo do √∫tero escorre para o canal vaginal.",
  topic: "Fluxo de Secre√ß√£o"
},
{
  question: "A umidade da vagina √© um reflexo de qual processo estimulado hormonalmente?",
  options: [
    "A) A produ√ß√£o de gl√¢ndulas seb√°ceas nos l√°bios",
    "B) A transpira√ß√£o das paredes internas da vagina",
    "C) A produ√ß√£o de muco no colo do √∫tero pelo ciclo menstrual",
    "D) A secre√ß√£o de l√≠quidos pelas gl√¢ndulas de Bartholin"
  ],
  correctAnswer: "C) A produ√ß√£o de muco no colo do √∫tero pelo ciclo menstrual",
  comment: "A produ√ß√£o de muco no √∫tero √© estimulada pelos horm√¥nios do ciclo menstrual, o que acaba refletindo na umidade da vagina.",
  topic: "Regula√ß√£o da Umidade Vaginal"
},
{
  question: "Qual √© a principal caracter√≠stica da l√¢mina pr√≥pria da vagina que fundamenta a ideia de ser um 'canal de drenagem'?",
  options: [
    "A) Sua rica vasculariza√ß√£o",
    "B) A aus√™ncia de gl√¢ndulas secretoras",
    "C) Sua colora√ß√£o avermelhada",
    "D) A presen√ßa de nervos sensitivos"
  ],
  correctAnswer: "B) A aus√™ncia de gl√¢ndulas secretoras",
  comment: "A l√¢mina pr√≥pria √© desprovida de gl√¢ndulas secretoras, o que faz a vagina funcionar como um canal de drenagem.",
  topic: "Base Histol√≥gica da Fun√ß√£o de Drenagem"
},
{
  question: "Quando o texto afirma que a l√¢mina pr√≥pria da vagina atua como uma 'segunda linha de defesa', o que isso implica sobre a primeira linha de defesa?",
  options: [
    "A) A primeira linha de defesa √© o sistema imunol√≥gico sist√™mico",
    "B) A primeira linha de defesa √© o epit√©lio vaginal",
    "C) N√£o h√° uma primeira linha de defesa na vagina",
    "D) A primeira linha de defesa s√£o os antibi√≥ticos"
  ],
  correctAnswer: "B) A primeira linha de defesa √© o epit√©lio vaginal",
  comment: "O texto implica que a barreira epitelial √© a primeira linha, e a l√¢mina pr√≥pria atua quando essa falha.",
  topic: "Linhas de Defesa"
},
{
  question: "Por que a vagina √© naturalmente colonizada por microrganismos?",
  options: [
    "A) Porque ela √© um √≥rg√£o est√©ril que atrai bact√©rias",
    "B) Devido √† sua comunica√ß√£o com o meio interno e externo",
    "C) Apenas ap√≥s o uso de antibi√≥ticos",
    "D) √â uma condi√ß√£o anormal que sempre requer tratamento"
  ],
  correctAnswer: "B) Devido √† sua comunica√ß√£o com o meio interno e externo",
  comment: "A vagina √© um canal que comunica o meio interno com o externo, sendo naturalmente colonizada por microrganismos.",
  topic: "Fatores da Coloniza√ß√£o Microbiana"
},
{
  question: "Como a l√¢mina pr√≥pria da vagina se diferencia de outras mucosas do corpo no que diz respeito √† produ√ß√£o de secre√ß√µes locais?",
  options: [
    "A) Ela tem gl√¢ndulas muito mais ativas",
    "B) Ela n√£o possui gl√¢ndulas pr√≥prias para produ√ß√£o de secre√ß√£o local",
    "C) Produz apenas secre√ß√µes hormonais",
    "D) Suas gl√¢ndulas s√£o estimuladas apenas por processos inflamat√≥rios"
  ],
  correctAnswer: "B) Ela n√£o possui gl√¢ndulas pr√≥prias para produ√ß√£o de secre√ß√£o local",
  comment: "Diferente de outras mucosas, a l√¢mina pr√≥pria da vagina n√£o possui gl√¢ndulas pr√≥prias que produzem secre√ß√£o localmente.",
  topic: "Compara√ß√£o de Mucosas"
},
{
  question: "A resist√™ncia e elasticidade do canal vaginal s√£o diretas consequ√™ncias de qual caracter√≠stica do tecido de sua l√¢mina pr√≥pria?",
  options: [
    "A) Ser frouxo e altamente vascularizado",
    "B) Ser denso e conter muitas fibras de col√°geno",
    "C) Ser modelado e com fibras paralelas",
    "D) Ser composto principalmente por c√©lulas musculares"
  ],
  correctAnswer: "B) Ser denso e conter muitas fibras de col√°geno",
  comment: "O car√°ter 'denso', com grande concentra√ß√£o de fibras (col√°geno), confere resist√™ncia e elasticidade.",
  topic: "Rela√ß√£o Estrutura-Fun√ß√£o"
},
{
  question: "O termo 'infiltradas' usado para descrever leuc√≥citos na l√¢mina pr√≥pria sugere que sua presen√ßa √©:",
  options: [
    "A) Acidental e insignificante",
    "B) Ativamente movendo-se para dentro do tecido para defesa",
    "C) Est√°tica e inativa",
    "D) Restrita √† superf√≠cie do epit√©lio"
  ],
  correctAnswer: "B) Ativamente movendo-se para dentro do tecido para defesa",
  comment: "Infiltra√ß√£o implica que as c√©lulas se moveram para dentro do tecido, indicando uma fun√ß√£o de defesa ativa.",
  topic: "Terminologia Histol√≥gica"
},
{
  question: "Qual estrutura tecidual espec√≠fica √© *ausente* na l√¢mina pr√≥pria da vagina, tornando seu mecanismo de lubrifica√ß√£o √∫nico?",
  options: [
    "A) Nervos",
    "B) Vasos sangu√≠neos",
    "C) Fibras el√°sticas",
    "D) Gl√¢ndulas secretoras"
  ],
  correctAnswer: "D) Gl√¢ndulas secretoras",
  comment: "A l√¢mina pr√≥pria da vagina √© desprovida de gl√¢ndulas secretoras, o que a diferencia no mecanismo de lubrifica√ß√£o.",
  topic: "Anatomia Funcional"
},
{
  question: "O que √© a 'microbiota' mencionada em rela√ß√£o √† vagina?",
  options: [
    "A) Um tipo de infec√ß√£o sexualmente transmiss√≠vel",
    "B) Um conjunto de microrganismos naturalmente presentes",
    "C) Uma camada protetora de c√©lulas mortas",
    "D) Um tipo de secre√ß√£o vaginal"
  ],
  correctAnswer: "B) Um conjunto de microrganismos naturalmente presentes",
  comment: "Microbiota refere-se aos microrganismos que colonizam naturalmente a vagina.",
  topic: "Terminologia M√©dica"
},
{
  question: "Se a l√¢mina pr√≥pria da vagina n√£o secreta suor, √≥leos ou muco, o que isso nos diz sobre suas gl√¢ndulas?",
  options: [
    "A) Suas gl√¢ndulas s√£o muito ativas, mas produzem outros tipos de secre√ß√£o",
    "B) Suas gl√¢ndulas s√£o ineficazes",
    "C) Ela n√£o possui gl√¢ndulas com capacidade secretora local para essas subst√¢ncias",
    "D) As gl√¢ndulas est√£o presentes, mas s√£o inibidas hormonalmente"
  ],
  correctAnswer: "C) Ela n√£o possui gl√¢ndulas com capacidade secretora local para essas subst√¢ncias",
  comment: "A aus√™ncia de secre√ß√£o de suor, √≥leos ou muco pela l√¢mina pr√≥pria indica que ela n√£o possui gl√¢ndulas com essa fun√ß√£o.",
  topic: "Fun√ß√£o Glandular"
},
{
  question: "A disposi√ß√£o das fibras em v√°rias dire√ß√µes na l√¢mina pr√≥pria da vagina √© crucial para qual aspecto funcional?",
  options: [
    "A) A manuten√ß√£o da temperatura vaginal constante",
    "B) A capacidade de suportar estiramento em diferentes sentidos",
    "C) A r√°pida cicatriza√ß√£o de les√µes",
    "D) A condu√ß√£o de impulsos nervosos"
  ],
  correctAnswer: "B) A capacidade de suportar estiramento em diferentes sentidos",
  comment: "A disposi√ß√£o n√£o modelada das fibras permite que o tecido suporte estiramento em diferentes sentidos.",
  topic: "Adapta√ß√£o Funcional"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
<script src="conexao_firebase.js"></script><script src="navegacao.js"></script><script type="module" src="padrao_simulado.js"></script>
</body>
</html>
