
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>05 Imunologia da Gravidez HCG e Teratog√™nese </title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>05 Imunologia da Gravidez HCG e Teratog√™nese </h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual o conceito central estabelecido no in√≠cio da aula, situado na base do enc√©falo e que atua como comando central para a libera√ß√£o hormonal?",
  options: [
    "A) Sistema Nervoso Perif√©rico",
    "B) Eixo Hipot√°lamo-Hip√≥fise",
    "C) Gl√¢ndulas Adrenais",
    "D) G√¥nadas"
  ],
  correctAnswer: "B) Eixo Hipot√°lamo-Hip√≥fise",
  comment: "O eixo hipot√°lamo-hip√≥fise √© o comando central para a libera√ß√£o hormonal no corpo, situado na base do enc√©falo.",
  topic: "Introdu√ß√£o √† Neuroendocrinologia"
},
{
  question: "No funcionamento do eixo hipot√°lamo-hip√≥fise, qual a fun√ß√£o atribu√≠da ao hipot√°lamo?",
  options: [
    "A) Atuar como 'gerente', liberando horm√¥nios tr√≥ficos.",
    "B) Atuar como 'diretor', recebendo est√≠mulos e enviando horm√¥nios liberadores ou inibidores.",
    "C) Produzir prolactina e horm√¥nio do crescimento.",
    "D) Armazenar e liberar ocitocina e ADH."
  ],
  correctAnswer: "B) Atuar como 'diretor', recebendo est√≠mulos e enviando horm√¥nios liberadores ou inibidores.",
  comment: "O hipot√°lamo funciona como o 'diretor', recebendo est√≠mulos e decidindo se deve estimular ou inibir a produ√ß√£o hormonal, enviando horm√¥nios liberadores ou inibidores para a hip√≥fise.",
  topic: "Funcionamento do Eixo Hipot√°lamo-Hip√≥fise"
},
{
  question: "Quais s√£o exemplos de horm√¥nios liberadores produzidos pelo hipot√°lamo, mencionados no texto?",
  options: [
    "A) TSH, FSH, LH, ACTH",
    "B) Prolactina, GH, Ocitocina, ADH",
    "C) TRH, GnRH, CRH, GHRH",
    "D) Estradiol, Progesterona, Testosterona"
  ],
  correctAnswer: "C) TRH, GnRH, CRH, GHRH",
  comment: "O hipot√°lamo libera horm√¥nios como TRH (liberador de tireotrofina), GnRH (liberador de gonadotrofinas), CRH (liberador de corticotrofina) e GHRH (liberador de horm√¥nio do crescimento).",
  topic: "Horm√¥nios Hipotal√¢micos"
},
{
  question: "Qual subst√¢ncia atua como fator inibidor da prolactina?",
  options: [
    "A) Serotonina",
    "B) Dopamina",
    "C) Acetilcolina",
    "D) Noradrenalina"
  ],
  correctAnswer: "B) Dopamina",
  comment: "A dopamina atua como fator inibidor da prolactina.",
  topic: "Regula√ß√£o Hormonal"
},
{
  question: "Quais dos seguintes s√£o exemplos de horm√¥nios tr√≥ficos liberados pela adeno-hip√≥fise, que estimulam outras gl√¢ndulas?",
  options: [
    "A) Prolactina e GH",
    "B) Ocitocina e ADH",
    "C) TSH, FSH, LH e ACTH",
    "D) TRH, GnRH, CRH e GHRH"
  ],
  correctAnswer: "C) TSH, FSH, LH e ACTH",
  comment: "A adeno-hip√≥fise libera TSH, FSH, LH e ACTH, que s√£o horm√¥nios tr√≥ficos que estimulam outras gl√¢ndulas.",
  topic: "Horm√¥nios Adeno-hipofis√°rios Tr√≥ficos"
},
{
  question: "Quais horm√¥nios s√£o considerados 'n√£o tr√≥ficos', atuando diretamente nos tecidos-alvo sem passar por outra gl√¢ndula end√≥crina, e s√£o liberados pela adeno-hip√≥fise?",
  options: [
    "A) TSH e ACTH",
    "B) FSH e LH",
    "C) Prolactina e GH",
    "D) Ocitocina e ADH"
  ],
  correctAnswer: "C) Prolactina e GH",
  comment: "A prolactina (produ√ß√£o de leite) e o GH (crescimento) s√£o horm√¥nios 'n√£o tr√≥ficos' que atuam diretamente nos tecidos-alvo.",
  topic: "Horm√¥nios Adeno-hipofis√°rios N√£o Tr√≥ficos"
},
{
  question: "A neuro-hip√≥fise tem qual fun√ß√£o em rela√ß√£o aos horm√¥nios ocitocina e ADH?",
  options: [
    "A) Produzir ambos os horm√¥nios.",
    "B) Armazenar e liberar horm√¥nios produzidos no hipot√°lamo.",
    "C) Regular a produ√ß√£o de horm√¥nios tr√≥ficos.",
    "D) Estimular a produ√ß√£o de prolactina."
  ],
  correctAnswer: "B) Armazenar e liberar horm√¥nios produzidos no hipot√°lamo.",
  comment: "A neuro-hip√≥fise n√£o produz horm√¥nios; ela apenas armazena e libera horm√¥nios produzidos no hipot√°lamo, especificamente a ocitocina e o horm√¥nio antidiur√©tico (ADH).",
  topic: "Neuro-Hip√≥fise"
},
{
  question: "Qual a principal diferen√ßa entre a ocitocina e a prolactina em rela√ß√£o √† fun√ß√£o mam√°ria?",
  options: [
    "A) A ocitocina atua na produ√ß√£o de leite, e a prolactina na eje√ß√£o.",
    "B) A ocitocina atua na contra√ß√£o uterina e eje√ß√£o do leite, enquanto a prolactina na produ√ß√£o de leite.",
    "C) Ambas atuam na produ√ß√£o de leite, mas em diferentes fases.",
    "D) A prolactina atua na contra√ß√£o uterina, e a ocitocina na eje√ß√£o do leite."
  ],
  correctAnswer: "B) A ocitocina atua na contra√ß√£o uterina e eje√ß√£o do leite, enquanto a prolactina na produ√ß√£o de leite.",
  comment: "A ocitocina atua na contra√ß√£o uterina e na eje√ß√£o do leite, diferente da prolactina, que atua na produ√ß√£o de leite.",
  topic: "Horm√¥nios Mam√°rios"
},
{
  question: "Qual tipo de mecanismo de retroalimenta√ß√£o (feedback) √© o mais comum no sistema end√≥crino, onde um alto n√≠vel de horm√¥nio alvo cessa o est√≠mulo?",
  options: [
    "A) Feedback positivo",
    "B) Feedback negativo",
    "C) Feedback direto",
    "D) Feedback indireto"
  ],
  correctAnswer: "B) Feedback negativo",
  comment: "O mais comum √© o feedback negativo: quando o n√≠vel de um horm√¥nio alvo est√° alto, o hipot√°lamo/hip√≥fise cessa o est√≠mulo.",
  topic: "Mecanismo de Retroalimenta√ß√£o"
},
{
  question: "Um exemplo de feedback positivo mencionado no texto ocorre em qual situa√ß√£o?",
  options: [
    "A) Inibi√ß√£o da tireotrofina pelo TRH.",
    "B) Pico de LH para ovula√ß√£o.",
    "C) Aumento de prolactina pela dopamina.",
    "D) Diminui√ß√£o de GH pelo GHRH."
  ],
  correctAnswer: "B) Pico de LH para ovula√ß√£o.",
  comment: "O feedback positivo ocorre, por exemplo, no pico de LH para ovula√ß√£o.",
  topic: "Feedback Positivo"
},
{
  question: "Como √© definida a puberdade no contexto da aula?",
  options: [
    "A) Apenas o estir√£o de crescimento.",
    "B) O processo biol√≥gico de transi√ß√£o da inf√¢ncia para a fase adulta, envolvendo a matura√ß√£o sexual e o estir√£o de crescimento.",
    "C) A fase de aumento da produ√ß√£o de andr√≥genos pela adrenal.",
    "D) O desenvolvimento do broto mam√°rio."
  ],
  correctAnswer: "B) O processo biol√≥gico de transi√ß√£o da inf√¢ncia para a fase adulta, envolvendo a matura√ß√£o sexual e o estir√£o de crescimento.",
  comment: "A puberdade √© definida como o processo biol√≥gico de transi√ß√£o da inf√¢ncia para a fase adulta, envolvendo a matura√ß√£o sexual e o estir√£o de crescimento.",
  topic: "Defini√ß√£o de Puberdade"
},
{
  question: "Qual evento na puberdade se refere √† reativa√ß√£o do eixo hipot√°lamo-hip√≥fise-gonadal, levando √† produ√ß√£o de horm√¥nios sexuais pelas g√¥nadas?",
  options: [
    "A) Adrenarca",
    "B) Gonadarca",
    "C) Telarca",
    "D) Pubarca"
  ],
  correctAnswer: "B) Gonadarca",
  comment: "Gonadarca √© a reativa√ß√£o do eixo hipot√°lamo-hip√≥fise-gonadal, levando √† produ√ß√£o de horm√¥nios sexuais pelas g√¥nadas.",
  topic: "Gonadarca"
},
{
  question: "O aumento da produ√ß√£o de andr√≥genos pelo c√≥rtex da gl√¢ndula adrenal durante a puberdade √© conhecido como:",
  options: [
    "A) Gonadarca",
    "B) Telarca",
    "C) Adrenarca",
    "D) Menarca"
  ],
  correctAnswer: "C) Adrenarca",
  comment: "Adrenarca √© o aumento da produ√ß√£o de andr√≥genos pelo c√≥rtex da gl√¢ndula adrenal.",
  topic: "Adrenarca"
},
{
  question: "Quais s√£o os sinais cl√≠nicos associados √† adrenarca, conforme o texto?",
  options: [
    "A) Desenvolvimento do broto mam√°rio e primeira menstrua√ß√£o.",
    "B) Estir√£o de crescimento e aumento testicular.",
    "C) Odor axilar, acne e aparecimento de pelos pubianos e axilares (pubarca).",
    "D) Primeiro espermatozoide e aumento peniano."
  ],
  correctAnswer: "C) Odor axilar, acne e aparecimento de pelos pubianos e axilares (pubarca).",
  comment: "A adrenarca √© respons√°vel por sinais como odor axilar, acne e aparecimento de pelos pubianos e axilares (pubarca).",
  topic: "Sinais da Adrenarca"
},
{
  question: "Qual √© geralmente o primeiro sinal da puberdade na menina, causado pela a√ß√£o do estradiol?",
  options: [
    "A) Menarca",
    "B) Pubarca",
    "C) Telarca",
    "D) Estir√£o de crescimento"
  ],
  correctAnswer: "C) Telarca",
  comment: "Telarca, o desenvolvimento do broto mam√°rio, √© geralmente o primeiro sinal na menina, causado pela a√ß√£o do estradiol.",
  topic: "Marcos da Puberdade Feminina"
},
{
  question: "Quando a menarca (primeira menstrua√ß√£o) geralmente ocorre ap√≥s a telarca?",
  options: [
    "A) Cerca de 6 meses ap√≥s a telarca.",
    "B) Simultaneamente com a telarca.",
    "C) Geralmente 2 a 2,5 anos ap√≥s a telarca.",
    "D) Antes da telarca."
  ],
  correctAnswer: "C) Geralmente 2 a 2,5 anos ap√≥s a telarca.",
  comment: "A menarca ocorre geralmente 2 a 2,5 anos ap√≥s a telarca. Os primeiros ciclos costumam ser anovulat√≥rios.",
  topic: "Menarca"
},
{
  question: "Qual o termo para a primeira produ√ß√£o de espermatozoides, manifestada muitas vezes por polu√ß√≥es noturnas?",
  options: [
    "A) Gonadarca",
    "B) Espermarca",
    "C) Pubarca",
    "D) Adrenarca"
  ],
  correctAnswer: "B) Espermarca",
  comment: "Espermarca √© a primeira produ√ß√£o de espermatozoides, manifestada muitas vezes por polu√ß√≥es noturnas.",
  topic: "Marcos da Puberdade Masculina"
},
{
  question: "Qual √© o termo para o aparecimento de pelos pubianos?",
  options: [
    "A) Telarca",
    "B) Menarca",
    "C) Espermarca",
    "D) Pubarca"
  ],
  correctAnswer: "D) Pubarca",
  comment: "Pubarca √© o aparecimento de pelos pubianos.",
  topic: "Marcos da Puberdade"
},
{
  question: "Qual a faixa et√°ria fisiol√≥gica para o in√≠cio da puberdade em meninas, segundo o texto?",
  options: [
    "A) Entre 6-11 anos",
    "B) Entre 8-13 anos",
    "C) Entre 10-15 anos",
    "D) Entre 12-16 anos"
  ],
  correctAnswer: "B) Entre 8-13 anos",
  comment: "A puberdade ocorre fisiologicamente entre 8-13 anos nas meninas.",
  topic: "Cronologia da Puberdade"
},
{
  question: "Qual a faixa et√°ria fisiol√≥gica para o in√≠cio da puberdade em meninos, segundo o texto?",
  options: [
    "A) Entre 7-12 anos",
    "B) Entre 8-13 anos",
    "C) Entre 9-14 anos",
    "D) Entre 10-15 anos"
  ],
  correctAnswer: "C) Entre 9-14 anos",
  comment: "A puberdade ocorre fisiologicamente entre 9-14 nos meninos.",
  topic: "Cronologia da Puberdade"
},
{
  question: "Quando o in√≠cio da puberdade √© considerado precoce e deve ser investigado?",
  options: [
    "A) Antes dos 10 anos em meninas ou 11 em meninos.",
    "B) Antes dos 8 anos em meninas ou 9 em meninos.",
    "C) Antes dos 7 anos em meninas ou 8 em meninos.",
    "D) Antes dos 9 anos em meninas ou 10 em meninos."
  ],
  correctAnswer: "B) Antes dos 8 anos em meninas ou 9 em meninos.",
  comment: "O in√≠cio antes dos 8 anos em meninas ou 9 em meninos √© considerado puberdade precoce e deve ser investigado.",
  topic: "Puberdade Precoce"
},
{
  question: "Para o estadiamento de Tanner em meninas, quais caracter√≠sticas s√£o avaliadas?",
  options: [
    "A) Volume testicular e tamanho do p√™nis.",
    "B) Crescimento da estatura e peso corporal.",
    "C) Desenvolvimento das mamas e pelos pubianos.",
    "D) Odor axilar e acne."
  ],
  correctAnswer: "C) Desenvolvimento das mamas e pelos pubianos.",
  comment: "Nas meninas, avalia-se o desenvolvimento das mamas e pelos pubianos na Escala de Tanner.",
  topic: "Estadiamento de Tanner Feminino"
},
{
  question: "Para o estadiamento de Tanner em meninos, quais caracter√≠sticas s√£o avaliadas?",
  options: [
    "A) Desenvolvimento das mamas e pelos pubianos.",
    "B) Genit√°lia (volume testicular e tamanho do p√™nis) e pelos pubianos.",
    "C) Estir√£o de crescimento e odor axilar.",
    "D) Voz e massa muscular."
  ],
  correctAnswer: "B) Genit√°lia (volume testicular e tamanho do p√™nis) e pelos pubianos.",
  comment: "Nos meninos, avalia-se a genit√°lia (volume testicular e tamanho do p√™nis) e pelos pubianos na Escala de Tanner.",
  topic: "Estadiamento de Tanner Masculino"
},
{
  question: "Qual instrumento √© usado para medir o volume testicular, e qual volume indica o in√≠cio da puberdade no menino?",
  options: [
    "A) Fita m√©trica; 2 ml ou mais.",
    "B) Orquid√¥metro de Prader; 4 ml ou mais.",
    "C) R√©gua; 3 cm de comprimento.",
    "D) Ultrassom; 5 ml ou mais."
  ],
  correctAnswer: "B) Orquid√¥metro de Prader; 4 ml ou mais.",
  comment: "O Orquid√¥metro de Prader √© usado para medir o volume testicular. Um volume de 4 ml ou mais indica o in√≠cio da puberdade (gonadarca) no menino.",
  topic: "Orquid√¥metro de Prader"
},
{
  question: "Sobre o crescimento √≥sseo durante o estir√£o puberal, o que o texto afirma sobre o risco de fraturas?",
  options: [
    "A) A mineraliza√ß√£o completa precede o crescimento, diminuindo o risco de fraturas.",
    "B) O crescimento √≥sseo e a mineraliza√ß√£o ocorrem simultaneamente, sem impacto no risco.",
    "C) O crescimento √≥sseo precede a mineraliza√ß√£o completa, o que aumenta temporariamente o risco de fraturas.",
    "D) O estir√£o de crescimento n√£o afeta a densidade √≥ssea."
  ],
  correctAnswer: "C) O crescimento √≥sseo precede a mineraliza√ß√£o completa, o que aumenta temporariamente o risco de fraturas.",
  comment: "Durante o estir√£o, o crescimento √≥sseo precede a mineraliza√ß√£o completa, o que aumenta temporariamente o risco de fraturas nessa faixa et√°ria.",
  topic: "Crescimento √ìsseo na Puberdade"
},
{
  question: "Como o estrog√™nio influencia a composi√ß√£o corporal feminina?",
  options: [
    "A) Diminui o tecido adiposo e aumenta a massa muscular.",
    "B) Necessita de tecido adiposo para sua metaboliza√ß√£o e a√ß√£o, levando ao ganho de contornos corporais e gordura subcut√¢nea.",
    "C) Atua apenas na mineraliza√ß√£o √≥ssea, sem impacto na gordura.",
    "D) Causa atrofia do endom√©trio e espessamento do muco cervical."
  ],
  correctAnswer: "B) Necessita de tecido adiposo para sua metaboliza√ß√£o e a√ß√£o, levando ao ganho de contornos corporais e gordura subcut√¢nea.",
  comment: "O estrog√™nio, sendo lipossol√∫vel, necessita de tecido adiposo para sua metaboliza√ß√£o e a√ß√£o adequada. Por isso, meninas ganham contornos corporais (quadril, mamas) e gordura subcut√¢nea.",
  topic: "Composi√ß√£o Corporal e Horm√¥nios Sexuais"
},
{
  question: "Qual a causa da amenorreia e atraso no crescimento em atletas de alta performance com baix√≠ssima gordura corporal?",
  options: [
    "A) Excesso de estrog√™nio, que inibe o ciclo.",
    "B) Falta de substrato lip√≠dico, que impede a a√ß√£o hormonal adequada e o fechamento das ep√≠fises √≥sseas.",
    "C) Aumento da produ√ß√£o de prolactina.",
    "D) Excesso de andr√≥genos, que suprime a menstrua√ß√£o."
  ],
  correctAnswer: "B) Falta de substrato lip√≠dico, que impede a a√ß√£o hormonal adequada e o fechamento das ep√≠fises √≥sseas.",
  comment: "Atletas de alta performance com baix√≠ssima gordura corporal podem apresentar amenorreia e atraso no crescimento, pois a falta de substrato lip√≠dico impede a a√ß√£o hormonal adequada e o fechamento das ep√≠fises √≥sseas.",
  topic: "Impacto no Metabolismo Feminino"
},
{
  question: "Na fase folicular do ciclo ovariano, qual √© o papel do FSH?",
  options: [
    "A) Provocar a ruptura do fol√≠culo e libera√ß√£o do o√≥cito.",
    "B) Transformar o fol√≠culo rompido em corpo l√∫teo.",
    "C) Recrutar fol√≠culos e estimular as c√©lulas da granulosa a produzir estrog√™nio.",
    "D) Preparar o corpo para uma poss√≠vel gravidez com progesterona."
  ],
  correctAnswer: "C) Recrutar fol√≠culos e estimular as c√©lulas da granulosa a produzir estrog√™nio.",
  comment: "Na fase folicular, o FSH recruta fol√≠culos e estimula as c√©lulas da granulosa a produzir estrog√™nio.",
  topic: "Ciclo Ovariano: Fase Folicular"
},
{
  question: "O que desencadeia o pico s√∫bito de LH que provoca a ovula√ß√£o?",
  options: [
    "A) Uma queda abrupta nos n√≠veis de progesterona.",
    "B) Um feedback negativo do estrog√™nio.",
    "C) Um pico de FSH.",
    "D) O estrog√™nio atingir um pico, gerando um feedback positivo."
  ],
  correctAnswer: "D) O estrog√™nio atingir um pico, gerando um feedback positivo.",
  comment: "Quando o estrog√™nio atinge um pico, ele gera um feedback positivo que causa um pico s√∫bito de LH, provocando a ruptura do fol√≠culo e a libera√ß√£o do o√≥cito (ovula√ß√£o).",
  topic: "Ovula√ß√£o"
},
{
  question: "Ap√≥s a ovula√ß√£o, qual estrutura √© formada a partir do fol√≠culo rompido e qual horm√¥nio ela passa a produzir predominantemente?",
  options: [
    "A) Corpo albicans, produzindo principalmente estrog√™nio.",
    "B) Corpo l√∫teo, produzindo progesterona (e estrog√™nio).",
    "C) Fol√≠culo primordial, produzindo apenas FSH.",
    "D) Fol√≠culo de Graaf, produzindo LH."
  ],
  correctAnswer: "B) Corpo l√∫teo, produzindo progesterona (e estrog√™nio).",
  comment: "Ap√≥s a ovula√ß√£o, o fol√≠culo rompido transforma-se em corpo l√∫teo, que passa a produzir progesterona (e estrog√™nio). A progesterona prepara o corpo para uma poss√≠vel gravidez.",
  topic: "Ciclo Ovariano: Fase L√∫tea"
},
{
  question: "Na fase proliferativa do ciclo uterino, o que acontece com o endom√©trio e sob qual influ√™ncia hormonal?",
  options: [
    "A) Ele se torna vascularizado e secretor sob efeito da progesterona.",
    "B) Ele se espessa e prolifera sob efeito do estrog√™nio.",
    "C) Ele descama devido √† queda de progesterona e estrog√™nio.",
    "D) Ele se atrofia devido √† falta de horm√¥nios."
  ],
  correctAnswer: "B) Ele se espessa e prolifera sob efeito do estrog√™nio.",
  comment: "Na fase proliferativa, sob efeito do estrog√™nio (produzido pelo fol√≠culo), o endom√©trio se espessa e prolifera.",
  topic: "Ciclo Uterino: Fase Proliferativa"
},
{
  question: "Qual horm√¥nio √© respons√°vel por tornar o endom√©trio vascularizado e secretor, pronto para a nida√ß√£o, na fase secretora do ciclo uterino?",
  options: [
    "A) Estrog√™nio",
    "B) FSH",
    "C) LH",
    "D) Progesterona"
  ],
  correctAnswer: "D) Progesterona",
  comment: "Ap√≥s a ovula√ß√£o, a progesterona torna o endom√©trio vascularizado e secretor, pronto para a nida√ß√£o (implanta√ß√£o).",
  topic: "Ciclo Uterino: Fase Secretora"
},
{
  question: "O que causa a menstrua√ß√£o, de acordo com a fisiologia do ciclo menstrual?",
  options: [
    "A) Um pico nos n√≠veis de estrog√™nio.",
    "B) A produ√ß√£o cont√≠nua de hCG.",
    "C) A degenera√ß√£o do corpo l√∫teo e a queda abrupta de estrog√™nio e progesterona.",
    "D) Um feedback positivo de LH."
  ],
  correctAnswer: "C) A degenera√ß√£o do corpo l√∫teo e a queda abrupta de estrog√™nio e progesterona.",
  comment: "Se n√£o houver fecunda√ß√£o, o corpo l√∫teo degenera. A queda abrupta de estrog√™nio e progesterona causa a descama√ß√£o do endom√©trio, resultando na menstrua√ß√£o.",
  topic: "Menstrua√ß√£o"
},
{
  question: "No per√≠odo periovulat√≥rio, sob a√ß√£o do estrog√™nio, qual √© a caracter√≠stica do muco cervical que facilita a passagem dos espermatozoides?",
  options: [
    "A) Espesso e opaco.",
    "B) √Åcido e coagulado.",
    "C) Fluido, transparente e filante (semelhante √† clara de ovo).",
    "D) Ressecado e ausente."
  ],
  correctAnswer: "C) Fluido, transparente e filante (semelhante √† clara de ovo).",
  comment: "No per√≠odo periovulat√≥rio, sob a√ß√£o do estrog√™nio, o muco cervical torna-se fluido, transparente e filante (semelhante √† clara de ovo) para facilitar a passagem dos espermatozoides.",
  topic: "Muco Cervical"
},
{
  question: "Qual a fun√ß√£o do hCG (gonadotrofina cori√¥nica humana) produzido pelo trofoblasto ap√≥s a nida√ß√£o?",
  options: [
    "A) Iniciar a menstrua√ß√£o.",
    "B) Estimular o desenvolvimento de um novo fol√≠culo.",
    "C) Manter o corpo l√∫teo vivo, impedindo sua degenera√ß√£o, para continuar produzindo progesterona.",
    "D) Promover a contra√ß√£o uterina para expulsar o embri√£o."
  ],
  correctAnswer: "C) Manter o corpo l√∫teo vivo, impedindo sua degenera√ß√£o, para continuar produzindo progesterona.",
  comment: "O hCG tem a fun√ß√£o de manter o corpo l√∫teo vivo, impedindo sua degenera√ß√£o. Assim, o corpo l√∫teo continua produzindo progesterona, mantendo o endom√©trio e impedindo a menstrua√ß√£o.",
  topic: "Gravidez Inicial: hCG"
},
{
  question: "Qual o principal mecanismo de a√ß√£o dos contraceptivos hormonais (p√≠lulas, inje√ß√µes, adesivos, implantes)?",
  options: [
    "A) Induzir a ovula√ß√£o e aumentar a fertilidade.",
    "B) Inibir a ovula√ß√£o atrav√©s de feedback negativo constante, al√©m de espessar o muco cervical e atrofiar o endom√©trio.",
    "C) Criar um ambiente inflamat√≥rio no √∫tero.",
    "D) Apenas descolar o endom√©trio em caso de fecunda√ß√£o."
  ],
  correctAnswer: "B) Inibir a ovula√ß√£o atrav√©s de feedback negativo constante, al√©m de espessar o muco cervical e atrofiar o endom√©trio.",
  comment: "A maioria dos contraceptivos hormonais atua inibindo a ovula√ß√£o atrav√©s de feedback negativo constante, espessam o muco cervical e atrofiam o endom√©trio.",
  topic: "M√©todos Contraceptivos Hormonais"
},
{
  question: "Como o DIU de Cobre atua como m√©todo contraceptivo?",
  options: [
    "A) Libera progesterona localmente, atrofiando o endom√©trio.",
    "B) Inibe a ovula√ß√£o por feedback negativo.",
    "C) Cria um ambiente inflamat√≥rio/hostil e libera √≠ons que prejudicam a motilidade do espermatozoide.",
    "D) Impede a produ√ß√£o de estrog√™nio no ov√°rio."
  ],
  correctAnswer: "C) Cria um ambiente inflamat√≥rio/hostil e libera √≠ons que prejudicam a motilidade do espermatozoide.",
  comment: "O DIU de Cobre cria um ambiente inflamat√≥rio/hostil e libera √≠ons que prejudicam a motilidade do espermatozoide.",
  topic: "M√©todos Contraceptivos: DIU de Cobre"
},
{
  question: "Qual √© o mecanismo de a√ß√£o da p√≠lula do dia seguinte, e sua efic√°cia em rela√ß√£o √† nida√ß√£o?",
  options: [
    "A) √â um m√©todo abortivo que atua descolando o endom√©trio em qualquer est√°gio da gravidez.",
    "B) Visa descolar o endom√©trio ou impedir a ovula√ß√£o/fecunda√ß√£o se ainda n√£o ocorreu, n√£o sendo eficaz (nem abortiva) se a nida√ß√£o j√° ocorreu.",
    "C) Atua exclusivamente inibindo a produ√ß√£o de progesterona pelo corpo l√∫teo.",
    "D) Aumenta a motilidade esperm√°tica para impedir a nida√ß√£o."
  ],
  correctAnswer: "B) Visa descolar o endom√©trio ou impedir a ovula√ß√£o/fecunda√ß√£o se ainda n√£o ocorreu, n√£o sendo eficaz (nem abortiva) se a nida√ß√£o j√° ocorreu.",
  comment: "A p√≠lula do dia seguinte visa descolar o endom√©trio ou impedir a ovula√ß√£o/fecunda√ß√£o se ainda n√£o ocorreu. Se a nida√ß√£o j√° ocorreu, n√£o √© eficaz (n√£o √© abortiva nesse est√°gio, segundo a explica√ß√£o da aula).",
  topic: "Contracep√ß√£o de Emerg√™ncia"
},
{
  question: "Na fisiologia masculina, qual o papel do LH (Horm√¥nio Luteinizante)?",
  options: [
    "A) Atuar nas C√©lulas de Sertoli para apoiar a espermatog√™nese.",
    "B) Estimular a produ√ß√£o de testosterona nas C√©lulas de Leydig.",
    "C) Causar a matura√ß√£o final dos espermatozoides no epid√≠dimo.",
    "D) Inibir a produ√ß√£o de horm√¥nios hipotal√¢micos."
  ],
  correctAnswer: "B) Estimular a produ√ß√£o de testosterona nas C√©lulas de Leydig.",
  comment: "O LH atua nas C√©lulas de Leydig (no interst√≠cio do test√≠culo) estimulando a produ√ß√£o de Testosterona.",
  topic: "Fisiologia Masculina: LH"
},
{
  question: "Na fisiologia masculina, qual o papel do FSH (Horm√¥nio Fol√≠culo-Estimulante)?",
  options: [
    "A) Atuar nas C√©lulas de Leydig estimulando a produ√ß√£o de testosterona.",
    "B) Promover a matura√ß√£o final dos espermatozoides no epid√≠dimo.",
    "C) Atuar nas C√©lulas de Sertoli (dentro dos t√∫bulos semin√≠feros) para apoiar a espermatog√™nese.",
    "D) Inibir a libera√ß√£o de GnRH pelo hipot√°lamo."
  ],
  correctAnswer: "C) Atuar nas C√©lulas de Sertoli (dentro dos t√∫bulos semin√≠feros) para apoiar a espermatog√™nese.",
  comment: "O FSH atua nas C√©lulas de Sertoli (dentro dos t√∫bulos semin√≠feros) para apoiar a espermatog√™nese.",
  topic: "Fisiologia Masculina: FSH"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
<script src="conexao_firebase.js"></script><script src="navegacao.js"></script><script type="module" src="padrao_simulado.js"></script>
</body>
</html>
