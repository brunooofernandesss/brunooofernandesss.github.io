
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>07 Histologia Detalhada do Sistema Reprodutor Masculino </title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>07 Histologia Detalhada do Sistema Reprodutor Masculino </h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual gl√¢ndula √© conhecida como a 'gl√¢ndula mestra' do sistema end√≥crino, respons√°vel por produzir horm√¥nios que controlam a secre√ß√£o de outras gl√¢ndulas?",
  options: [
    "A) Tireoide",
    "B) Hip√≥fise",
    "C) Adrenal",
    "D) P√¢ncreas"
  ],
  correctAnswer: "B) Hip√≥fise",
  comment: "A hip√≥fise √© a gl√¢ndula mestra que controla outras gl√¢ndulas end√≥crinas.",
  topic: "Introdu√ß√£o √† Hip√≥fise"
},
{
  question: "Em quantas partes principais a hip√≥fise √© fundamentalmente dividida?",
  options: [
    "A) Uma",
    "B) Duas",
    "C) Tr√™s",
    "D) Quatro"
  ],
  correctAnswer: "B) Duas",
  comment: "A hip√≥fise √© dividida em Adenohip√≥fise e Neurohip√≥fise.",
  topic: "Divis√µes Anat√¥micas da Hip√≥fise"
},
{
  question: "Quais s√£o as tr√™s regi√µes que subdividem a Adenohip√≥fise?",
  options: [
    "A) Pars nervosa, pars intermedia e pars distalis",
    "B) Pars distalis, pars intermedia e pars tuberalis",
    "C) Pars anterior, pars posterior e pars media",
    "D) Lobulo anterior, lobulo posterior e lobulo intermedio"
  ],
  correctAnswer: "B) Pars distalis, pars intermedia e pars tuberalis",
  comment: "A adenohip√≥fise √© subdividida em pars distalis, pars intermedia e pars tuberalis.",
  topic: "Subdivis√µes da Adenohip√≥fise"
},
{
  question: "No corte histol√≥gico transversal apresentado em aula, quais regi√µes da adenohip√≥fise s√£o o foco da visualiza√ß√£o?",
  options: [
    "A) Pars tuberalis e pars intermedia",
    "B) Pars distalis e pars tuberalis",
    "C) Pars distalis e pars intermedia",
    "D) Todas as tr√™s regi√µes"
  ],
  correctAnswer: "C) Pars distalis e pars intermedia",
  comment: "O foco da visualiza√ß√£o no corte histol√≥gico era a pars distalis e a pars intermedia.",
  topic: "Histologia da Hip√≥fise"
},
{
  question: "Qual √© a fun√ß√£o principal da neurohip√≥fise em rela√ß√£o √† produ√ß√£o hormonal?",
  options: [
    "A) Produzir e liberar a maioria dos horm√¥nios hipofis√°rios",
    "B) Armazenar e liberar horm√¥nios produzidos no hipot√°lamo",
    "C) Sintetizar horm√¥nios tireoidianos",
    "D) Secretar horm√¥nios que regulam o p√¢ncreas"
  ],
  correctAnswer: "B) Armazenar e liberar horm√¥nios produzidos no hipot√°lamo",
  comment: "A neurohip√≥fise n√£o produz horm√¥nios, mas armazena e libera aqueles sintetizados no hipot√°lamo.",
  topic: "Fisiologia da Neurohip√≥fise"
},
{
  question: "Como a neurohip√≥fise se conecta funcionalmente ao hipot√°lamo?",
  options: [
    "A) Atrav√©s de vasos sangu√≠neos portais",
    "B) Por meio de neur√¥nios cujos corpos celulares est√£o no hipot√°lamo e ax√¥nios descem √† neurohip√≥fise",
    "C) Atrav√©s de jun√ß√µes comunicantes diretas entre as c√©lulas glandulares",
    "D) Por meio de uma via linf√°tica especializada"
  ],
  correctAnswer: "B) Por meio de neur√¥nios cujos corpos celulares est√£o no hipot√°lamo e ax√¥nios descem √† neurohip√≥fise",
  comment: "A neurohip√≥fise tem uma conex√£o neural direta com o hipot√°lamo, onde os corpos celulares dos neur√¥nios produtores de horm√¥nios est√£o localizados.",
  topic: "Conex√£o Hipot√°lamo-Neurohip√≥fise"
},
{
  question: "Qual √© a fun√ß√£o principal da adenohip√≥fise em rela√ß√£o √† produ√ß√£o hormonal e √† circula√ß√£o sangu√≠nea?",
  options: [
    "A) Apenas armazenar horm√¥nios produzidos no hipot√°lamo",
    "B) Funcionar como uma gl√¢ndula produtora, liberando horm√¥nios na circula√ß√£o sangu√≠nea",
    "C) Atuar como um filtro para o sangue antes que ele chegue ao c√©rebro",
    "D) Produzir c√©lulas sangu√≠neas"
  ],
  correctAnswer: "B) Funcionar como uma gl√¢ndula produtora, liberando horm√¥nios na circula√ß√£o sangu√≠nea",
  comment: "A adenohip√≥fise √© uma gl√¢ndula produtora de horm√¥nios, que s√£o liberados diretamente na circula√ß√£o sangu√≠nea.",
  topic: "Fisiologia da Adenohip√≥fise"
},
{
  question: "Na microscopia da adenohip√≥fise (pars distalis), como as c√©lulas est√£o organizadas?",
  options: [
    "A) Em fol√≠culos preenchidos por coloide",
    "B) Em camadas conc√™ntricas",
    "C) Em cord√µes celulares",
    "D) Dispersas aleatoriamente"
  ],
  correctAnswer: "C) Em cord√µes celulares",
  comment: "As c√©lulas da adenohip√≥fise s√£o observadas organizadas em cord√µes celulares.",
  topic: "Histologia da Adenohip√≥fise"
},
{
  question: "O que √© encontrado entre os cord√µes celulares da adenohip√≥fise, sendo fundamental para o transporte dos horm√¥nios?",
  options: [
    "A) Tecido nervoso denso",
    "B) Vasos sangu√≠neos (capilares)",
    "C) Gl√¢ndulas seb√°ceas",
    "D) Fibras musculares"
  ],
  correctAnswer: "B) Vasos sangu√≠neos (capilares)",
  comment: "Capilares sangu√≠neos est√£o presentes entre os cord√µes celulares para o transporte hormonal.",
  topic: "Estrutura da Adenohip√≥fise"
},
{
  question: "Quantos tipos celulares funcionais existem na adenohip√≥fise?",
  options: [
    "A) Dois",
    "B) Tr√™s",
    "C) Cinco",
    "D) Oito"
  ],
  correctAnswer: "C) Cinco",
  comment: "A adenohip√≥fise possui cinco tipos celulares funcionais.",
  topic: "Tipos Celulares da Adenohip√≥fise"
},
{
  question: "Na colora√ß√£o histol√≥gica padr√£o H&E, quantos tipos celulares s√£o distingu√≠veis na adenohip√≥fise com base na afinidade tintorial?",
  options: [
    "A) Dois",
    "B) Tr√™s",
    "C) Cinco",
    "D) Quatro"
  ],
  correctAnswer: "B) Tr√™s",
  comment: "Com a colora√ß√£o H&E, distinguem-se tr√™s tipos: crom√≥fobas, bas√≥filas e acid√≥filas.",
  topic: "Histologia da Adenohip√≥fise (Colora√ß√£o H&E)"
},
{
  question: "Qual a caracter√≠stica das c√©lulas crom√≥fobas na adenohip√≥fise, em rela√ß√£o √† colora√ß√£o?",
  options: [
    "A) Coram-se intensamente de roxo",
    "B) Coram-se de rosa vibrante",
    "C) Possuem citoplasma p√°lido ou pouco corado",
    "D) Apresentam n√∫cleos escuros e citoplasma claro"
  ],
  correctAnswer: "C) Possuem citoplasma p√°lido ou pouco corado",
  comment: "As crom√≥fobas t√™m 'fobia' ao corante, resultando em citoplasma p√°lido ou pouco corado.",
  topic: "Tipos Celulares da Adenohip√≥fise"
},
{
  question: "Qual √© a caracter√≠stica geral das c√©lulas crom√≥filas na adenohip√≥fise?",
  options: [
    "A) N√£o possuem afinidade por corantes",
    "B) T√™m afinidade pelo corante",
    "C) S√£o incolores",
    "D) Apresentam somente o n√∫cleo corado"
  ],
  correctAnswer: "B) T√™m afinidade pelo corante",
  comment: "As crom√≥filas, ao contr√°rio das crom√≥fobas, possuem afinidade pelos corantes.",
  topic: "Tipos Celulares da Adenohip√≥fise"
},
{
  question: "As c√©lulas bas√≥filas da adenohip√≥fise coram-se de qual cor e por qual corante t√™m afinidade?",
  options: [
    "A) Rosa, eosina",
    "B) Roxo/azul, hematoxilina",
    "C) Amarelo, safranina",
    "D) Verde, verde luz"
  ],
  correctAnswer: "B) Roxo/azul, hematoxilina",
  comment: "As bas√≥filas coram-se de roxo/azul devido √† afinidade pela hematoxilina.",
  topic: "Tipos Celulares Crom√≥filas"
},
{
  question: "De que cor as c√©lulas acid√≥filas da adenohip√≥fise se coram e por qual corante t√™m afinidade?",
  options: [
    "A) Roxo/azul, hematoxilina",
    "B) Rosa, eosina",
    "C) Amarelo, safranina",
    "D) Verde, verde luz"
  ],
  correctAnswer: "B) Rosa, eosina",
  comment: "As acid√≥filas coram-se de rosa devido √† afinidade pela eosina.",
  topic: "Tipos Celulares Crom√≥filas"
},
{
  question: "Como os capilares entre os cord√µes celulares da adenohip√≥fise s√£o identificados na histologia?",
  options: [
    "A) Pelo l√∫men escuro e c√©lulas c√∫bicas",
    "B) Pelo espa√ßo claro (l√∫men) e pelo endot√©lio pavimentoso simples (c√©lulas achatadas)",
    "C) Pela presen√ßa de grandes fol√≠culos",
    "D) Pela colora√ß√£o roxa intensa do citoplasma"
  ],
  correctAnswer: "B) Pelo espa√ßo claro (l√∫men) e pelo endot√©lio pavimentoso simples (c√©lulas achatadas)",
  comment: "Os capilares s√£o reconhecidos pelo l√∫men claro e pelo endot√©lio pavimentoso simples.",
  topic: "Identifica√ß√£o Histol√≥gica"
},
{
  question: "Na visualiza√ß√£o histol√≥gica da adenohip√≥fise, como as acid√≥filas, bas√≥filas e crom√≥fobas aparecem, respectivamente?",
  options: [
    "A) Escuras, claras, rosadas",
    "B) Rosadas, escuras (roxas), claras",
    "C) Claras, rosadas, escuras (roxas)",
    "D) Rosadas, claras, escuras (roxas)"
  ],
  correctAnswer: "B) Rosadas, escuras (roxas), claras",
  comment: "As acid√≥filas s√£o rosadas, as bas√≥filas s√£o mais escuras (roxas) e as crom√≥fobas s√£o claras.",
  topic: "Apar√™ncia Celular na Adenohip√≥fise"
},
{
  question: "Em cortes histol√≥gicos, como a pars intermedia √© identificada em rela√ß√£o √†s outras partes da hip√≥fise?",
  options: [
    "A) Pr√≥xima ao osso esfenoide",
    "B) Entre a pars distalis e a neurohip√≥fise",
    "C) Rodeando a pars tuberalis",
    "D) Separada completamente das outras por√ß√µes"
  ],
  correctAnswer: "B) Entre a pars distalis e a neurohip√≥fise",
  comment: "A pars intermedia est√° localizada entre a pars distalis e a neurohip√≥fise.",
  topic: "Localiza√ß√£o da Pars Intermedia"
},
{
  question: "Qual √© uma caracter√≠stica marcante da pars intermedia, mais comum em animais, que consiste na presen√ßa de fol√≠culos ou cistos?",
  options: [
    "A) Presen√ßa de corpos de Herring",
    "B) In√∫meros pitu√≠citos dispersos",
    "C) Fol√≠culos ou cistos contendo uma subst√¢ncia amorfa e eosinof√≠lica chamada coloide",
    "D) C√©lulas em cord√µes densamente compactados"
  ],
  correctAnswer: "C) Fol√≠culos ou cistos contendo uma subst√¢ncia amorfa e eosinof√≠lica chamada coloide",
  comment: "A pars intermedia √© caracterizada pela presen√ßa de fol√≠culos ou cistos com coloide, especialmente em animais.",
  topic: "Histologia da Pars Intermedia"
},
{
  question: "Qual √© a fun√ß√£o da pars intermedia em humanos?",
  options: [
    "A) √â bem definida e essencial para a reprodu√ß√£o",
    "B) N√£o √© t√£o bem definida quanto em outros animais",
    "C) Produz grandes quantidades de ADH",
    "D) √â o principal local de s√≠ntese de ocitocina"
  ],
  correctAnswer: "B) N√£o √© t√£o bem definida quanto em outros animais",
  comment: "Em humanos, a fun√ß√£o da pars intermedia n√£o √© t√£o bem definida.",
  topic: "Fun√ß√£o da Pars Intermedia"
},
{
  question: "Em outros animais, a pars intermedia est√° associada √† secre√ß√£o de qual horm√¥nio?",
  options: [
    "A) Horm√¥nio do crescimento (GH)",
    "B) Horm√¥nio estimulante da tireoide (TSH)",
    "C) Horm√¥nio estimulante de melan√≥citos (MSH)",
    "D) Prolactina"
  ],
  correctAnswer: "C) Horm√¥nio estimulante de melan√≥citos (MSH)",
  comment: "Em outros animais, a pars intermedia est√° associada √† secre√ß√£o de MSH.",
  topic: "Fun√ß√£o da Pars Intermedia (Animais)"
},
{
  question: "Ao mover a l√¢mina para a neurohip√≥fise, como a arquitetura do tecido muda em rela√ß√£o √† densidade celular e apar√™ncia?",
  options: [
    "A) H√° maior densidade celular e apar√™ncia glandular",
    "B) H√° uma densidade celular menor e uma apar√™ncia mais fibrosa",
    "C) H√° forma√ß√£o de fol√≠culos grandes",
    "D) O tecido se torna densamente vascularizado"
  ],
  correctAnswer: "B) H√° uma densidade celular menor e uma apar√™ncia mais fibrosa",
  comment: "A neurohip√≥fise apresenta menor densidade celular e uma apar√™ncia fibrosa devido √† presen√ßa de ax√¥nios.",
  topic: "Histologia da Neurohip√≥fise"
},
{
  question: "Quais s√£o os principais elementos fibrosos presentes na neurohip√≥fise que contribuem para sua apar√™ncia?",
  options: [
    "A) Fibras de col√°geno densas",
    "B) Ax√¥nios amiel√≠nicos",
    "C) Fibras el√°sticas",
    "D) Fibras reticulares"
  ],
  correctAnswer: "B) Ax√¥nios amiel√≠nicos",
  comment: "A neurohip√≥fise possui ax√¥nios amiel√≠nicos que lhe conferem uma apar√™ncia fibrosa.",
  topic: "Componentes da Neurohip√≥fise"
},
{
  question: "As c√©lulas principais encontradas na neurohip√≥fise n√£o s√£o neur√¥nios (cujos corpos est√£o no hipot√°lamo), mas sim c√©lulas da glia especializadas. Qual √© o nome dessas c√©lulas?",
  options: [
    "A) Astr√≥citos",
    "B) Oligodendr√≥citos",
    "C) Pitu√≠citos",
    "D) Micr√≥glia"
  ],
  correctAnswer: "C) Pitu√≠citos",
  comment: "Os pitu√≠citos s√£o as c√©lulas da glia especializadas encontradas na neurohip√≥fise.",
  topic: "C√©lulas da Neurohip√≥fise"
},
{
  question: "Como a professora ensina a diferenciar os pitu√≠citos de outras c√©lulas da glia?",
  options: [
    "A) Pela intensa colora√ß√£o citoplasm√°tica",
    "B) Pelo tamanho e formato do n√∫cleo",
    "C) Pela presen√ßa de m√∫ltiplos nucl√©olos",
    "D) Pela localiza√ß√£o exclusiva em fol√≠culos"
  ],
  correctAnswer: "B) Pelo tamanho e formato do n√∫cleo",
  comment: "Os pitu√≠citos s√£o diferenciados pelo tamanho e formato do n√∫cleo.",
  topic: "Identifica√ß√£o de Pitu√≠citos"
},
{
  question: "Qual √© a fun√ß√£o dos pitu√≠citos na neurohip√≥fise?",
  options: [
    "A) Produ√ß√£o de horm√¥nios como ocitocina e ADH",
    "B) Sustenta√ß√£o e aux√≠lio na libera√ß√£o hormonal",
    "C) Fagocitose de detritos celulares",
    "D) Forma√ß√£o da bainha de mielina"
  ],
  correctAnswer: "B) Sustenta√ß√£o e aux√≠lio na libera√ß√£o hormonal",
  comment: "Os pitu√≠citos s√£o respons√°veis pela sustenta√ß√£o e aux√≠lio na libera√ß√£o de horm√¥nios.",
  topic: "Fun√ß√£o dos Pitu√≠citos"
},
{
  question: "Onde est√£o localizados os corpos celulares dos neur√¥nios que enviam seus ax√¥nios para a neurohip√≥fise?",
  options: [
    "A) Na pr√≥pria neurohip√≥fise",
    "B) No c√≥rtex cerebral",
    "C) No hipot√°lamo",
    "D) No cerebelo"
  ],
  correctAnswer: "C) No hipot√°lamo",
  comment: "Os corpos celulares dos neur√¥nios est√£o localizados no hipot√°lamo.",
  topic: "Conex√£o Neurohip√≥fise-Hipot√°lamo"
},
{
  question: "Que tipo de filamentos s√£o observados na neurohip√≥fise, provenientes do hipot√°lamo?",
  options: [
    "A) Fibras de col√°geno",
    "B) Ax√¥nios miel√≠nicos",
    "C) Ax√¥nios amiel√≠nicos",
    "D) Fibras musculares"
  ],
  correctAnswer: "C) Ax√¥nios amiel√≠nicos",
  comment: "Os filamentos observados s√£o ax√¥nios amiel√≠nicos provenientes do hipot√°lamo.",
  topic: "Componentes da Neurohip√≥fise"
},
{
  question: "O que s√£o os Corpos de Herring na neurohip√≥fise?",
  options: [
    "A) Aglomerados de pitu√≠citos",
    "B) Dilata√ß√µes axonais que acumulam gr√¢nulos neurossecretores",
    "C) Capilares fenestrados",
    "D) Fol√≠culos contendo coloide"
  ],
  correctAnswer: "B) Dilata√ß√µes axonais que acumulam gr√¢nulos neurossecretores",
  comment: "Corpos de Herring s√£o dilata√ß√µes dos ax√¥nios que armazenam horm√¥nios como ocitocina e ADH.",
  topic: "Corpos de Herring"
},
{
  question: "Na microscopia, qual √© a principal caracter√≠stica dos ax√¥nios na neurohip√≥fise?",
  options: [
    "A) N√∫cleos grandes e redondos",
    "B) C√©lulas com citoplasma p√°lido",
    "C) Filamentos eosinof√≠licos (rosados)",
    "D) Presen√ßa de bainha de mielina espessa"
  ],
  correctAnswer: "C) Filamentos eosinof√≠licos (rosados)",
  comment: "Os ax√¥nios na neurohip√≥fise aparecem como filamentos eosinof√≠licos (rosados).",
  topic: "Microscopia da Neurohip√≥fise"
},
{
  question: "Para que a neurohip√≥fise tem uma organiza√ß√£o voltada para a libera√ß√£o de subst√¢ncias em capilares fenestrados?",
  options: [
    "A) Para permitir a fagocitose de detritos",
    "B) Para dificultar a entrada de horm√¥nios na circula√ß√£o",
    "C) Para facilitar a entrada dos horm√¥nios na circula√ß√£o",
    "D) Para reter os horm√¥nios no tecido nervoso"
  ],
  correctAnswer: "C) Para facilitar a entrada dos horm√¥nios na circula√ß√£o",
  comment: "Os capilares fenestrados facilitam a r√°pida entrada dos horm√¥nios na circula√ß√£o sangu√≠nea.",
  topic: "Vasculariza√ß√£o da Neurohip√≥fise"
},
{
  question: "Quais c√©lulas germinativas comp√µem o epit√©lio germinativo no test√≠culo?",
  options: [
    "A) C√©lulas de Leydig e espermat√≥citos",
    "B) Espermatog√¥nias e espermat√≥citos",
    "C) C√©lulas de Sertoli e espermatog√¥nias",
    "D) Apenas espermat√≥citos maduros"
  ],
  correctAnswer: "B) Espermatog√¥nias e espermat√≥citos",
  comment: "O epit√©lio germinativo √© composto por espermatog√¥nias e espermat√≥citos, entre outras c√©lulas germinativas.",
  topic: "Epit√©lio Germinativo"
},
{
  question: "Qual √© a principal fun√ß√£o do epit√©lio germinativo no test√≠culo?",
  options: [
    "A) Produzir horm√¥nios sexuais masculinos",
    "B) Promover a defesa imunol√≥gica do test√≠culo",
    "C) Replica√ß√£o e matura√ß√£o dos gametas",
    "D) Fornecer suporte estrutural aos t√∫bulos semin√≠feros"
  ],
  correctAnswer: "C) Replica√ß√£o e matura√ß√£o dos gametas",
  comment: "A fun√ß√£o do epit√©lio germinativo √© a replica√ß√£o e matura√ß√£o dos gametas (espermatog√™nese).",
  topic: "Fun√ß√£o do Epit√©lio Germinativo"
},
{
  question: "A Barreira Hemato-Testicular √© formada pelas jun√ß√µes oclusivas e desmossomos entre quais c√©lulas adjacentes?",
  options: [
    "A) C√©lulas de Leydig",
    "B) Espermatog√¥nias",
    "C) C√©lulas de Sertoli",
    "D) Macr√≥fagos"
  ],
  correctAnswer: "C) C√©lulas de Sertoli",
  comment: "As jun√ß√µes oclusivas e desmossomos entre as C√©lulas de Sertoli formam a Barreira Hemato-Testicular.",
  topic: "Barreira Hemato-Testicular"
},
{
  question: "Al√©m de formar a barreira, qual √© a fun√ß√£o das C√©lulas de Sertoli em rela√ß√£o ao epit√©lio germinativo?",
  options: [
    "A) Produzir testosterona",
    "B) Atuar como c√©lulas de defesa",
    "C) Organizar o epit√©lio e dar suporte nutricional e estrutural",
    "D) Armazenar espermatozoides maduros"
  ],
  correctAnswer: "C) Organizar o epit√©lio e dar suporte nutricional e estrutural",
  comment: "As C√©lulas de Sertoli organizam o epit√©lio germinativo e fornecem suporte nutricional e estrutural.",
  topic: "Fun√ß√£o das C√©lulas de Sertoli"
},
{
  question: "Por que o corpo n√£o ataca os espermatozoides, garantindo um 'privil√©gio imunol√≥gico' no test√≠culo?",
  options: [
    "A) Porque os espermatozoides n√£o possuem ant√≠genos",
    "B) Porque a barreira hemato-testicular impede o contato das c√©lulas do sistema imune com as c√©lulas germinativas mais avan√ßadas (haploides)",
    "C) Porque os espermatozoides s√£o reconhecidos como c√©lulas pr√≥prias",
    "D) Porque o sistema imune √© inativo no test√≠culo"
  ],
  correctAnswer: "B) Porque a barreira hemato-testicular impede o contato das c√©lulas do sistema imune com as c√©lulas germinativas mais avan√ßadas (haploides)",
  comment: "A barreira hemato-testicular protege as c√©lulas germinativas do sistema imunol√≥gico.",
  topic: "Privil√©gio Imunol√≥gico Testicular"
},
{
  question: "Qual √© a raz√£o principal pela qual as c√©lulas germinativas haploides seriam reconhecidas como estranhas pelo sistema imunol√≥gico, caso a barreira falhasse?",
  options: [
    "A) Elas s√£o muito pequenas para serem identificadas",
    "B) S√£o id√™nticas √†s c√©lulas som√°ticas",
    "C) S√£o geneticamente diferentes das c√©lulas som√°ticas do corpo",
    "D) N√£o possuem prote√≠nas de superf√≠cie"
  ],
  correctAnswer: "C) S√£o geneticamente diferentes das c√©lulas som√°ticas do corpo",
  comment: "As c√©lulas germinativas haploides s√£o geneticamente diferentes e seriam reconhecidas como 'n√£o-pr√≥prias'.",
  topic: "Resposta Imune e C√©lulas Germinativas"
},
{
  question: "Qual seria a consequ√™ncia de uma falha na Barreira Hemato-Testicular para a fertilidade?",
  options: [
    "A) Aumento da produ√ß√£o de espermatozoides",
    "B) Prote√ß√£o imunol√≥gica aprimorada",
    "C) Ataque imunol√≥gico aos espermatozoides, levando √† infertilidade autoimune",
    "D) Diminui√ß√£o da necessidade de c√©lulas de Sertoli"
  ],
  correctAnswer: "C) Ataque imunol√≥gico aos espermatozoides, levando √† infertilidade autoimune",
  comment: "A falha na barreira permitiria o ataque imunol√≥gico, resultando em infertilidade autoimune.",
  topic: "Consequ√™ncias da Falha da Barreira"
},
{
  question: "A falha na barreira hemato-testicular permitiria o ataque imunol√≥gico aos espermatozoides por qual motivo?",
  options: [
    "A) Falta de reconhecimento pelo sistema imune",
    "B) Reconhecimento de algo 'n√£o-pr√≥prio' pelo sistema imune",
    "C) Apenas pelo tamanho das c√©lulas germinativas",
    "D) Altera√ß√£o da cor dos espermatozoides"
  ],
  correctAnswer: "B) Reconhecimento de algo 'n√£o-pr√≥prio' pelo sistema imune",
  comment: "O sistema imunol√≥gico atacaria os espermatozoides porque os reconheceria como 'n√£o-pr√≥prios', n√£o por falta de reconhecimento.",
  topic: "Mecanismo de Ataque Imunol√≥gico"
},
{
  question: "Qual √© a fun√ß√£o vital das C√©lulas de Sertoli que √© refor√ßada na conclus√£o da aula, diferenciando processos de matura√ß√£o de processos imunol√≥gicos?",
  options: [
    "A) Produ√ß√£o de horm√¥nios sexuais",
    "B) Prote√ß√£o das c√©lulas germinativas atrav√©s de uma barreira f√≠sica",
    "C) Remo√ß√£o de espermatozoides defeituosos",
    "D) Regula√ß√£o da temperatura testicular"
  ],
  correctAnswer: "B) Prote√ß√£o das c√©lulas germinativas atrav√©s de uma barreira f√≠sica",
  comment: "A prote√ß√£o das c√©lulas germinativas pela barreira f√≠sica das C√©lulas de Sertoli √© uma fun√ß√£o vital.",
  topic: "Conclus√£o e Fun√ß√£o das C√©lulas de Sertoli"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
<script src="conexao_firebase.js"></script><script src="navegacao.js"></script><script type="module" src="padrao_simulado.js"></script>
</body>
</html>
