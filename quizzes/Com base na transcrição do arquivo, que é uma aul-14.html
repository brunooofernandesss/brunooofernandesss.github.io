
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Com base na transcri√ß√£o do arquivo, que √© uma aul-14</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>Com base na transcri√ß√£o do arquivo, que √© uma aul-14</h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual intera√ß√£o biol√≥gica √© fundamental para o diagn√≥stico laboratorial da gravidez, conforme os fundamentos imunol√≥gicos?",
  options: [
    "A) Rea√ß√£o enzim√°tica-substrato",
    "B) Rea√ß√£o ant√≠geno-anticorpo",
    "C) Intera√ß√£o hormonal-receptor",
    "D) Resposta inflamat√≥ria aguda"
  ],
  correctAnswer: "B) Rea√ß√£o ant√≠geno-anticorpo",
  comment: "O diagn√≥stico laboratorial da gravidez se baseia na detec√ß√£o do HCG atrav√©s da intera√ß√£o espec√≠fica ant√≠geno-anticorpo, onde o HCG atua como ant√≠geno.",
  topic: "Fundamentos Imunol√≥gicos"
},
{
  question: "Qual estrutura √© respons√°vel pela produ√ß√£o do HCG (Gonadotrofina Cori√¥nica Humana) logo ap√≥s a nida√ß√£o?",
  options: [
    "A) Ov√°rio",
    "B) Trofoblasto",
    "C) Corpo l√∫teo",
    "D) Hip√≥fise"
  ],
  correctAnswer: "B) Trofoblasto",
  comment: "O HCG √© produzido pelo trofoblasto, que √© uma camada de c√©lulas que forma a parte externa do blastocisto e que se implanta no endom√©trio.",
  topic: "Produ√ß√£o de HCG"
},
{
  question: "Qual subunidade do HCG √© o alvo espec√≠fico para a detec√ß√£o nos exames de gravidez, sendo excretada em maiores quantidades?",
  options: [
    "A) Subunidade alfa",
    "B) Subunidade Beta (Beta-HCG)",
    "C) Subunidade gama",
    "D) Subunidade delta"
  ],
  correctAnswer: "B) Subunidade Beta (Beta-HCG)",
  comment: "A subunidade Beta do HCG √© a por√ß√£o espec√≠fica e √∫nica desse horm√¥nio, sendo a base para os testes de gravidez, ao contr√°rio da subunidade alfa, que √© comum a outros horm√¥nios.",
  topic: "Estrutura e Especificidade do HCG"
},
{
  question: "A subunidade alfa do HCG √© estruturalmente semelhante a outros horm√¥nios. Quais s√£o eles?",
  options: [
    "A) Insulina, Glucagon e T4",
    "B) LH, FSH e TSH",
    "C) Progesterona, Estradiol e Testosterona",
    "D) Ocitocina, Vasopressina e Prolactina"
  ],
  correctAnswer: "B) LH, FSH e TSH",
  comment: "A subunidade alfa do HCG √© estruturalmente semelhante a esses horm√¥nios hipofis√°rios, por isso n√£o serve como marcador espec√≠fico de gravidez.",
  topic: "Estrutura do HCG"
},
{
  question: "Qual √© a principal fun√ß√£o biol√≥gica do HCG no in√≠cio da gesta√ß√£o?",
  options: [
    "A) Induzir a ovula√ß√£o",
    "B) Manter o corpo l√∫teo ativo para produzir progesterona",
    "C) Estimular a produ√ß√£o de estrog√™nio pelo ov√°rio",
    "D) Promover a matura√ß√£o folicular"
  ],
  correctAnswer: "B) Manter o corpo l√∫teo ativo para produzir progesterona",
  comment: "A progesterona produzida pelo corpo l√∫teo √© essencial para a manuten√ß√£o do endom√©trio e, consequentemente, da gesta√ß√£o.",
  topic: "Fun√ß√£o do HCG"
},
{
  question: "Como os n√≠veis de HCG se comportam no in√≠cio da gesta√ß√£o?",
  options: [
    "A) Permanecem constantes e depois caem",
    "B) Come√ßam baixos, aumentam exponencialmente, atingem um pico, estabilizam e caem",
    "C) Come√ßam altos e diminuem progressivamente",
    "D) Apresentam flutua√ß√µes irregulares"
  ],
  correctAnswer: "B) Come√ßam baixos, aumentam exponencialmente, atingem um pico, estabilizam e caem",
  comment: "Essa curva de eleva√ß√£o e posterior estabiliza√ß√£o/queda √© caracter√≠stica do HCG na gravidez, sendo fundamental para o monitoramento.",
  topic: "Din√¢mica dos N√≠veis de HCG"
},
{
  question: "Em quais amostras biol√≥gicas o exame para detectar HCG pode ser realizado?",
  options: [
    "A) Apenas no sangue (dosagem s√©rica)",
    "B) Apenas na urina",
    "C) Tanto no sangue (dosagem s√©rica) quanto na urina",
    "D) Apenas no l√≠quido cefalorraquidiano"
  ],
  correctAnswer: "C) Tanto no sangue (dosagem s√©rica) quanto na urina",
  comment: "O HCG √© detect√°vel tanto no sangue quanto na urina, sendo o sangue geralmente mais sens√≠vel no in√≠cio da gesta√ß√£o.",
  topic: "M√©todos de Detec√ß√£o de HCG"
},
{
  question: "Qual o princ√≠pio de funcionamento dos testes imunocromatogr√°ficos (testes r√°pidos de farm√°cia/urina) para detec√ß√£o de gravidez?",
  options: [
    "A) Rea√ß√£o de precipita√ß√£o em gel",
    "B) Migra√ß√£o capilar da urina carregando o ant√≠geno",
    "C) Detec√ß√£o por espectrometria de massa",
    "D) An√°lise de DNA fetal livre"
  ],
  correctAnswer: "B) Migra√ß√£o capilar da urina carregando o ant√≠geno",
  comment: "A urina sobe pela fita por press√£o negativa, carregando consigo o HCG (ant√≠geno) para interagir com os anticorpos marcados.",
  topic: "Testes R√°pidos de Gravidez"
},
{
  question: "Como a linha de teste dos testes imunocromatogr√°ficos gera um resultado positivo para gravidez?",
  options: [
    "A) Pela forma√ß√£o de bolhas de ar na fita",
    "B) Pelo ac√∫mulo de complexos ant√≠geno-anticorpo marcados com color√≠metro em anticorpos fixos",
    "C) Pela dissolu√ß√£o completa da fita reativa",
    "D) Pela altera√ß√£o do pH da amostra de urina"
  ],
  correctAnswer: "B) Pelo ac√∫mulo de complexos ant√≠geno-anticorpo marcados com color√≠metro em anticorpos fixos",
  comment: "Quando o HCG (ant√≠geno) se liga aos anticorpos marcados, o complexo migra at√© a linha de teste, onde se liga a anticorpos fixos, gerando a cor vis√≠vel.",
  topic: "Mecanismo de Rea√ß√£o em Testes R√°pidos"
},
{
  question: "Qual a fun√ß√£o da linha de controle em um teste imunocromatogr√°fico de gravidez e o que sua aus√™ncia indica?",
  options: [
    "A) Confirma a presen√ßa de HCG e indica gravidez avan√ßada",
    "B) Captura o excesso de anticorpos e sua aus√™ncia indica teste inv√°lido",
    "C) Indica a concentra√ß√£o exata de HCG no sangue",
    "D) Previne falsos negativos por urina dilu√≠da"
  ],
  correctAnswer: "B) Captura o excesso de anticorpos e sua aus√™ncia indica teste inv√°lido",
  comment: "A linha de controle garante que a migra√ß√£o capilar e os reagentes est√£o funcionando corretamente. Sua aus√™ncia significa falha e o teste deve ser descartado.",
  topic: "Valida√ß√£o de Testes R√°pidos"
},
{
  question: "Por que os testes de gravidez utilizam anticorpos sint√©ticos anti-HCG, e n√£o dependem da produ√ß√£o de anticorpos naturais pelo corpo humano?",
  options: [
    "A) Porque o corpo humano s√≥ produz anticorpos em infec√ß√µes virais",
    "B) Porque o HCG √© um horm√¥nio end√≥geno na gesta√ß√£o, e o corpo humano n√£o produz anticorpos contra ele naturalmente",
    "C) Porque os anticorpos naturais s√£o muito caros para serem isolados",
    "D) Porque a produ√ß√£o de anticorpos naturais √© muito lenta para um diagn√≥stico r√°pido"
  ],
  correctAnswer: "B) Porque o HCG √© um horm√¥nio end√≥geno na gesta√ß√£o, e o corpo humano n√£o produz anticorpos contra ele naturalmente",
  comment: "O sistema imune materno n√£o considera o HCG 'estranho' para produzir anticorpos, pois √© um horm√¥nio produzido pelo pr√≥prio organismo durante a gesta√ß√£o.",
  topic: "Anticorpos em Testes de HCG"
},
{
  question: "Qual a diferen√ßa principal entre o teste r√°pido imunocromatogr√°fico e os testes de laborat√≥rio imunom√©tricos para HCG?",
  options: [
    "A) O teste r√°pido √© quantitativo, e o de laborat√≥rio √© qualitativo",
    "B) O teste r√°pido √© qualitativo (positivo/negativo), e o de laborat√≥rio √© quantitativo (mede concentra√ß√£o)",
    "C) Ambos s√£o qualitativos, mas o de laborat√≥rio √© mais r√°pido",
    "D) Ambos s√£o quantitativos, mas o teste r√°pido √© mais preciso"
  ],
  correctAnswer: "B) O teste r√°pido √© qualitativo (positivo/negativo), e o de laborat√≥rio √© quantitativo (mede concentra√ß√£o)",
  comment: "Testes r√°pidos apenas informam a presen√ßa ou aus√™ncia. Testes de laborat√≥rio fornecem a concentra√ß√£o exata de HCG, o que √© √∫til para monitoramento.",
  topic: "Tipos de Testes de HCG"
},
{
  question: "Qual a import√¢ncia da quantifica√ß√£o dos n√≠veis de HCG no acompanhamento da gravidez?",
  options: [
    "A) Apenas para confirmar a presen√ßa de gravidez",
    "B) Estimar a idade gestacional, avaliar a evolu√ß√£o da gravidez e identificar gesta√ß√µes gemelares",
    "C) Determinar o sexo do beb√™",
    "D) Diagnosticar malforma√ß√µes fetais precocemente"
  ],
  correctAnswer: "B) Estimar a idade gestacional, avaliar a evolu√ß√£o da gravidez e identificar gesta√ß√µes gemelares",
  comment: "N√≠veis quantitativos de HCG oferecem informa√ß√µes valiosas sobre o desenvolvimento da gesta√ß√£o e poss√≠veis anormalidades, como gesta√ß√µes m√∫ltiplas ou ect√≥picas.",
  topic: "Quantifica√ß√£o do HCG"
},
{
  question: "Quais s√£o as principais causas de falsos positivos em testes de gravidez, de acordo com o texto?",
  options: [
    "A) Urina muito dilu√≠da, erro na execu√ß√£o do teste, baixa ingest√£o de l√≠quidos",
    "B) Anticorpos heterof√≠licos, uso de HCG ex√≥geno em tratamentos de fertilidade, neoplasias",
    "C) Jejum prolongado, exerc√≠cios f√≠sicos intensos, estresse",
    "D) Gravidez ect√≥pica, aborto espont√¢neo, gravidez molar"
  ],
  correctAnswer: "B) Anticorpos heterof√≠licos, uso de HCG ex√≥geno em tratamentos de fertilidade, neoplasias",
  comment: "Esses fatores podem levar √† detec√ß√£o de subst√¢ncias que mimetizam o HCG ou a presen√ßa real de HCG n√£o gestacional.",
  topic: "Falsos Positivos em Testes de Gravidez"
},
{
  question: "O que s√£o anticorpos heterof√≠licos e como eles podem causar um falso positivo em um teste de gravidez?",
  options: [
    "A) S√£o anticorpos produzidos pelo embri√£o que reagem com o teste",
    "B) S√£o anticorpos no sangue da paciente que reagem cruzadamente com os reagentes do teste",
    "C) S√£o anticorpos injetados para tratamento de infertilidade",
    "D) S√£o anticorpos que protegem a paciente de infec√ß√µes durante a gravidez"
  ],
  correctAnswer: "B) S√£o anticorpos no sangue da paciente que reagem cruzadamente com os reagentes do teste",
  comment: "Esses anticorpos podem interferir na especificidade do teste, levando a uma leitura positiva sem a presen√ßa de HCG gestacional.",
  topic: "Falsos Positivos: Anticorpos Heterof√≠licos"
},
{
  question: "Como o uso de HCG ex√≥geno pode causar um falso positivo em um teste de gravidez?",
  options: [
    "A) O HCG ex√≥geno estimula a produ√ß√£o de HCG natural",
    "B) O HCG ex√≥geno √© detectado pelo teste, simulando uma gravidez",
    "C) O HCG ex√≥geno reage com o sistema imune da paciente",
    "D) O HCG ex√≥geno causa a degrada√ß√£o dos reagentes do teste"
  ],
  correctAnswer: "B) O HCG ex√≥geno √© detectado pelo teste, simulando uma gravidez",
  comment: "Mulheres submetidas a tratamentos de fertilidade que utilizam inje√ß√µes de HCG podem ter resultados positivos que n√£o correspondem a uma gravidez natural.",
  topic: "Falsos Positivos: Medicamentos"
},
{
  question: "Al√©m da gravidez, qual outra condi√ß√£o m√©dica pode levar √† produ√ß√£o de HCG e, consequentemente, a um resultado positivo em testes de gravidez?",
  options: [
    "A) Infec√ß√µes virais",
    "B) Diabetes Mellitus",
    "C) Neoplasias",
    "D) Hipertireoidismo"
  ],
  correctAnswer: "C) Neoplasias",
  comment: "Alguns tumores, devido a desdiferencia√ß√£o celular, podem produzir HCG, levando a um resultado positivo em testes de gravidez fora do contexto gestacional.",
  topic: "Produ√ß√£o Ect√≥pica de HCG"
},
{
  question: "Em um cen√°rio cl√≠nico de uma paciente idosa, menopausada e laqueada, um teste de HCG positivo mais provavelmente indica o qu√™?",
  options: [
    "A) Uma gravidez tardia",
    "B) Uma gravidez ect√≥pica",
    "C) Uma prov√°vel neoplasia produtora de HCG",
    "D) Um erro laboratorial insignificante"
  ],
  correctAnswer: "C) Uma prov√°vel neoplasia produtora de HCG",
  comment: "Devido √†s caracter√≠sticas da paciente (menopausada e laqueada), a gravidez √© fisiologicamente imposs√≠vel, tornando a neoplasia a explica√ß√£o mais plaus√≠vel.",
  topic: "HCG como Marcador Tumoral"
},
{
  question: "Quais tipos de tumores podem produzir HCG ect√≥pico?",
  options: [
    "A) Apenas tumores benignos de pele",
    "B) Tumores de c√©lulas germinativas (test√≠culo e ov√°rio) ou carcinomas epiteliais (pulm√£o, est√¥mago)",
    "C) Exclusivamente adenomas de hip√≥fise",
    "D) Apenas tumores √≥sseos"
  ],
  correctAnswer: "B) Tumores de c√©lulas germinativas (test√≠culo e ov√°rio) ou carcinomas epiteliais (pulm√£o, est√¥mago)",
  comment: "Estes tumores podem sofrer desdiferencia√ß√£o celular ou reativa√ß√£o g√™nica, passando a expressar a subunidade beta do HCG ou o horm√¥nio intacto.",
  topic: "Tipos de Neoplasias Produtoras de HCG"
},
{
  question: "Qual o mecanismo pelo qual c√©lulas tumorais passam a produzir HCG?",
  options: [
    "A) Hiperatividade glandular generalizada",
    "B) Desdiferencia√ß√£o celular ou reativa√ß√£o g√™nica",
    "C) Infec√ß√£o viral das c√©lulas tumorais",
    "D) Consumo excessivo de alimentos ricos em HCG"
  ],
  correctAnswer: "B) Desdiferencia√ß√£o celular ou reativa√ß√£o g√™nica",
  comment: "As c√©lulas tumorais expressam genes que normalmente estariam silenciados, resultando na produ√ß√£o de HCG.",
  topic: "Mecanismo de Produ√ß√£o Ect√≥pica"
},
{
  question: "Qual a fun√ß√£o estrat√©gica do HCG produzido por um tumor para o c√¢ncer?",
  options: [
    "A) Estimular o crescimento de outros tecidos saud√°veis",
    "B) Deprimir o sistema imune e inibir a apoptose, protegendo o tumor",
    "C) Induzir a cicatriza√ß√£o de feridas no local do tumor",
    "D) Aumentar a sensibilidade do tumor a quimioterapia"
  ],
  correctAnswer: "B) Deprimir o sistema imune e inibir a apoptose, protegendo o tumor",
  comment: "Assim como na gesta√ß√£o normal, onde o HCG protege o feto (aloenxerto), no c√¢ncer ele confere uma 'camuflagem' imunol√≥gica, facilitando o crescimento e met√°stase.",
  topic: "HCG e Mecanismos de Escape Tumoral"
},
{
  question: "Como a produ√ß√£o de HCG por um tumor se relaciona com sua agressividade?",
  options: [
    "A) Tumores que produzem HCG tendem a ser menos agressivos",
    "B) A produ√ß√£o de HCG n√£o tem rela√ß√£o com a agressividade do tumor",
    "C) Tumores que produzem HCG tendem a ser mais agressivos devido √† camuflagem imunol√≥gica",
    "D) O HCG inibe a met√°stase de tumores"
  ],
  correctAnswer: "C) Tumores que produzem HCG tendem a ser mais agressivos devido √† camuflagem imunol√≥gica",
  comment: "A capacidade de suprimir a resposta imune permite que o tumor cres√ßa e se dissemine mais facilmente, tornando-o mais agressivo.",
  topic: "Progn√≥stico de Tumores Produtores de HCG"
},
{
  question: "Por que o feto √© considerado um 'aloenxerto' ou 'semialog√™nico' para a m√£e?",
  options: [
    "A) Porque ele possui 100% de sua carga gen√©tica da m√£e",
    "B) Porque 50% de sua carga gen√©tica vem do pai e √© estranha ao sistema imune materno",
    "C) Porque ele √© geneticamente id√™ntico √† m√£e",
    "D) Porque ele n√£o possui material gen√©tico pr√≥prio"
  ],
  correctAnswer: "B) Porque 50% de sua carga gen√©tica vem do pai e √© estranha ao sistema imune materno",
  comment: "A heran√ßa gen√©tica paterna faz com que o feto apresente ant√≠genos que o sistema imune materno poderia teoricamente reconhecer como estranhos, necessitando de adapta√ß√µes imunol√≥gicas para evitar a rejei√ß√£o.",
  topic: "Imunologia da Gesta√ß√£o"
},
{
  question: "Em rela√ß√£o √† exposi√ß√£o pr√©via ao s√™men, qual √© a teoria abordada sobre sua influ√™ncia na imunologia da gesta√ß√£o?",
  options: [
    "A) A exposi√ß√£o ao s√™men sempre causa infertilidade",
    "B) A exposi√ß√£o cont√≠nua ao s√™men pode gerar toler√¢ncia imunol√≥gica ou, em outros casos, gerar anticorpos que causam infertilidade",
    "C) A exposi√ß√£o ao s√™men n√£o tem qualquer impacto imunol√≥gico",
    "D) A exposi√ß√£o ao s√™men estimula exclusivamente a produ√ß√£o de HCG"
  ],
  correctAnswer: "B) A exposi√ß√£o cont√≠nua ao s√™men pode gerar toler√¢ncia imunol√≥gica ou, em outros casos, gerar anticorpos que causam infertilidade",
  comment: "Esta dualidade reflete a complexidade da resposta imunol√≥gica, onde o mesmo est√≠mulo pode ter efeitos opostos em indiv√≠duos diferentes.",
  topic: "Toler√¢ncia Imunol√≥gica na Gesta√ß√£o"
},
{
  question: "A Eritroblastose Fetal geralmente se manifesta em qual gesta√ß√£o de um feto Rh positivo em uma m√£e Rh negativo?",
  options: [
    "A) Apenas na primeira gesta√ß√£o",
    "B) Principalmente na segunda gesta√ß√£o em diante",
    "C) Em todas as gesta√ß√µes, sem distin√ß√£o",
    "D) Apenas se a m√£e j√° for previamente sensibilizada antes da primeira gravidez"
  ],
  correctAnswer: "B) Principalmente na segunda gesta√ß√£o em diante",
  comment: "Na primeira gesta√ß√£o, a m√£e geralmente √© sensibilizada no parto, produzindo anticorpos. Na segunda gesta√ß√£o, esses anticorpos IgG j√° est√£o presentes e podem atacar o feto Rh positivo.",
  topic: "Eritroblastose Fetal"
},
{
  question: "Qual o mecanismo da Eritroblastose Fetal em uma segunda gesta√ß√£o de feto Rh positivo por uma m√£e Rh negativo sensibilizada?",
  options: [
    "A) As c√©lulas fetais atacam o sistema imune materno",
    "B) Os anticorpos IgG maternos atravessam a placenta e atacam as hem√°cias do feto",
    "C) O sangue materno e fetal se misturam antes do parto, causando rea√ß√£o imediata",
    "D) O feto produz anticorpos contra as c√©lulas maternas"
  ],
  correctAnswer: "B) Os anticorpos IgG maternos atravessam a placenta e atacam as hem√°cias do feto",
  comment: "Os anticorpos IgG s√£o os √∫nicos que conseguem atravessar a barreira placent√°ria, causando a hem√≥lise das hem√°cias fetais.",
  topic: "Patofisiologia da Eritroblastose Fetal"
},
{
  question: "Como a Barreira Placent√°ria contribui para a toler√¢ncia imunol√≥gica na gravidez?",
  options: [
    "A) Permite a passagem de todas as c√©lulas imunes maternas para o feto",
    "B) Impede a passagem de c√©lulas imunes maternas (como NK e macr√≥fagos) para o feto, mas permite IgG para imunidade passiva",
    "C) Bloqueia completamente toda a comunica√ß√£o entre m√£e e feto",
    "D) Ativa fortemente a resposta imune materna contra o feto"
  ],
  correctAnswer: "B) Impede a passagem de c√©lulas imunes maternas (como NK e macr√≥fagos) para o feto, mas permite IgG para imunidade passiva",
  comment: "O sinciciotrofoblasto atua como uma barreira protetora para o feto, ao mesmo tempo em que permite a transfer√™ncia de imunidade essencial.",
  topic: "Adapta√ß√µes Imunol√≥gicas na Gesta√ß√£o"
},
{
  question: "Qual a altera√ß√£o no perfil de citocinas e c√©lulas imunes que cria um ambiente anti-inflamat√≥rio e contribui para a imunossupress√£o modulada na gesta√ß√£o?",
  options: [
    "A) Aumento de c√©lulas Natural Killer e Interferon-gama",
    "B) Aumento de T-reguladores, Interleucina-10 (IL-10) e TGF-Beta",
    "C) Diminui√ß√£o de macr√≥fagos e Linf√≥citos B",
    "D) Aumento de neutr√≥filos e IL-6"
  ],
  correctAnswer: "B) Aumento de T-reguladores, Interleucina-10 (IL-10) e TGF-Beta",
  comment: "Esses componentes imunol√≥gicos promovem a toler√¢ncia e inibem a inflama√ß√£o que poderia ser prejudicial ao feto.",
  topic: "Imunossupress√£o Modulada na Gesta√ß√£o"
},
{
  question: "Quais horm√¥nios atuam deprimindo a resposta imune materna durante a gravidez?",
  options: [
    "A) Estrog√™nio e Testosterona",
    "B) Progesterona e Glicocorticoides (Cortisol)",
    "C) Ocitocina e Vasopressina",
    "D) Tireoidianos (T3 e T4)"
  ],
  correctAnswer: "B) Progesterona e Glicocorticoides (Cortisol)",
  comment: "A progesterona √© crucial para a manuten√ß√£o da gravidez e, juntamente com os glicocorticoides, contribui para a imunossupress√£o materna.",
  topic: "Papel Hormonal na Imunossupress√£o"
},
{
  question: "Qual a consequ√™ncia da depress√£o da resposta imune materna por horm√¥nios durante a gravidez?",
  options: [
    "A) Maior resist√™ncia a infec√ß√µes",
    "B) Aumento da energia e disposi√ß√£o",
    "C) Maior suscetibilidade das gestantes a infec√ß√µes (como gripe e infec√ß√£o urin√°ria)",
    "D) Redu√ß√£o do risco de doen√ßas autoimunes"
  ],
  correctAnswer: "C) Maior suscetibilidade das gestantes a infec√ß√µes (como gripe e infec√ß√£o urin√°ria)",
  comment: "Embora essencial para proteger o feto, a imunossupress√£o hormonal torna a gestante mais vulner√°vel a certos pat√≥genos.",
  topic: "Complica√ß√µes da Imunossupress√£o"
},
{
  question: "Como √© calculada a Idade Embrion√°ria da gravidez?",
  options: [
    "A) A partir do primeiro dia da √∫ltima menstrua√ß√£o (DUM)",
    "B) A partir da fecunda√ß√£o, cerca de 2 semanas ap√≥s a DUM",
    "C) A partir do momento da nida√ß√£o",
    "D) Com base no tamanho do √∫tero"
  ],
  correctAnswer: "B) A partir da fecunda√ß√£o, cerca de 2 semanas ap√≥s a DUM",
  comment: "A idade embrion√°ria reflete o tempo real de desenvolvimento do embri√£o.",
  topic: "Data√ß√£o da Gravidez: Idade Embrion√°ria"
},
{
  question: "Qual m√©todo de data√ß√£o da gravidez √© o mais usado clinicamente e a partir de qual evento √© contado?",
  options: [
    "A) Idade Embrion√°ria, contando a partir da nida√ß√£o",
    "B) Idade Obst√©trica (Gestacional), contando a partir do primeiro dia da Data da √öltima Menstrua√ß√£o (DUM)",
    "C) Idade Gestacional, contando a partir do dia da rela√ß√£o sexual",
    "D) Idade Fetal, a partir do in√≠cio da organog√™nese"
  ],
  correctAnswer: "B) Idade Obst√©trica (Gestacional), contando a partir do primeiro dia da Data da √öltima Menstrua√ß√£o (DUM)",
  comment: "Este √© o m√©todo padr√£o de data√ß√£o, resultando em uma gravidez de aproximadamente 40 semanas.",
  topic: "Data√ß√£o da Gravidez: Idade Obst√©trica"
},
{
  question: "De acordo com a Regra de Naegele, como se calcula a Data Prov√°vel do Parto (DPP)?",
  options: [
    "A) DUM - 7 dias + 3 meses + 1 ano",
    "B) DUM + 7 dias - 3 meses + 1 ano (se necess√°rio)",
    "C) DUM + 14 dias - 2 meses",
    "D) DUM - 14 dias + 2 meses"
  ],
  correctAnswer: "B) DUM + 7 dias - 3 meses + 1 ano (se necess√°rio)",
  comment: "Esta √© a f√≥rmula cl√°ssica para estimar a DPP com base na Data da √öltima Menstrua√ß√£o.",
  topic: "C√°lculo da Data Prov√°vel do Parto"
},
{
  question: "O que s√£o terat√≥genos?",
  options: [
    "A) Agentes que promovem o crescimento fetal saud√°vel",
    "B) Subst√¢ncias que protegem o feto de infec√ß√µes",
    "C) Agentes que causam malforma√ß√µes ou altera√ß√µes funcionais no feto",
    "D) Horm√¥nios essenciais para o desenvolvimento embrion√°rio"
  ],
  correctAnswer: "C) Agentes que causam malforma√ß√µes ou altera√ß√µes funcionais no feto",
  comment: "Terat√≥genos s√£o quaisquer agentes (qu√≠micos, f√≠sicos ou biol√≥gicos) capazes de induzir defeitos cong√™nitos durante o desenvolvimento pr√©-natal.",
  topic: "Teratog√™nese"
},
{
  question: "Qual o efeito da exposi√ß√£o a um terat√≥geno nas primeiras 0 a 2 semanas de gesta√ß√£o?",
  options: [
    "A) Alto risco de malforma√ß√µes estruturais graves",
    "B) Lei do 'tudo ou nada': ou aborta ou o embri√£o se recupera totalmente sem malforma√ß√µes",
    "C) Apenas danos funcionais leves e revers√≠veis",
    "D) Risco aumentado de baixo peso ao nascer"
  ],
  correctAnswer: "B) Lei do 'tudo ou nada': ou aborta ou o embri√£o se recupera totalmente sem malforma√ß√µes",
  comment: "Neste per√≠odo, o embri√£o ainda n√£o est√° completamente implantado ou organizado, e o dano √© t√£o grande que causa um aborto, ou o embri√£o tem capacidade de compensar o dano sem sequelas graves.",
  topic: "Per√≠odos Cr√≠ticos da Teratog√™nese"
},
{
  question: "Qual per√≠odo gestacional √© considerado a fase da organog√™nese, com risco m√°ximo de malforma√ß√µes estruturais graves devido √† exposi√ß√£o a terat√≥genos?",
  options: [
    "A) 0 a 2 semanas",
    "B) 3 a 8 semanas (Per√≠odo Embrion√°rio)",
    "C) 9 a 12 semanas (In√≠cio do Per√≠odo Fetal)",
    "D) Ap√≥s 20 semanas de gesta√ß√£o"
  ],
  correctAnswer: "B) 3 a 8 semanas (Per√≠odo Embrion√°rio)",
  comment: "√â nesta fase que os principais √≥rg√£os e sistemas est√£o se formando, tornando o embri√£o extremamente vulner√°vel a agentes teratog√™nicos.",
  topic: "Teratog√™nese: Per√≠odo Embrion√°rio"
},
{
  question: "Durante o Per√≠odo Fetal (a partir de 9 semanas), como o risco de malforma√ß√µes estruturais graves se compara aos per√≠odos anteriores, e que tipo de dano ainda pode ocorrer?",
  options: [
    "A) O risco de malforma√ß√µes estruturais graves √© m√°ximo e persistente",
    "B) O risco diminui, mas ainda pode haver danos funcionais",
    "C) N√£o h√° mais risco de qualquer tipo de dano",
    "D) O risco √© o mesmo do per√≠odo embrion√°rio"
  ],
  correctAnswer: "B) O risco diminui, mas ainda pode haver danos funcionais",
  comment: "No per√≠odo fetal, os √≥rg√£os j√° est√£o formados, mas continuam amadurecendo e crescendo, o que os torna suscet√≠veis a danos funcionais, mesmo que a estrutura geral seja preservada.",
  topic: "Teratog√™nese: Per√≠odo Fetal"
},
{
  question: "Quais s√£o os principais efeitos do tabagismo materno na gesta√ß√£o?",
  options: [
    "A) Aumento da transfer√™ncia de anticorpos maternos, peso fetal elevado",
    "B) Vasodilata√ß√£o placent√°ria, oxigena√ß√£o fetal aprimorada",
    "C) Vasoconstri√ß√£o placent√°ria, hip√≥xia fetal, redu√ß√£o da transfer√™ncia de anticorpos, baixo peso e atraso no crescimento",
    "D) Acelera√ß√£o do desenvolvimento pulmonar fetal"
  ],
  correctAnswer: "C) Vasoconstri√ß√£o placent√°ria, hip√≥xia fetal, redu√ß√£o da transfer√™ncia de anticorpos, baixo peso e atraso no crescimento",
  comment: "O tabagismo √© um terat√≥geno bem conhecido, com m√∫ltiplos efeitos delet√©rios no desenvolvimento fetal devido √† restri√ß√£o do fluxo sangu√≠neo e da oxigena√ß√£o.",
  topic: "Terat√≥genos: Tabagismo"
},
{
  question: "Qual o efeito teratog√™nico da Isotretino√≠na (Roacutan) na gesta√ß√£o?",
  options: [
    "A) Causa baixo peso ao nascer",
    "B) Causa focomelia",
    "C) Causa graves malforma√ß√µes no sistema nervoso central e card√≠acas",
    "D) Causa S√≠ndrome Alco√≥lica Fetal"
  ],
  correctAnswer: "C) Causa graves malforma√ß√µes no sistema nervoso central e card√≠acas",
  comment: "A Isotretino√≠na √© um terat√≥geno potente, com alto risco de causar defeitos cong√™nitos graves, exigindo medidas contraceptivas rigorosas antes, durante e ap√≥s o tratamento.",
  topic: "Terat√≥genos: Isotretino√≠na"
},
{
  question: "Qual a principal preocupa√ß√£o teratog√™nica associada ao √Åcido Valproico (anticonvulsivante) na gravidez e qual a recomenda√ß√£o em caso de uso?",
  options: [
    "A) Risco de malforma√ß√µes card√≠acas e suspens√£o abrupta da medica√ß√£o",
    "B) Associado a defeitos no tubo neural, sendo a recomenda√ß√£o n√£o parar abruptamente, mas trocar o f√°rmaco se poss√≠vel e suplementar com altas doses de √°cido f√≥lico",
    "C) Risco de baixo peso ao nascer e redu√ß√£o da dose",
    "D) Risco de focomelia e monitoramento apenas por ultrassom"
  ],
  correctAnswer: "B) Associado a defeitos no tubo neural, sendo a recomenda√ß√£o n√£o parar abruptamente, mas trocar o f√°rmaco se poss√≠vel e suplementar com altas doses de √°cido f√≥lico",
  comment: "O √°cido valproico √© um conhecido terat√≥geno neural. A interrup√ß√£o abrupta pode causar convuls√µes maternas, por isso a estrat√©gia envolve mitiga√ß√£o de riscos atrav√©s de ajustes de medica√ß√£o e suplementa√ß√£o.",
  topic: "Terat√≥genos: √Åcido Valproico"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
</body>
</html>
