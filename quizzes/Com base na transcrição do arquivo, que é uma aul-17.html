
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Com base na transcri√ß√£o do arquivo, que √© uma aul-17</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>Com base na transcri√ß√£o do arquivo, que √© uma aul-17</h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual das seguintes op√ß√µes descreve corretamente as tr√™s camadas principais da parede uterina?",
  options: [
    "A) Epim√©trio, Miom√©trio e Endom√©trio",
    "B) Endom√©trio, Miom√©trio e Perim√©trio",
    "C) Serosa, Mucosa e Submucosa",
    "D) Camada Funcional, Camada Basal e Advent√≠cia"
  ],
  correctAnswer: "B) Endom√©trio, Miom√©trio e Perim√©trio",
  comment: "O √∫tero possui tr√™s camadas principais: a mucosa interna (endom√©trio), a camada muscular intermedi√°ria (miom√©trio) e a camada externa (perim√©trio ou serosa).",
  topic: "Histologia do √ötero"
},
{
  question: "Qual o tipo de epit√©lio que reveste o endom√©trio histologicamente?",
  options: [
    "A) Epit√©lio pavimentoso estratificado",
    "B) Epit√©lio simples cil√≠ndrico",
    "C) Epit√©lio c√∫bico simples",
    "D) Epit√©lio pseudoestratificado colunar"
  ],
  correctAnswer: "B) Epit√©lio simples cil√≠ndrico",
  comment: "O endom√©trio √© revestido por um epit√©lio simples cil√≠ndrico, tamb√©m conhecido como colunar.",
  topic: "Endom√©trio"
},
{
  question: "Qual a composi√ß√£o da l√¢mina pr√≥pria do endom√©trio?",
  options: [
    "A) Tecido muscular denso com vasos sangu√≠neos",
    "B) Tecido conjuntivo frouxo com gl√¢ndulas tubulares simples",
    "C) Tecido conjuntivo denso n√£o modelado com nervos",
    "D) Tecido adiposo e vasos linf√°ticos"
  ],
  correctAnswer: "B) Tecido conjuntivo frouxo com gl√¢ndulas tubulares simples",
  comment: "A l√¢mina pr√≥pria do endom√©trio √© composta por tecido conjuntivo frouxo, onde est√£o mergulhadas as gl√¢ndulas tubulares simples.",
  topic: "Endom√©trio"
},
{
  question: "Na fase proliferativa do ciclo menstrual, como se apresentam as gl√¢ndulas do endom√©trio?",
  options: [
    "A) Curtas, retas e pequenas",
    "B) Longas e tortuosas",
    "C) Atr√≥ficas e fibrosadas",
    "D) Dilatadas e preenchidas por secre√ß√£o"
  ],
  correctAnswer: "B) Longas e tortuosas",
  comment: "Sob efeito estrog√™nico na fase proliferativa, o endom√©trio espessa e as gl√¢ndulas tornam-se mais longas e tortuosas.",
  topic: "Endom√©trio - Ciclo Menstrual"
},
{
  question: "Qual por√ß√£o do endom√©trio √© respons√°vel pela regenera√ß√£o ap√≥s a menstrua√ß√£o?",
  options: [
    "A) A camada funcional",
    "B) A camada basal",
    "C) O perim√©trio",
    "D) O miom√©trio"
  ],
  correctAnswer: "B) A camada basal",
  comment: "A camada basal √© a por√ß√£o mais profunda do endom√©trio que n√£o descama e serve como fonte regenerativa para reconstruir a camada funcional.",
  topic: "Divis√£o Funcional do Endom√©trio"
},
{
  question: "Uma les√£o na camada basal do endom√©trio, como por curetagem excessiva, pode levar a qual condi√ß√£o cl√≠nica?",
  options: [
    "A) Endometriose",
    "B) Leiomioma",
    "C) Infertilidade devido √† falha de nida√ß√£o",
    "D) Dismenorreia prim√°ria"
  ],
  correctAnswer: "C) Infertilidade devido √† falha de nida√ß√£o",
  comment: "Les√µes na camada basal podem impedir a regenera√ß√£o do endom√©trio, resultando em um endom√©trio n√£o espesso o suficiente para a nida√ß√£o e, consequentemente, infertilidade.",
  topic: "Correla√ß√£o Cl√≠nica - Endom√©trio"
},
{
  question: "O miom√©trio √© a camada mais espessa do √∫tero. Do que ele √© constitu√≠do principalmente?",
  options: [
    "A) Tecido conjuntivo denso e gl√¢ndulas",
    "B) Feixes de m√∫sculo liso organizados em diversos sentidos",
    "C) Epit√©lio pavimentoso e vasos linf√°ticos",
    "D) Tecido adiposo e fibras el√°sticas"
  ],
  correctAnswer: "B) Feixes de m√∫sculo liso organizados em diversos sentidos",
  comment: "O miom√©trio √© constitu√≠do por feixes de m√∫sculo liso organizados em diversas dire√ß√µes (longitudinal, circular, obl√≠quo), separados por tecido conjuntivo.",
  topic: "Miom√©trio"
},
{
  question: "Qual patologia comum √© caracterizada pelo crescimento benigno e desordenado das c√©lulas musculares lisas do miom√©trio?",
  options: [
    "A) Endometriose",
    "B) Adenomiose",
    "C) Leiomioma (mioma)",
    "D) C√¢ncer de endom√©trio"
  ],
  correctAnswer: "C) Leiomioma (mioma)",
  comment: "O leiomioma, ou mioma, √© um crescimento benigno e desordenado das c√©lulas musculares lisas do miom√©trio, sendo uma patologia comum.",
  topic: "Patologias do √ötero"
},
{
  question: "O que causa a dor da c√≥lica menstrual (dismenorreia) de acordo com a explica√ß√£o histol√≥gica?",
  options: [
    "A) Inflama√ß√£o do perim√©trio",
    "B) Crescimento desordenado do endom√©trio",
    "C) Contra√ß√£o intensa do miom√©trio que comprime vasos, gerando isquemia",
    "D) Excesso de progesterona no √∫tero"
  ],
  correctAnswer: "C) Contra√ß√£o intensa do miom√©trio que comprime vasos, gerando isquemia",
  comment: "Durante a menstrua√ß√£o, h√° uma contra√ß√£o intensa do miom√©trio que comprime os vasos sangu√≠neos, gerando isquemia tempor√°ria e dor.",
  topic: "Fisiologia e Patologia do Miom√©trio"
},
{
  question: "Medicamentos antiespasm√≥dicos atuam para aliviar a c√≥lica menstrual de que forma?",
  options: [
    "A) Aumentando a vasculariza√ß√£o do miom√©trio",
    "B) Reduzindo a produ√ß√£o de estrog√™nio",
    "C) Relaxando a musculatura lisa do miom√©trio via sistema nervoso parassimp√°tico",
    "D) Promovendo a descama√ß√£o acelerada do endom√©trio"
  ],
  correctAnswer: "C) Relaxando a musculatura lisa do miom√©trio via sistema nervoso parassimp√°tico",
  comment: "Antiespasm√≥dicos atuam relaxando a musculatura lisa do miom√©trio via sistema nervoso parassimp√°tico, aliviando a dor da c√≥lica.",
  topic: "Farmacologia da Dismenorreia"
},
{
  question: "Qual a diferen√ßa principal entre Perim√©trio (Serosa) e Advent√≠cia na camada externa do √∫tero?",
  options: [
    "A) A serosa √© interna e a advent√≠cia √© externa.",
    "B) A serosa √© recoberta por perit√¥nio, enquanto a advent√≠cia n√£o.",
    "C) A advent√≠cia √© muscular e a serosa √© conjuntiva.",
    "D) A serosa est√° na face anterior e a advent√≠cia na posterior."
  ],
  correctAnswer: "B) A serosa √© recoberta por perit√¥nio, enquanto a advent√≠cia n√£o.",
  comment: "A serosa (perim√©trio) est√° nas regi√µes recobertas pelo perit√¥nio (mesot√©lio + tecido conjuntivo), enquanto a advent√≠cia est√° onde o √∫tero se conecta a outras estruturas e n√£o h√° perit√¥nio (apenas tecido conjuntivo).",
  topic: "Perim√©trio e Advent√≠cia"
},
{
  question: "Uma caracter√≠stica histol√≥gica marcante da mucosa da tuba uterina que a diferencia do √∫tero √©:",
  options: [
    "A) A presen√ßa de gl√¢ndulas tubulares simples",
    "B) Um epit√©lio pavimentoso estratificado",
    "C) Ser altamente pregueada ou com dobras",
    "D) A aus√™ncia de vasos sangu√≠neos"
  ],
  correctAnswer: "C) Ser altamente pregueada ou com dobras",
  comment: "A mucosa da tuba uterina √© altamente pregueada, o que √© uma caracter√≠stica marcante para diferenci√°-la do √∫tero.",
  topic: "Histologia da Tuba Uterina"
},
{
  question: "O epit√©lio da tuba uterina √© simples cil√≠ndrico e composto por dois tipos principais de c√©lulas. Quais s√£o eles?",
  options: [
    "A) C√©lulas basais e c√©lulas caliciformes",
    "B) C√©lulas ciliadas e c√©lulas secretoras",
    "C) C√©lulas absortivas e c√©lulas de Paneth",
    "D) C√©lulas neuroend√≥crinas e enter√≥citos"
  ],
  correctAnswer: "B) C√©lulas ciliadas e c√©lulas secretoras",
  comment: "O epit√©lio da tuba uterina √© composto por c√©lulas ciliadas, que transportam o ov√≥cito, e c√©lulas secretoras (ou intercalares), que produzem fluido nutritivo.",
  topic: "Epit√©lio da Tuba Uterina"
},
{
  question: "Qual a fun√ß√£o das c√©lulas ciliadas presentes no epit√©lio da tuba uterina?",
  options: [
    "A) Produzir horm√¥nios sexuais",
    "B) Ajudar no transporte do ov√≥cito e do zigoto em dire√ß√£o ao √∫tero",
    "C) Proteger a tuba contra infec√ß√µes",
    "D) Secre√ß√£o de muco para lubrifica√ß√£o"
  ],
  correctAnswer: "B) Ajudar no transporte do ov√≥cito e do zigoto em dire√ß√£o ao √∫tero",
  comment: "As c√©lulas ciliadas possuem c√≠lios apicais que batem em dire√ß√£o ao √∫tero, auxiliando no transporte do ov√≥cito e do zigoto.",
  topic: "C√©lulas Ciliadas da Tuba Uterina"
},
{
  question: "As c√©lulas secretoras (ou intercalares) da tuba uterina desempenham qual fun√ß√£o?",
  options: [
    "A) Regular o peristaltismo da tuba",
    "B) Produzir um fluido nutritivo para gametas e embri√£o",
    "C) Realizar a contra√ß√£o muscular da parede",
    "D) Revestir externamente o √≥rg√£o"
  ],
  correctAnswer: "B) Produzir um fluido nutritivo para gametas e embri√£o",
  comment: "As c√©lulas secretoras n√£o possuem c√≠lios e produzem um fluido nutritivo que protege e nutre os gametas (espermatozoides e ov√≥cito) e o embri√£o em desenvolvimento.",
  topic: "C√©lulas Secretoras da Tuba Uterina"
},
{
  question: "A endometriose √© uma condi√ß√£o onde tecido endometrial cresce fora do √∫tero. Como isso pode causar infertilidade na tuba uterina?",
  options: [
    "A) Aumentando a produ√ß√£o de estrog√™nio, inviabilizando o ov√≥cito.",
    "B) Gerando ader√™ncias que distorcem a anatomia da tuba ou paralisam seu peristaltismo.",
    "C) Causando a degenera√ß√£o precoce do corpo l√∫teo.",
    "D) Impedindo a forma√ß√£o da zona pel√∫cida."
  ],
  correctAnswer: "B) Gerando ader√™ncias que distorcem a anatomia da tuba ou paralisam seu peristaltismo.",
  comment: "O processo inflamat√≥rio c√≠clico da endometriose pode gerar ader√™ncias (cicatrizes fibrosas) que distorcem a anatomia da tuba ou paralisam seu peristaltismo, impedindo o encontro do espermatozoide com o ov√≥cito e causando infertilidade.",
  topic: "Correla√ß√£o Cl√≠nica - Endometriose"
},
{
  question: "Qual o tipo de epit√©lio que reveste a superf√≠cie externa do ov√°rio (epit√©lio germinativo)?",
  options: [
    "A) Epit√©lio pavimentoso simples",
    "B) Epit√©lio c√∫bico simples",
    "C) Epit√©lio cil√≠ndrico pseudoestratificado",
    "D) Epit√©lio estratificado pavimentoso"
  ],
  correctAnswer: "B) Epit√©lio c√∫bico simples",
  comment: "O epit√©lio germinativo, camada mais externa que reveste o ov√°rio, √© um epit√©lio simples c√∫bico.",
  topic: "Estrutura Geral do Ov√°rio"
},
{
  question: "Abaixo do epit√©lio germinativo do ov√°rio, encontra-se uma camada de tecido conjuntivo denso n√£o modelado. Qual o seu nome e fun√ß√£o?",
  options: [
    "A) C√≥rtex ovariano, produ√ß√£o hormonal",
    "B) Medular ovariana, vasculariza√ß√£o",
    "C) T√∫nica albug√≠nea, prote√ß√£o e cor esbranqui√ßada",
    "D) Estrato granuloso, sustenta√ß√£o folicular"
  ],
  correctAnswer: "C) T√∫nica albug√≠nea, prote√ß√£o e cor esbranqui√ßada",
  comment: "A t√∫nica albug√≠nea √© uma camada de tecido conjuntivo denso n√£o modelado que confere prote√ß√£o e a cor esbranqui√ßada ao √≥rg√£o.",
  topic: "Estrutura Geral do Ov√°rio"
},
{
  question: "Onde est√£o localizados os fol√≠culos ovarianos em diversos est√°gios de desenvolvimento no ov√°rio?",
  options: [
    "A) Na regi√£o medular",
    "B) Na t√∫nica albug√≠nea",
    "C) No epit√©lio germinativo",
    "D) Na regi√£o cortical (c√≥rtex)"
  ],
  correctAnswer: "D) Na regi√£o cortical (c√≥rtex)",
  comment: "A regi√£o cortical (c√≥rtex) √© a regi√£o perif√©rica do ov√°rio onde est√£o localizados os fol√≠culos ovarianos em diversos est√°gios de desenvolvimento.",
  topic: "Estrutura Geral do Ov√°rio"
},
{
  question: "Qual a principal caracter√≠stica histol√≥gica da regi√£o medular do ov√°rio?",
  options: [
    "A) Presen√ßa de fol√≠culos em diferentes est√°gios de desenvolvimento.",
    "B) Revestimento por epit√©lio c√∫bico simples.",
    "C) Composta por tecido conjuntivo frouxo, extremamente vascularizada e inervada.",
    "D) Presen√ßa da t√∫nica albug√≠nea."
  ],
  correctAnswer: "C) Composta por tecido conjuntivo frouxo, extremamente vascularizada e inervada.",
  comment: "A regi√£o medular √© a regi√£o central composta por tecido conjuntivo frouxo, sendo extremamente vascularizada e inervada.",
  topic: "Estrutura Geral do Ov√°rio"
},
{
  question: "Os fol√≠culos ovarianos mais abundantes, localizados logo abaixo da t√∫nica albug√≠nea, s√£o:",
  options: [
    "A) Fol√≠culos antrais",
    "B) Fol√≠culos primordiais",
    "C) Fol√≠culos de Graaf",
    "D) Fol√≠culos prim√°rios multilaminares"
  ],
  correctAnswer: "B) Fol√≠culos primordiais",
  comment: "Os fol√≠culos primordiais s√£o os mais abundantes e ficam logo abaixo da t√∫nica albug√≠nea, constituindo a reserva ovariana.",
  topic: "Foliculog√™nese Inicial"
},
{
  question: "A dosagem cl√≠nica de qual horm√¥nio estima a reserva ovariana?",
  options: [
    "A) Estradiol",
    "B) Horm√¥nio Luteinizante (LH)",
    "C) Horm√¥nio Antim√ºlleriano (AMH)",
    "D) Progesterona"
  ],
  correctAnswer: "C) Horm√¥nio Antim√ºlleriano (AMH)",
  comment: "A dosagem cl√≠nica do Horm√¥nio Antim√ºlleriano (AMH) √© utilizada para estimar a reserva ovariana, ou seja, a quantidade de fol√≠culos primordiais.",
  topic: "Foliculog√™nese e Correla√ß√£o Cl√≠nica"
},
{
  question: "Qual √© a principal transforma√ß√£o que ocorre no fol√≠culo primordial para se tornar um fol√≠culo prim√°rio unilaminar?",
  options: [
    "A) Forma√ß√£o do antro",
    "B) As c√©lulas foliculares pavimentosas tornam-se c√∫bicas e formam uma √∫nica camada",
    "C) Prolifera√ß√£o das c√©lulas da granulosa em m√∫ltiplas camadas",
    "D) Diferencia√ß√£o das tecas foliculares"
  ],
  correctAnswer: "B) As c√©lulas foliculares pavimentosas tornam-se c√∫bicas e formam uma √∫nica camada",
  comment: "Sob est√≠mulo hormonal (FSH), o ov√≥cito cresce e as c√©lulas foliculares pavimentosas tornam-se c√∫bicas, formando uma √∫nica camada ao redor do ov√≥cito.",
  topic: "Foliculog√™nese Inicial"
},
{
  question: "No est√°gio de fol√≠culo prim√°rio multilaminar, as c√©lulas foliculares proliferam e s√£o chamadas de:",
  options: [
    "A) C√©lulas da teca",
    "B) C√©lulas intersticiais",
    "C) C√©lulas da granulosa",
    "D) C√©lulas germinativas"
  ],
  correctAnswer: "C) C√©lulas da granulosa",
  comment: "Quando as c√©lulas foliculares proliferam por mitose, formando v√°rias camadas (estratificado), elas passam a ser chamadas de c√©lulas da granulosa.",
  topic: "Foliculog√™nese Inicial"
},
{
  question: "A Zona Pel√∫cida √© uma camada de glicoprote√≠nas eosinof√≠lica. Qual sua fun√ß√£o crucial?",
  options: [
    "A) Nutrir as c√©lulas da granulosa",
    "B) Produzir estrog√™nios",
    "C) Reconhecimento esp√©cie-espec√≠fico do espermatozoide",
    "D) Sustentar o epit√©lio germinativo"
  ],
  correctAnswer: "C) Reconhecimento esp√©cie-espec√≠fico do espermatozoide",
  comment: "A zona pel√∫cida √© fundamental para o reconhecimento esp√©cie-espec√≠fico do espermatozoide, garantindo a fertiliza√ß√£o correta.",
  topic: "Foliculog√™nese - Zona Pel√∫cida"
},
{
  question: "A partir de qual est√°gio folicular o tecido conjuntivo ao redor do fol√≠culo come√ßa a se organizar em camadas conc√™ntricas, formando a teca?",
  options: [
    "A) Primordial",
    "B) Prim√°rio (inicialmente indiferenciada)",
    "C) Antral (secund√°rio)",
    "D) Maduro (de Graaf)"
  ],
  correctAnswer: "B) Prim√°rio (inicialmente indiferenciada)",
  comment: "O tecido conjuntivo ao redor do fol√≠culo come√ßa a se organizar em camadas conc√™ntricas, formando a teca, a partir do est√°gio prim√°rio (inicialmente indiferenciada).",
  topic: "Foliculog√™nese - Teca Folicular"
},
{
  question: "Qual caracter√≠stica distintiva marca a transi√ß√£o de um fol√≠culo prim√°rio multilaminar para um fol√≠culo secund√°rio (antral)?",
  options: [
    "A) O ov√≥cito atinge a met√°fase II",
    "B) A forma√ß√£o de uma cavidade √∫nica e grande chamada Antro",
    "C) A degenera√ß√£o das c√©lulas da granulosa",
    "D) A completa indiferencia√ß√£o da teca folicular"
  ],
  correctAnswer: "B) A forma√ß√£o de uma cavidade √∫nica e grande chamada Antro",
  comment: "O fol√≠culo secund√°rio ou antral √© caracterizado pela acumula√ß√£o do l√≠quido folicular em pequenos espa√ßos que coalescem para formar uma cavidade √∫nica e grande, o Antro.",
  topic: "Foliculog√™nese - Fol√≠culo Antral"
},
{
  question: "Quais s√£o as duas camadas da teca folicular no fol√≠culo secund√°rio (antral) e suas principais caracter√≠sticas?",
  options: [
    "A) Teca interna (fibrosa) e Teca externa (celular)",
    "B) Teca cortical (vascularizada) e Teca medular (nervosa)",
    "C) Teca interna (celular, vascularizada, produtora de andr√≥genos/estr√≥genos) e Teca externa (fibrosa e contr√°til)",
    "D) Teca primitiva (secretora) e Teca madura (regenerativa)"
  ],
  correctAnswer: "C) Teca interna (celular, vascularizada, produtora de andr√≥genos/estr√≥genos) e Teca externa (fibrosa e contr√°til)",
  comment: "Neste est√°gio, as tecas j√° est√£o diferenciadas em Teca Interna (celular, vascularizada e produtora de andr√≥genos/estr√≥genos) e Teca Externa (fibrosa e contr√°til).",
  topic: "Foliculog√™nese - Teca Folicular"
},
{
  question: "No fol√≠culo maduro (de Graaf), qual estrutura √© respons√°vel por prender o ov√≥cito √† parede de c√©lulas da granulosa?",
  options: [
    "A) Zona Pel√∫cida",
    "B) Corona Radiata",
    "C) Cumulus Oophorus",
    "D) Antro Folicular"
  ],
  correctAnswer: "C) Cumulus Oophorus",
  comment: "No fol√≠culo maduro, o ov√≥cito n√£o fica solto, mas sim preso a uma parede de c√©lulas da granulosa chamada Cumulus Oophorus.",
  topic: "Foliculog√™nese - Fol√≠culo Maduro"
},
{
  question: "Qual a camada de c√©lulas da granulosa que fica imediatamente aderida √† zona pel√∫cida do ov√≥cito e √© ovulada junto com ele?",
  options: [
    "A) Teca Interna",
    "B) Corona Radiata",
    "C) Estrato Granuloso",
    "D) Fol√≠culo Primordial"
  ],
  correctAnswer: "B) Corona Radiata",
  comment: "A Corona Radiata √© a camada de c√©lulas da granulosa que fica imediatamente aderida √† zona pel√∫cida do ov√≥cito e √© ovulada junto com ele.",
  topic: "Foliculog√™nese - Fol√≠culo Maduro"
},
{
  question: "O processo de degenera√ß√£o por apoptose da maioria dos fol√≠culos que come√ßam a crescer a cada ciclo √© chamado de:",
  options: [
    "A) Ovula√ß√£o",
    "B) Lute√≥lise",
    "C) Atresia folicular",
    "D) Foliculog√™nese"
  ],
  correctAnswer: "C) Atresia folicular",
  comment: "A atresia folicular √© o processo de apoptose e degenera√ß√£o que ocorre com a maioria dos fol√≠culos, exceto o dominante.",
  topic: "Atresia Folicular"
},
{
  question: "Qual dos seguintes achados histol√≥gicos N√ÉO √© um indicador de fol√≠culo atr√©sico?",
  options: [
    "A) Desorganiza√ß√£o das c√©lulas da granulosa",
    "B) Ov√≥cito flutuando solto no l√≠quido folicular",
    "C) Zona pel√∫cida enrugada, formando uma 'membrana v√≠trea'",
    "D) Antro folicular em crescimento e bem definido"
  ],
  correctAnswer: "D) Antro folicular em crescimento e bem definido",
  comment: "Um antro folicular em crescimento e bem definido √© caracter√≠stico de um fol√≠culo em desenvolvimento, n√£o de atresia. As outras op√ß√µes s√£o indicadores de fol√≠culos atr√©sicos.",
  topic: "Atresia Folicular - Identifica√ß√£o Histol√≥gica"
},
{
  question: "Durante a ovula√ß√£o, o que √© expulso do ov√°rio em dire√ß√£o √† tuba uterina?",
  options: [
    "A) Um ov√≥cito prim√°rio, sem zona pel√∫cida",
    "B) Um fol√≠culo maduro completo",
    "C) O ov√≥cito secund√°rio (parado na met√°fase II), envolto pela zona pel√∫cida e pela corona radiata",
    "D) Um zigoto rec√©m-formado"
  ],
  correctAnswer: "C) O ov√≥cito secund√°rio (parado na met√°fase II), envolto pela zona pel√∫cida e pela corona radiata",
  comment: "A ovula√ß√£o √© a ruptura da parede do fol√≠culo e do epit√©lio germinativo, expulsando o ov√≥cito secund√°rio (parado na met√°fase II), envolto pela zona pel√∫cida e pela corona radiata.",
  topic: "Ovula√ß√£o"
},
{
  question: "Ap√≥s a ovula√ß√£o, as c√©lulas da granulosa e da teca interna do fol√≠culo colapsado sofrem uma modifica√ß√£o chamada luteiniza√ß√£o. Qual estrutura elas formam?",
  options: [
    "A) Corpo Albicans",
    "B) Fol√≠culo Primordial",
    "C) Corpo L√∫teo",
    "D) Teca Externa"
  ],
  correctAnswer: "C) Corpo L√∫teo",
  comment: "Ap√≥s a ovula√ß√£o, as c√©lulas da granulosa e da teca interna sofrem luteiniza√ß√£o, formando o Corpo L√∫teo.",
  topic: "Corpo L√∫teo"
},
{
  question: "Qual a principal fun√ß√£o end√≥crina do Corpo L√∫teo?",
  options: [
    "A) Produ√ß√£o de LH e FSH",
    "B) Produ√ß√£o de Progesterona e estr√≥genos para manter o endom√©trio secretor e permitir nida√ß√£o",
    "C) Produ√ß√£o de AMH para inibir o recrutamento folicular",
    "D) Secre√ß√£o de andr√≥genos para o desenvolvimento muscular"
  ],
  correctAnswer: "B) Produ√ß√£o de Progesterona e estr√≥genos para manter o endom√©trio secretor e permitir nida√ß√£o",
  comment: "O Corpo L√∫teo √© respons√°vel pela produ√ß√£o de Progesterona (e estr√≥genos), horm√¥nios vitais para manter o endom√©trio secretor e permitir a implanta√ß√£o do embri√£o.",
  topic: "Corpo L√∫teo - Fun√ß√£o"
},
{
  question: "Qual das seguintes caracter√≠sticas histol√≥gicas √© T√çPICA do Corpo L√∫teo?",
  options: [
    "A) Massa fibrosa e acelular",
    "B) Estrutura pequena com ov√≥cito primordial",
    "C) Estrutura grande, com aspecto 'dobrado' ou glandular, rica em c√©lulas claras e muito vascularizada",
    "D) Antro folicular preenchido por l√≠quido transparente"
  ],
  correctAnswer: "C) Estrutura grande, com aspecto 'dobrado' ou glandular, rica em c√©lulas claras e muito vascularizada",
  comment: "O Corpo L√∫teo √© uma estrutura grande, com aspecto 'dobrado' ou glandular, rica em c√©lulas claras (que acumulam lip√≠dios para s√≠ntese de esteroides) e muito vascularizada.",
  topic: "Corpo L√∫teo - Histologia"
},
{
  question: "Se n√£o houver fertiliza√ß√£o/gravidez, o corpo l√∫teo degenera. Qual estrutura fibrosa e acelular se forma no ov√°rio como resultado dessa degenera√ß√£o?",
  options: [
    "A) Fol√≠culo Primordial",
    "B) Corpo Albicans",
    "C) Fol√≠culo de Graaf",
    "D) Teca Externa Fibrosa"
  ],
  correctAnswer: "B) Corpo Albicans",
  comment: "Se n√£o houver fertiliza√ß√£o, o corpo l√∫teo degenera (lute√≥lise) e as c√©lulas produtoras de horm√¥nios s√£o substitu√≠das por tecido conjuntivo denso (col√°geno), formando o Corpo Albicans.",
  topic: "Corpo Albicans"
},
{
  question: "Qual a apar√™ncia histol√≥gica caracter√≠stica do Corpo Albicans?",
  options: [
    "A) Estrutura glandular massiva e vascularizada",
    "B) Fol√≠culos com ov√≥cito e antro bem definidos",
    "C) Cicatriz fibrosa e acelular, com aspecto de 'nuvem' ou material amorfo eosinof√≠lico",
    "D) Aglomerados de c√©lulas pavimentosas na periferia ovariana"
  ],
  correctAnswer: "C) Cicatriz fibrosa e acelular, com aspecto de 'nuvem' ou material amorfo eosinof√≠lico",
  comment: "O Corpo Albicans aparece como uma cicatriz fibrosa e acelular (ou paucicelular) no ov√°rio, com aspecto de 'nuvem' ou material amorfo, eosinof√≠lico, sem a organiza√ß√£o celular do corpo l√∫teo.",
  topic: "Corpo Albicans - Histologia"
},
{
  question: "Qual camada uterina √© respons√°vel por sofrer modifica√ß√µes c√≠clicas e descamar durante a menstrua√ß√£o?",
  options: [
    "A) Camada Basal do Endom√©trio",
    "B) Miom√©trio",
    "C) Camada Funcional do Endom√©trio",
    "D) Perim√©trio"
  ],
  correctAnswer: "C) Camada Funcional do Endom√©trio",
  comment: "A camada funcional √© a por√ß√£o superficial do endom√©trio que sofre as modifica√ß√µes c√≠clicas e descama durante a menstrua√ß√£o.",
  topic: "Divis√£o Funcional do Endom√©trio"
},
{
  question: "Em que parte da tuba uterina ocorre o movimento perist√°ltico que auxilia no transporte do ov√≥cito e do zigoto?",
  options: [
    "A) Mucosa",
    "B) L√¢mina pr√≥pria",
    "C) Camada Muscular",
    "D) Serosa"
  ],
  correctAnswer: "C) Camada Muscular",
  comment: "A camada muscular da tuba uterina √© respons√°vel pelos movimentos perist√°lticos que tamb√©m auxiliam no transporte do ov√≥cito e do zigoto.",
  topic: "Tuba Uterina - Camadas"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
</body>
</html>
