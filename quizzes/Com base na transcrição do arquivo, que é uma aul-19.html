
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Com base na transcri√ß√£o do arquivo, que √© uma aul-19</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>Com base na transcri√ß√£o do arquivo, que √© uma aul-19</h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual estrutura externa envolve o test√≠culo, conferindo-lhe prote√ß√£o e sendo descrita como uma c√°psula de tecido conjuntivo denso fibroso?",
  options: [
    "A) Epit√©lio germinativo",
    "B) Tecido intersticial",
    "C) T√∫nica albug√≠nea",
    "D) L√¢mina basal"
  ],
  correctAnswer: "C) T√∫nica albug√≠nea",
  comment: "A t√∫nica albug√≠nea √© a c√°psula de tecido conjuntivo denso fibroso que envolve externamente o test√≠culo, oferecendo prote√ß√£o.",
  topic: "Test√≠culo e T√∫nica Albug√≠nea"
},
{
  question: "Dentro do par√™nquima testicular, quais s√£o as unidades funcionais onde ocorre a produ√ß√£o dos espermatozoides?",
  options: [
    "A) C√©lulas de Leydig",
    "B) T√∫bulos semin√≠feros",
    "C) Tecido intersticial",
    "D) C√©lulas de Sertoli"
  ],
  correctAnswer: "B) T√∫bulos semin√≠feros",
  comment: "Os t√∫bulos semin√≠feros s√£o as unidades funcionais do test√≠culo respons√°veis pela espermatog√™nese, a produ√ß√£o de espermatozoides.",
  topic: "T√∫bulos Semin√≠feros"
},
{
  question: "Qual √© a sequ√™ncia correta de matura√ß√£o das c√©lulas germinativas dentro do epit√©lio semin√≠fero, da periferia para o l√∫men?",
  options: [
    "A) Espermatozoides, Esperm√°tides, Espermat√≥citos, Espermatog√¥nias",
    "B) Espermatog√¥nias, Espermat√≥citos, Esperm√°tides, Espermatozoides",
    "C) Esperm√°tides, Espermatog√¥nias, Espermat√≥citos, Espermatozoides",
    "D) Espermat√≥citos, Espermatozoides, Espermatog√¥nias, Esperm√°tides"
  ],
  correctAnswer: "B) Espermatog√¥nias, Espermat√≥citos, Esperm√°tides, Espermatozoides",
  comment: "A sequ√™ncia de matura√ß√£o celular no epit√©lio germinativo √©: Espermatog√¥nias (na base), Espermat√≥citos (prim√°rios e secund√°rios), Esperm√°tides e, finalmente, Espermatozoides (no l√∫men).",
  topic: "Matura√ß√£o Celular (Espermatog√™nese)"
},
{
  question: "Qual tipo de c√©lula germinativa inicia a meiose e √© descrita como sendo dif√≠cil de diferenciar visualmente entre prim√°ria e secund√°ria na microscopia de luz comum?",
  options: [
    "A) Espermatog√¥nias",
    "B) Espermatozoides",
    "C) Esperm√°tides",
    "D) Espermat√≥citos"
  ],
  correctAnswer: "D) Espermat√≥citos",
  comment: "Os espermat√≥citos (prim√°rios e secund√°rios) s√£o as c√©lulas que iniciam a meiose, e sua diferencia√ß√£o visual √© dif√≠cil na microscopia de luz comum.",
  topic: "Espermat√≥citos"
},
{
  question: "O processo de diferencia√ß√£o morfol√≥gica que as esperm√°tides sofrem para se tornarem espermatozoides, envolvendo perda de citoplasma, forma√ß√£o do flagelo e acrossomo, √© denominado:",
  options: [
    "A) Espermatog√™nese",
    "B) Meiose",
    "C) Espermiog√™nese",
    "D) Mitose"
  ],
  correctAnswer: "C) Espermiog√™nese",
  comment: "Espermiog√™nese √© o processo de diferencia√ß√£o morfol√≥gica das esperm√°tides em espermatozoides, com mudan√ßas na forma, perda de citoplasma e forma√ß√£o de estruturas como o flagelo e o acrossomo.",
  topic: "Espermiog√™nese"
},
{
  question: "As C√©lulas de Leydig, encontradas no tecido intersticial entre os t√∫bulos semin√≠feros, s√£o respons√°veis pela produ√ß√£o de qual horm√¥nio?",
  options: [
    "A) Estr√≥geno",
    "B) Progesterona",
    "C) Testosterona",
    "D) Horm√¥nio Luteinizante (LH)"
  ],
  correctAnswer: "C) Testosterona",
  comment: "As C√©lulas de Leydig produzem horm√¥nios esteroides, sendo a testosterona o principal exemplo, utilizando lip√≠dios (colesterol) como mat√©ria-prima.",
  topic: "C√©lulas de Leydig e Horm√¥nios"
},
{
  question: "Qual caracter√≠stica histol√≥gica das C√©lulas de Leydig √© mencionada como resultado da presen√ßa de lip√≠dios em seu citoplasma, que s√£o removidos durante a prepara√ß√£o?",
  options: [
    "A) N√∫cleo piramidal",
    "B) Citoplasma denso e escuro",
    "C) Citoplasma mais claro ou com aspecto de 'gotas brancas'",
    "D) Presen√ßa de corpos residuais"
  ],
  correctAnswer: "C) Citoplasma mais claro ou com aspecto de 'gotas brancas'",
  comment: "As C√©lulas de Leydig podem aparecer com citoplasma mais claro ou com aspecto de 'gotas brancas' devido √† presen√ßa de lip√≠dios, que s√£o removidos durante o processamento histol√≥gico.",
  topic: "C√©lulas de Leydig"
},
{
  question: "Qual c√©lula, localizada dentro do t√∫bulo semin√≠fero, possui citoplasma extenso e n√∫cleo claro e piramidal, sendo respons√°vel por fun√ß√µes como suporte mec√¢nico e nutri√ß√£o das c√©lulas germinativas?",
  options: [
    "A) Espermatog√¥nia",
    "B) Espermat√≥cito",
    "C) C√©lula de Leydig",
    "D) C√©lula de Sertoli"
  ],
  correctAnswer: "D) C√©lula de Sertoli",
  comment: "As C√©lulas de Sertoli est√£o dentro do t√∫bulo semin√≠fero, possuem um citoplasma extenso e n√∫cleo claro e piramidal, desempenhando fun√ß√µes de suporte e nutri√ß√£o para as c√©lulas germinativas.",
  topic: "C√©lulas de Sertoli"
},
{
  question: "Al√©m de suporte e nutri√ß√£o, qual outra fun√ß√£o importante das C√©lulas de Sertoli √© mencionada em rela√ß√£o √† espermiog√™nese?",
  options: [
    "A) Produ√ß√£o de testosterona",
    "B) Fagocitar restos citoplasm√°ticos (corpos residuais)",
    "C) Iniciar a meiose",
    "D) Formar o flagelo dos espermatozoides"
  ],
  correctAnswer: "B) Fagocitar restos citoplasm√°ticos (corpos residuais)",
  comment: "As C√©lulas de Sertoli s√£o respons√°veis por fagocitar os corpos residuais, que s√£o restos citoplasm√°ticos dispensados pelas esperm√°tides durante a espermiog√™nese.",
  topic: "C√©lulas de Sertoli e Espermiog√™nese"
},
{
  question: "Qual estrutura √© formada pelas C√©lulas de Sertoli e tem como fun√ß√£o proteger as c√©lulas germinativas do sistema imune?",
  options: [
    "A) T√∫bulo semin√≠fero",
    "B) Barreira hematotesticular",
    "C) T√∫nica albug√≠nea",
    "D) L√¢mina basal"
  ],
  correctAnswer: "B) Barreira hematotesticular",
  comment: "As C√©lulas de Sertoli formam a barreira hematotesticular, essencial para proteger as c√©lulas germinativas de subst√¢ncias nocivas e do ataque do sistema imune.",
  topic: "C√©lulas de Sertoli e Barreira Hematotesticular"
},
{
  question: "Qual √© o epit√©lio caracter√≠stico do epid√≠dimo, que possui microvilosidades longas e im√≥veis?",
  options: [
    "A) Epit√©lio pavimentoso simples",
    "B) Epit√©lio c√∫bico simples",
    "C) Epit√©lio pseudoestratificado colunar com estereoc√≠lios",
    "D) Epit√©lio estratificado escamoso"
  ],
  correctAnswer: "C) Epit√©lio pseudoestratificado colunar com estereoc√≠lios",
  comment: "O epid√≠dimo √© revestido por epit√©lio pseudoestratificado colunar com estereoc√≠lios, que s√£o microvilosidades longas e im√≥veis.",
  topic: "Epid√≠dimo e Epit√©lio"
},
{
  question: "Qual a principal diferen√ßa funcional entre c√≠lios verdadeiros e estereoc√≠lios, segundo o professor?",
  options: [
    "A) C√≠lios s√£o im√≥veis, estereoc√≠lios t√™m movimento ativo.",
    "B) C√≠lios aumentam a √°rea de superf√≠cie, estereoc√≠lios s√£o apenas para prote√ß√£o.",
    "C) C√≠lios possuem movimento ativo, estereoc√≠lios s√£o microvilosidades longas e im√≥veis.",
    "D) C√≠lios est√£o presentes no epid√≠dimo, estereoc√≠lios apenas no test√≠culo."
  ],
  correctAnswer: "C) C√≠lios possuem movimento ativo, estereoc√≠lios s√£o microvilosidades longas e im√≥veis.",
  comment: "C√≠lios verdadeiros possuem movimento ativo, enquanto estereoc√≠lios s√£o microvilosidades longas e im√≥veis, com fun√ß√£o de absor√ß√£o.",
  topic: "C√≠lios vs Estereoc√≠lios"
},
{
  question: "Qual √© a fun√ß√£o principal dos estereoc√≠lios presentes no epit√©lio do epid√≠dimo?",
  options: [
    "A) Propuls√£o dos espermatozoides",
    "B) Produ√ß√£o de horm√¥nios",
    "C) Aumentar a √°rea de superf√≠cie para absor√ß√£o",
    "D) Suporte mec√¢nico √†s c√©lulas germinativas"
  ],
  correctAnswer: "C) Aumentar a √°rea de superf√≠cie para absor√ß√£o",
  comment: "A fun√ß√£o principal dos estereoc√≠lios √© aumentar a √°rea de superf√≠cie do epit√©lio para a absor√ß√£o de fluidos e restos citoplasm√°ticos.",
  topic: "Estereoc√≠lios e Fun√ß√£o"
},
{
  question: "No epid√≠dimo, os espermatozoides adquirem qual caracter√≠stica essencial, embora a capacita√ß√£o final ocorra em outro local?",
  options: [
    "A) Capacidade de fertilizar o √≥vulo",
    "B) Produ√ß√£o de acrossomo",
    "C) Motilidade",
    "D) Forma√ß√£o do flagelo"
  ],
  correctAnswer: "C) Motilidade",
  comment: "Os espermatozoides adquirem motilidade no epid√≠dimo, mas a capacita√ß√£o final (capacidade de fertilizar) ocorre apenas no trato reprodutor feminino.",
  topic: "Epid√≠dimo e Espermatozoides"
},
{
  question: "Que tipo de tecido muscular √© observado ao redor dos t√∫bulos do epid√≠dimo, auxiliando no movimento dos espermatozoides?",
  options: [
    "A) M√∫sculo esquel√©tico",
    "B) M√∫sculo card√≠aco",
    "C) M√∫sculo liso",
    "D) M√∫sculo estriado"
  ],
  correctAnswer: "C) M√∫sculo liso",
  comment: "Ao redor dos t√∫bulos do epid√≠dimo, h√° tecido muscular liso, respons√°vel por contra√ß√µes perist√°lticas que ajudam a mover os espermatozoides.",
  topic: "Epid√≠dimo e Musculatura"
},
{
  question: "Qual gl√¢ndula anexa possui uma mucosa bastante pregueada e √© respons√°vel pela produ√ß√£o da maior parte do volume do l√≠quido seminal, rico em frutose?",
  options: [
    "A) Pr√≥stata",
    "B) Gl√¢ndulas de Littr√©",
    "C) Ves√≠cula Seminal",
    "D) Gl√¢ndulas bulbouretrais"
  ],
  correctAnswer: "C) Ves√≠cula Seminal",
  comment: "A Ves√≠cula Seminal tem uma mucosa pregueada e produz a maior parte do volume do l√≠quido seminal, rico em frutose e outros nutrientes.",
  topic: "Ves√≠cula Seminal"
},
{
  question: "Qual √© a principal fun√ß√£o da frutose no l√≠quido seminal, produzida pela ves√≠cula seminal?",
  options: [
    "A) Coagula√ß√£o do s√™men",
    "B) Prote√ß√£o contra infec√ß√µes",
    "C) Nutriente essencial para a sobreviv√™ncia e motilidade dos espermatozoides",
    "D) Aumentar o pH do l√≠quido vaginal"
  ],
  correctAnswer: "C) Nutriente essencial para a sobreviv√™ncia e motilidade dos espermatozoides",
  comment: "A frutose presente no l√≠quido seminal √© um nutriente essencial que fornece energia para a sobreviv√™ncia e motilidade dos espermatozoides.",
  topic: "L√≠quido Seminal e Frutose"
},
{
  question: "A pr√≥stata √© descrita como um conjunto de gl√¢ndulas de que tipo?",
  options: [
    "A) End√≥crinas",
    "B) Tubulares simples",
    "C) Tubuloalveolares",
    "D) Alveolares simples"
  ],
  correctAnswer: "C) Tubuloalveolares",
  comment: "A pr√≥stata √© um conjunto de gl√¢ndulas tubuloalveolares, que secretam parte do l√≠quido seminal.",
  topic: "Pr√≥stata e Tipo de Gl√¢ndula"
},
{
  question: "Qual √© a caracter√≠stica do estroma da pr√≥stata, que cont√©m tecido conjuntivo denso e fibras musculares lisas?",
  options: [
    "A) Denso e el√°stico",
    "B) Fibroel√°stico",
    "C) Fibromuscular",
    "D) Adiposo"
  ],
  correctAnswer: "C) Fibromuscular",
  comment: "O estroma da pr√≥stata √© caracter√≠stico por ser fibromuscular, ou seja, cont√©m tanto tecido conjuntivo denso quanto fibras musculares lisas.",
  topic: "Pr√≥stata e Estroma"
},
{
  question: "Qual estrutura diagn√≥stica importante da pr√≥stata s√£o concre√ß√µes calcificadas de glicoprote√≠nas que aumentam com a idade?",
  options: [
    "A) Gl√¢ndulas de Littr√©",
    "B) Corpos amil√°ceos",
    "C) T√∫bulos semin√≠feros",
    "D) C√©lulas de Leydig"
  ],
  correctAnswer: "B) Corpos amil√°ceos",
  comment: "Os corpos amil√°ceos (ou corpora amylacea) s√£o concre√ß√µes calcificadas de glicoprote√≠nas encontradas no l√∫men das gl√¢ndulas prost√°ticas, que aumentam com a idade e s√£o importantes marcadores diagn√≥sticos.",
  topic: "Pr√≥stata e Corpos Amil√°ceos"
},
{
  question: "Quantos cilindros de tecido er√©til s√£o observados em um corte histol√≥gico do p√™nis e quais s√£o eles?",
  options: [
    "A) Dois: um corpo cavernoso e um corpo esponjoso.",
    "B) Tr√™s: dois corpos cavernosos e um corpo esponjoso.",
    "C) Quatro: dois corpos cavernosos e dois corpos esponjosos.",
    "D) Um: o corpo esponjoso, que envolve a uretra."
  ],
  correctAnswer: "B) Tr√™s: dois corpos cavernosos e um corpo esponjoso.",
  comment: "O corte histol√≥gico do p√™nis revela tr√™s cilindros de tecido er√©til: dois Corpos Cavernosos (dorsais) e um Corpo Esponjoso (ventral).",
  topic: "Anatomia Histol√≥gica do P√™nis"
},
{
  question: "Os Corpos Cavernosos s√£o localizados dorsalmente e s√£o formados por que tipo de estrutura vascular?",
  options: [
    "A) Capilares cont√≠nuos",
    "B) Arter√≠olas musculares",
    "C) Sinusoides (espa√ßos vasculares irregulares)",
    "D) V√™nulas p√≥s-capilares"
  ],
  correctAnswer: "C) Sinusoides (espa√ßos vasculares irregulares)",
  comment: "Os Corpos Cavernosos s√£o formados por espa√ßos vasculares irregulares denominados sinusoides, que se enchem de sangue durante a ere√ß√£o.",
  topic: "Corpos Cavernosos"
},
{
  question: "Qual corpo er√©til do p√™nis est√° localizado ventralmente e envolve a uretra peniana?",
  options: [
    "A) Corpo cavernoso",
    "B) Corpo albug√≠neo",
    "C) Corpo esponjoso",
    "D) Corpo da glande"
  ],
  correctAnswer: "C) Corpo esponjoso",
  comment: "O Corpo Esponjoso √© o cilindro de tecido er√©til localizado ventralmente e que envolve a uretra peniana.",
  topic: "Corpo Esponjoso"
},
{
  question: "Qual √© a fun√ß√£o cr√≠tica do corpo esponjoso durante a ere√ß√£o, diferente dos corpos cavernosos?",
  options: [
    "A) Atingir a rigidez m√°xima para a penetra√ß√£o.",
    "B) Produzir l√≠quido seminal para lubrifica√ß√£o.",
    "C) Manter a uretra aberta, impedindo a compress√£o e a interrup√ß√£o da ejacula√ß√£o.",
    "D) Fornecer inerva√ß√£o sensitiva ao p√™nis."
  ],
  correctAnswer: "C) Manter a uretra aberta, impedindo a compress√£o e a interrup√ß√£o da ejacula√ß√£o.",
  comment: "A fun√ß√£o cr√≠tica do corpo esponjoso √© manter a uretra aberta durante a ere√ß√£o, mesmo quando preenchido de sangue, mas com menor press√£o, para permitir a passagem do esperma.",
  topic: "Fun√ß√£o do Corpo Esponjoso"
},
{
  question: "Qual estrutura do p√™nis, similar √† do test√≠culo, √© descrita como um tecido conjuntivo denso forte que envolve os corpos cavernosos e ajuda a manter a rigidez durante a ere√ß√£o?",
  options: [
    "A) Uretra peniana",
    "B) Gl√¢ndulas de Littr√©",
    "C) Corpo esponjoso",
    "D) T√∫nica albug√≠nea do p√™nis"
  ],
  correctAnswer: "D) T√∫nica albug√≠nea do p√™nis",
  comment: "Assim como no test√≠culo, o p√™nis possui uma t√∫nica albug√≠nea de tecido conjuntivo denso que envolve os corpos cavernosos, contribuindo para a manuten√ß√£o da rigidez er√©til.",
  topic: "T√∫nica Albug√≠nea do P√™nis"
},
{
  question: "Na uretra peniana, qual tipo de gl√¢ndulas podem ser observadas associadas ao epit√©lio?",
  options: [
    "A) Gl√¢ndulas seb√°ceas",
    "B) Gl√¢ndulas de Littr√©",
    "C) Gl√¢ndulas sudor√≠paras",
    "D) Gl√¢ndulas de Cowper"
  ],
  correctAnswer: "B) Gl√¢ndulas de Littr√©",
  comment: "As gl√¢ndulas uretrais, conhecidas como Gl√¢ndulas de Littr√©, podem ser observadas associadas √† uretra peniana.",
  topic: "Uretra e Gl√¢ndulas de Littr√©"
},
{
  question: "O epit√©lio de revestimento da uretra varia ao longo de sua extens√£o. Qual epit√©lio √© geralmente encontrado na parte prost√°tica da uretra?",
  options: [
    "A) Epit√©lio estratificado pavimentoso",
    "B) Epit√©lio c√∫bico simples",
    "C) Urot√©lio (epit√©lio de transi√ß√£o)",
    "D) Epit√©lio pseudoestratificado colunar"
  ],
  correctAnswer: "C) Urot√©lio (epit√©lio de transi√ß√£o)",
  comment: "O epit√©lio da uretra varia, sendo geralmente urot√©lio na parte prost√°tica e estratificado ou pseudoestratificado na peniana.",
  topic: "Epit√©lio da Uretra"
},
{
  question: "Qual √© a principal diferen√ßa observada entre l√¢minas histol√≥gicas de √≥rg√£os reprodutores masculinos de humanos e animais pequenos (como ratos)?",
  options: [
    "A) L√¢minas de animais n√£o mostram espermatozoides.",
    "B) L√¢minas humanas sempre mostram √≥rg√£os inteiros, enquanto as de animais mostram apenas fragmentos.",
    "C) L√¢minas de animais pequenos podem mostrar cortes inteiros do √≥rg√£o, enquanto as humanas mostram apenas fragmentos.",
    "D) L√¢minas de animais n√£o possuem t√∫nica albug√≠nea."
  ],
  correctAnswer: "C) L√¢minas de animais pequenos podem mostrar cortes inteiros do √≥rg√£o, enquanto as humanas mostram apenas fragmentos.",
  comment: "Em l√¢minas de animais pequenos, √© poss√≠vel ver cortes transversais do p√™nis inteiro ou test√≠culo inteiro, ao passo que em l√¢minas humanas, devido ao tamanho, observam-se apenas fragmentos.",
  topic: "Compara√ß√£o Histol√≥gica Humano x Animal"
},
{
  question: "Durante a revis√£o, o professor refor√ßa a visualiza√ß√£o dos corpos amil√°ceos na pr√≥stata como um marcador de:",
  options: [
    "A) Idade jovem e sa√∫de prost√°tica.",
    "B) Idade avan√ßada e identifica√ß√£o do √≥rg√£o.",
    "C) Infec√ß√£o bacteriana.",
    "D) C√¢ncer de pr√≥stata em est√°gio inicial."
  ],
  correctAnswer: "B) Idade avan√ßada e identifica√ß√£o do √≥rg√£o.",
  comment: "Os corpos amil√°ceos na pr√≥stata s√£o refor√ßados como um marcador de idade avan√ßada e uma caracter√≠stica importante para a identifica√ß√£o do √≥rg√£o.",
  topic: "Corpos Amil√°ceos e Diagn√≥stico"
},
{
  question: "Qual o valor de refer√™ncia de normalidade cl√≠nica para a contagem m√©dia de espermatozoides mencionada na aula?",
  options: [
    "A) Cerca de 1 milh√£o/mL",
    "B) Cerca de 5 milh√µes/mL",
    "C) Cerca de 15 milh√µes/mL",
    "D) Cerca de 50 milh√µes/mL"
  ],
  correctAnswer: "C) Cerca de 15 milh√µes/mL",
  comment: "O professor menciona cerca de 15 milh√µes/mL como refer√™ncia de normalidade cl√≠nica para a contagem m√©dia de espermatozoides.",
  topic: "Contagem de Espermatozoides"
},
{
  question: "Qual das seguintes c√©lulas √© uma precursora localizada na base do epit√©lio semin√≠fero?",
  options: [
    "A) Esperm√°tides",
    "B) Espermatozoides",
    "C) Espermatog√¥nias",
    "D) C√©lulas de Sertoli"
  ],
  correctAnswer: "C) Espermatog√¥nias",
  comment: "As espermatog√¥nias s√£o as c√©lulas precursoras localizadas na base do epit√©lio germinativo, mais pr√≥ximas √† l√¢mina basal.",
  topic: "Espermatog√¥nias"
},
{
  question: "O tecido intersticial entre os t√∫bulos semin√≠feros √© composto principalmente por qual tipo de tecido?",
  options: [
    "A) Tecido muscular denso",
    "B) Tecido conjuntivo denso fibroso",
    "C) Tecido epitelial estratificado",
    "D) Tecido conjuntivo frouxo muito vascularizado"
  ],
  correctAnswer: "D) Tecido conjuntivo frouxo muito vascularizado",
  comment: "O tecido intersticial (interst√≠cio) √© composto por tecido conjuntivo frouxo muito vascularizado, onde se encontram as C√©lulas de Leydig.",
  topic: "Tecido Intersticial"
},
{
  question: "Qual das seguintes op√ß√µes N√ÉO √© uma fun√ß√£o das C√©lulas de Sertoli?",
  options: [
    "A) Suporte mec√¢nico",
    "B) Nutrir as c√©lulas germinativas",
    "C) Produ√ß√£o de testosterona",
    "D) Formar a barreira hematotesticular"
  ],
  correctAnswer: "C) Produ√ß√£o de testosterona",
  comment: "A produ√ß√£o de testosterona √© fun√ß√£o das C√©lulas de Leydig, n√£o das C√©lulas de Sertoli.",
  topic: "C√©lulas de Sertoli - Fun√ß√µes"
},
{
  question: "Quando os espermatozoides saem do test√≠culo e chegam ao epid√≠dimo, eles ainda est√£o finalizando sua matura√ß√£o e precisam que muito fluido e restos citoplasm√°ticos sejam reabsorvidos. Qual estrutura realiza essa fun√ß√£o de absor√ß√£o?",
  options: [
    "A) C√≠lios verdadeiros",
    "B) Flagelos",
    "C) Estereoc√≠lios",
    "D) Microt√∫bulos"
  ],
  correctAnswer: "C) Estereoc√≠lios",
  comment: "Os estereoc√≠lios, sendo microvilosidades longas e im√≥veis, aumentam a √°rea de superf√≠cie para a absor√ß√£o de fluidos e restos citoplasm√°ticos no epid√≠dimo.",
  topic: "Epid√≠dimo e Absor√ß√£o"
},
{
  question: "Qual √© o conte√∫do principal do l√≠quido seminal que nutre os espermatozoides e √© produzido em grande parte pela ves√≠cula seminal?",
  options: [
    "A) √Åcido c√≠trico",
    "B) Frutose",
    "C) Glucagon",
    "D) Amilase"
  ],
  correctAnswer: "B) Frutose",
  comment: "O l√≠quido seminal produzido pela ves√≠cula seminal √© rico em frutose e outros nutrientes essenciais para a sobreviv√™ncia e motilidade dos espermatozoides.",
  topic: "Ves√≠cula Seminal e L√≠quido Seminal"
},
{
  question: "A contra√ß√£o da musculatura do estroma fibromuscular da pr√≥stata √© essencial para qual processo?",
  options: [
    "A) Ere√ß√£o peniana",
    "B) Produ√ß√£o de espermatozoides",
    "C) Libera√ß√£o da secre√ß√£o prost√°tica na uretra durante a ejacula√ß√£o",
    "D) Manuten√ß√£o da temperatura testicular"
  ],
  correctAnswer: "C) Libera√ß√£o da secre√ß√£o prost√°tica na uretra durante a ejacula√ß√£o",
  comment: "A contra√ß√£o muscular do estroma fibromuscular da pr√≥stata √© essencial para liberar a secre√ß√£o prost√°tica na uretra durante a ejacula√ß√£o.",
  topic: "Pr√≥stata e Ejacula√ß√£o"
},
{
  question: "Durante a ere√ß√£o, qual dos corpos er√©teis se enche com menor press√£o para manter a uretra aberta e permitir a ejacula√ß√£o?",
  options: [
    "A) Corpo cavernoso direito",
    "B) Corpo cavernoso esquerdo",
    "C) Corpo esponjoso",
    "D) T√∫nica albug√≠nea"
  ],
  correctAnswer: "C) Corpo esponjoso",
  comment: "O corpo esponjoso se enche de sangue com menor press√£o do que os corpos cavernosos para evitar a compress√£o da uretra, permitindo a passagem do s√™men.",
  topic: "Corpo Esponjoso e Ere√ß√£o"
},
{
  question: "Em l√¢minas histol√≥gicas humanas, devido ao tamanho dos √≥rg√£os, o que geralmente se observa em contraste com l√¢minas de animais pequenos?",
  options: [
    "A) √ìrg√£os inteiros em um √∫nico campo.",
    "B) Apenas vasos sangu√≠neos e nervos.",
    "C) Fragmentos ou cortes parciais dos √≥rg√£os.",
    "D) Somente tecido conjuntivo denso."
  ],
  correctAnswer: "C) Fragmentos ou cortes parciais dos √≥rg√£os.",
  comment: "Em l√¢minas humanas, devido ao tamanho dos √≥rg√£os, observam-se apenas fragmentos ou cortes parciais, exigindo que o aluno mentalize a estrutura completa.",
  topic: "Revis√£o e Compara√ß√£o de L√¢minas"
},
{
  question: "Qual tipo de epit√©lio √© geralmente encontrado na uretra peniana?",
  options: [
    "A) Urot√©lio",
    "B) Epit√©lio pavimentoso simples",
    "C) Epit√©lio estratificado ou pseudoestratificado",
    "D) Epit√©lio c√∫bico estratificado"
  ],
  correctAnswer: "C) Epit√©lio estratificado ou pseudoestratificado",
  comment: "A uretra √© revestida por epit√©lio que varia, sendo geralmente urot√©lio na parte prost√°tica e estratificado ou pseudoestratificado na peniana.",
  topic: "Uretra e Epit√©lio"
},
{
  question: "O professor menciona a dificuldade de obter cortes histol√≥gicos perfeitos de √≥rg√£os em humanos que s√£o:",
  options: [
    "A) Muito l√≠quidos ou gelatinosos.",
    "B) Muito fibrosos ou duros.",
    "C) Muito pequenos e fr√°geis.",
    "D) Muito vascularizados e macios."
  ],
  correctAnswer: "B) Muito fibrosos ou duros.",
  comment: "O professor menciona a dificuldade de obter cortes histol√≥gicos perfeitos de √≥rg√£os muito fibrosos ou duros em humanos.",
  topic: "Revis√£o e T√©cnicas Histol√≥gicas"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
</body>
</html>
