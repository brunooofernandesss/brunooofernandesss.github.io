
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Com base na transcri√ß√£o do arquivo, que √© uma aul-21</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>Com base na transcri√ß√£o do arquivo, que √© uma aul-21</h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Os anexos embrion√°rios s√£o definidos como √≥rg√£os transit√≥rios fundamentais para o desenvolvimento do embri√£o. Qual o foco principal mencionado em rela√ß√£o a esses anexos?",
  options: [
    "A) Ov√°rio e trompas uterinas",
    "B) C√©rebro e medula espinhal",
    "C) Placenta e cord√£o umbilical",
    "D) F√≠gado e p√¢ncreas"
  ],
  correctAnswer: "C) Placenta e cord√£o umbilical",
  comment: "A aula foca principalmente na placenta e no cord√£o umbilical como os anexos embrion√°rios mais relevantes.",
  topic: "Anexos Embrion√°rios"
},
{
  question: "Em que fase de desenvolvimento o embri√£o chega √† cavidade uterina para o processo de implanta√ß√£o, e por volta de qual dia isso ocorre?",
  options: [
    "A) M√≥rula, terceiro ao quarto dia",
    "B) Zigoto, primeiro ao segundo dia",
    "C) Blastocisto, quinto ao s√©timo dia",
    "D) G√°strula, nono ao d√©cimo dia"
  ],
  correctAnswer: "C) Blastocisto, quinto ao s√©timo dia",
  comment: "O texto indica que por volta do quinto ao s√©timo dia, o embri√£o encontra-se na fase de blastocisto e chega √† cavidade uterina para a implanta√ß√£o.",
  topic: "Implanta√ß√£o Embrion√°ria"
},
{
  question: "O blastocisto possui duas massas celulares distintas. Quais s√£o elas e o que cada uma formar√°?",
  options: [
    "A) Ectoderma e Endoderma, formando a placenta e o embri√£o, respectivamente",
    "B) Embrioblasto e Trofoblasto, formando o embri√£o e a por√ß√£o fetal da placenta, respectivamente",
    "C) Mesoderma e Ectoderma, formando os anexos e o embri√£o, respectivamente",
    "D) Citotrofoblasto e Sinciciotrofoblasto, formando o c√≥rion e o √¢mnio"
  ],
  correctAnswer: "B) Embrioblasto e Trofoblasto, formando o embri√£o e a por√ß√£o fetal da placenta, respectivamente",
  comment: "O embrioblasto √© a massa interna que formar√° o embri√£o, enquanto o trofoblasto √© a camada externa que formar√° os anexos embrion√°rios, especificamente a por√ß√£o fetal da placenta.",
  topic: "Blastocisto"
},
{
  question: "A por√ß√£o materna da placenta √© derivada de qual estrutura e passa por qual transforma√ß√£o?",
  options: [
    "A) Do miom√©trio, que sofre atrofia",
    "B) Do endom√©trio modificado, que sofre rea√ß√£o decidual",
    "C) Do c√≥rion, que se torna vascularizado",
    "D) Do ov√°rio, que secreta progesterona"
  ],
  correctAnswer: "B) Do endom√©trio modificado, que sofre rea√ß√£o decidual",
  comment: "A por√ß√£o materna √© derivada do endom√©trio modificado da m√£e, que sofre uma transforma√ß√£o chamada rea√ß√£o decidual, passando a ser chamada de dec√≠dua basal.",
  topic: "Placenta Materna"
},
{
  question: "Quais s√£o as caracter√≠sticas das c√©lulas deciduais e o que as torna p√°lidas?",
  options: [
    "A) Pequenas, com citoplasma escuro devido ao ac√∫mulo de prote√≠nas",
    "B) Grandes, com citoplasma p√°lido devido ao ac√∫mulo de glicog√™nio e lip√≠dios",
    "C) Alongadas, com citoplasma claro devido √† falta de organelas",
    "D) Estreladas, com citoplasma granular devido a pigmentos"
  ],
  correctAnswer: "B) Grandes, com citoplasma p√°lido devido ao ac√∫mulo de glicog√™nio e lip√≠dios",
  comment: "As c√©lulas deciduais s√£o caracterizadas por serem grandes, com citoplasma p√°lido devido ao ac√∫mulo de glicog√™nio e lip√≠dios, essenciais para a nutri√ß√£o inicial.",
  topic: "Dec√≠dua Basal"
},
{
  question: "De qual estrutura √© derivada a por√ß√£o fetal da placenta e como o trofoblasto se diferencia durante a implanta√ß√£o para form√°-la?",
  options: [
    "A) Do saco vitel√≠nico, diferenciando-se em ectoderma e endoderma",
    "B) Do √¢mnio, diferenciando-se em c√©lulas musculares e nervosas",
    "C) Do c√≥rion (trofoblasto), diferenciando-se em citotrofoblasto e sinciciotrofoblasto",
    "D) Do alantoide, diferenciando-se em vasos sangu√≠neos e epit√©lio"
  ],
  correctAnswer: "C) Do c√≥rion (trofoblasto), diferenciando-se em citotrofoblasto e sinciciotrofoblasto",
  comment: "A por√ß√£o fetal √© derivada do c√≥rion (trofoblasto). Durante a implanta√ß√£o, o trofoblasto se diferencia em citotrofoblasto e sinciciotrofoblasto, que formam as vilosidades cori√¥nicas.",
  topic: "Placenta Fetal"
},
{
  question: "Al√©m de ser um √≥rg√£o de prote√ß√£o e nutri√ß√£o, quais outras fun√ß√µes essenciais a placenta desempenha?",
  options: [
    "A) Produ√ß√£o de enzimas digestivas e regula√ß√£o da temperatura fetal",
    "B) Respira√ß√£o (troca gasosa), excre√ß√£o e fun√ß√£o end√≥crina",
    "C) Armazenamento de vitaminas e controle da press√£o arterial fetal",
    "D) Forma√ß√£o de c√©lulas sangu√≠neas e produ√ß√£o de anticorpos maternos"
  ],
  correctAnswer: "B) Respira√ß√£o (troca gasosa), excre√ß√£o e fun√ß√£o end√≥crina",
  comment: "A placenta atua como √≥rg√£o de prote√ß√£o, nutri√ß√£o, respira√ß√£o (troca gasosa) e excre√ß√£o, al√©m de ser uma gl√¢ndula end√≥crina produtora de horm√¥nios.",
  topic: "Fisiologia Placent√°ria"
},
{
  question: "Quais horm√¥nios s√£o produzidos pela placenta para manter a gesta√ß√£o?",
  options: [
    "A) Insulina, glucagon e cortisol",
    "B) TSH, tiroxina e GH",
    "C) hCG, progesterona e estrog√™nio",
    "D) Adrenalina, noradrenalina e prolactina"
  ],
  correctAnswer: "C) hCG, progesterona e estrog√™nio",
  comment: "A placenta √© uma gl√¢ndula end√≥crina produtora de horm√¥nios como hCG, progesterona e estrog√™nio para manter a gesta√ß√£o.",
  topic: "Horm√¥nios Placent√°rios"
},
{
  question: "Qual √© a principal fun√ß√£o da Barreira Placent√°ria?",
  options: [
    "A) Unir o embri√£o ao √∫tero",
    "B) Separar o sangue materno do sangue fetal",
    "C) Produzir horm√¥nios para o feto",
    "D) Armazenar nutrientes para o desenvolvimento inicial"
  ],
  correctAnswer: "B) Separar o sangue materno do sangue fetal",
  comment: "A Barreira Placent√°ria separa o sangue materno (presente nos espa√ßos intervilosos) do sangue fetal (presente nos capilares dentro das vilosidades).",
  topic: "Barreira Placent√°ria"
},
{
  question: "Quais tipos de mol√©culas atravessam facilmente a Barreira Placent√°ria por difus√£o e qual o risco associado?",
  options: [
    "A) Mol√©culas grandes e hidrossol√∫veis; risco de infec√ß√µes bacterianas",
    "B) Mol√©culas pequenas e lipossol√∫veis; risco teratog√™nico",
    "C) Prote√≠nas e anticorpos; risco de rejei√ß√£o fetal",
    "D) C√©lulas sangu√≠neas e v√≠rus; risco de hemorragia"
  ],
  correctAnswer: "B) Mol√©culas pequenas e lipossol√∫veis; risco teratog√™nico",
  comment: "Mol√©culas pequenas e lipossol√∫veis (ex: gases, √°lcool, alguns f√°rmacos) atravessam facilmente, explicando o risco teratog√™nico de certas subst√¢ncias.",
  topic: "Permeabilidade Placent√°ria"
},
{
  question: "Cite exemplos de subst√¢ncias que, por serem pequenas e lipossol√∫veis, atravessam facilmente a barreira placent√°ria.",
  options: [
    "A) Anticorpos IgG, insulina e heparina",
    "B) Gases, √°lcool e alguns f√°rmacos como ansiol√≠ticos",
    "C) Glucagon, prolactina e albumina",
    "D) Hem√°cias, leuc√≥citos e plaquetas"
  ],
  correctAnswer: "B) Gases, √°lcool e alguns f√°rmacos como ansiol√≠ticos",
  comment: "Gases, √°lcool e alguns f√°rmacos como ansiol√≠ticos e anti-hipertensivos s√£o exemplos de mol√©culas pequenas e lipossol√∫veis que atravessam a barreira facilmente.",
  topic: "Barreira Placent√°ria e F√°rmacos"
},
{
  question: "Como mol√©culas grandes ou polares geralmente atravessam a Barreira Placent√°ria, e quais s√£o os exemplos citados?",
  options: [
    "A) Atravessam livremente por difus√£o simples; exemplo: gases",
    "B) N√£o atravessam de forma alguma; exemplo: nutrientes",
    "C) Podem passar por transporte ativo ou pinocitose; exemplo: anticorpos IgG e v√≠rus",
    "D) S√£o quebradas em mol√©culas menores antes de atravessar; exemplo: prote√≠nas"
  ],
  correctAnswer: "C) Podem passar por transporte ativo ou pinocitose; exemplo: anticorpos IgG e v√≠rus",
  comment: "Mol√©culas grandes ou polares geralmente n√£o atravessam livremente, mas algumas podem passar por transporte ativo ou pinocitose/transcitose, como anticorpos IgG (imunidade passiva) e v√≠rus.",
  topic: "Transporte Placent√°rio"
},
{
  question: "Historicamente, do lado fetal para o materno, quais s√£o os componentes da Barreira Placent√°ria?",
  options: [
    "A) Endot√©lio do capilar fetal, citotrofoblasto, sinciciotrofoblasto",
    "B) Sinciciotrofoblasto, citotrofoblasto, mesoderma extraembrion√°rio, endot√©lio do capilar materno",
    "C) Endot√©lio do capilar fetal, mesoderma extraembrion√°rio, citotrofoblasto, sinciciotrofoblasto",
    "D) Mesoderma extraembrion√°rio, endot√©lio do capilar materno, citotrofoblasto, sinciciotrofoblasto"
  ],
  correctAnswer: "C) Endot√©lio do capilar fetal, mesoderma extraembrion√°rio, citotrofoblasto, sinciciotrofoblasto",
  comment: "Histologicamente, a barreira (do lado fetal para o materno) √© composta por: endot√©lio do capilar fetal, mesoderma extraembrion√°rio (tecido conjuntivo), citotrofoblasto e sinciciotrofoblasto.",
  topic: "Histologia da Placenta"
},
{
  question: "Nas vilosidades cori√¥nicas, como o sinciciotrofoblasto √© identificado histol√≥gicamente e qual sua principal fun√ß√£o?",
  options: [
    "A) C√©lulas c√∫bicas com limites definidos; fun√ß√£o de prolifera√ß√£o",
    "B) Localizado internamente ao citotrofoblasto; fun√ß√£o de sustenta√ß√£o",
    "C) N√∫cleos mais escuros e agregados ('n√≥s sinciciais'); respons√°vel pela produ√ß√£o hormonal",
    "D) Tecido conjuntivo frouxo; fun√ß√£o de transporte de nutrientes"
  ],
  correctAnswer: "C) N√∫cleos mais escuros e agregados ('n√≥s sinciciais'); respons√°vel pela produ√ß√£o hormonal",
  comment: "O sinciciotrofoblasto √© localizado na superf√≠cie externa da vilosidade, identificado por n√∫cleos mais escuros e agregados ('n√≥s sinciciais'), sendo respons√°vel pela produ√ß√£o hormonal.",
  topic: "Sinciciotrofoblasto"
},
{
  question: "Qual a localiza√ß√£o e as caracter√≠sticas histol√≥gicas do citotrofoblasto nas vilosidades cori√¥nicas, e qual sua capacidade?",
  options: [
    "A) Superf√≠cie externa, com massa multinucleada invasiva; capacidade de eros√£o",
    "B) Internamente ao sinc√≠cio, com c√©lulas c√∫bicas e limites definidos; alta capacidade mit√≥tica",
    "C) No n√∫cleo da vilosidade, com fibroblastos; capacidade de produ√ß√£o de col√°geno",
    "D) Nos espa√ßos intervilosos, com hem√°cias; capacidade de troca gasosa"
  ],
  correctAnswer: "B) Internamente ao sinc√≠cio, com c√©lulas c√∫bicas e limites definidos; alta capacidade mit√≥tica",
  comment: "O citotrofoblasto est√° localizado internamente ao sinc√≠cio, apresenta c√©lulas c√∫bicas com limites celulares definidos e n√∫cleos √∫nicos e grandes, sendo c√©lulas com alta capacidade mit√≥tica (c√©lulas-tronco da placenta).",
  topic: "Citotrofoblasto"
},
{
  question: "O n√∫cleo da vilosidade cori√¥nica √© composto por qual tipo de tecido e o que ele cont√©m?",
  options: [
    "A) Epit√©lio amni√≥tico, contendo queratina",
    "B) Tecido muscular liso, contendo actina e miosina",
    "C) Mesoderma extraembrion√°rio (tecido conjuntivo frouxo/embrion√°rio), contendo fibroblastos, fibras col√°genas e vasos sangu√≠neos fetais",
    "D) Tecido nervoso, contendo neur√¥nios e glia"
  ],
  correctAnswer: "C) Mesoderma extraembrion√°rio (tecido conjuntivo frouxo/embrion√°rio), contendo fibroblastos, fibras col√°genas e vasos sangu√≠neos fetais",
  comment: "O n√∫cleo da vilosidade √© composto por mesoderma extraembrion√°rio (tecido conjuntivo frouxo/embrion√°rio), contendo fibroblastos, fibras col√°genas e os vasos sangu√≠neos fetais.",
  topic: "Estrutura da Vilosidade"
},
{
  question: "Como os espa√ßos intervilosos aparecem em l√¢minas histol√≥gicas e o que os preenche in vivo, qual sua fun√ß√£o?",
  options: [
    "A) Como "n√≥s sinciciais" preenchidos por vasos fetais; fun√ß√£o hormonal",
    "B) Como "buracos" ou espa√ßos brancos preenchidos por sangue materno; permitindo trocas metab√≥licas",
    "C) Como aglomerados de c√©lulas deciduais preenchidos por glicog√™nio; fun√ß√£o nutritiva inicial",
    "D) Como camadas de citotrofoblasto preenchidas por l√≠quido amni√≥tico; fun√ß√£o protetora"
  ],
  correctAnswer: "B) Como "buracos" ou espa√ßos brancos preenchidos por sangue materno; permitindo trocas metab√≥licas",
  comment: "Os espa√ßos intervilosos aparecem como "buracos" ou espa√ßos brancos entre as vilosidades na l√¢mina. In vivo, s√£o preenchidos por sangue materno, permitindo as trocas metab√≥licas com o sangue fetal.",
  topic: "Espa√ßos Intervilosos"
},
{
  question: "As c√©lulas deciduais s√£o modifica√ß√µes de qual tipo celular do estroma endometrial?",
  options: [
    "A) C√©lulas epiteliais glandulares",
    "B) Fibroblastos",
    "C) C√©lulas musculares lisas",
    "D) C√©lulas endoteliais"
  ],
  correctAnswer: "B) Fibroblastos",
  comment: "As c√©lulas deciduais s√£o modifica√ß√µes dos fibroblastos do estroma endometrial.",
  topic: "Dec√≠dua Basal"
},
{
  question: "Qual animal √© mencionado por ter uma placenta histologicamente muito semelhante √† humana, justificando seu uso em pesquisas de toxicidade e teratogenicidade de f√°rmacos?",
  options: [
    "A) Zebrafish",
    "B) Macacos",
    "C) Roedores",
    "D) Aves"
  ],
  correctAnswer: "C) Roedores",
  comment: "A placenta de roedores √© histologicamente muito semelhante √† humana, justificando seu uso em pesquisas de toxicidade e teratogenicidade de f√°rmacos.",
  topic: "Modelos Animais em Pesquisa"
},
{
  question: "Qual √© o epit√©lio que reveste o cord√£o umbilical e qual tecido conjuntivo mucoso especializado o preenche, e qual a fun√ß√£o deste tecido?",
  options: [
    "A) Epit√©lio escamoso estratificado; preenchido por tecido adiposo para isolamento",
    "B) Epit√©lio amni√≥tico; preenchido por Gel√©ia de Wharton para proteger os vasos",
    "C) Epit√©lio c√∫bico simples; preenchido por cartilagem hialina para sustenta√ß√£o",
    "D) Epit√©lio colunar simples; preenchido por tecido √≥sseo para rigidez"
  ],
  correctAnswer: "B) Epit√©lio amni√≥tico; preenchido por Gel√©ia de Wharton para proteger os vasos",
  comment: "O cord√£o √© revestido por epit√©lio amni√≥tico e preenchido por um tecido conjuntivo mucoso especializado chamado Gel√©ia de Wharton, rico em √°cido hialur√¥nico, que protege os vasos contra compress√£o.",
  topic: "Cord√£o Umbilical"
},
{
  question: "Qual a composi√ß√£o vascular do cord√£o umbilical em termos de art√©rias e veias?",
  options: [
    "A) Uma art√©ria e duas veias",
    "B) Duas art√©rias e uma veia",
    "C) Uma art√©ria e uma veia",
    "D) Duas art√©rias e duas veias"
  ],
  correctAnswer: "B) Duas art√©rias e uma veia",
  comment: "O cord√£o umbilical possui duas art√©rias e uma veia.",
  topic: "Vasculariza√ß√£o Umbilical"
},
{
  question: "As art√©rias umbilicais carregam que tipo de sangue, em qual dire√ß√£o, e quais s√£o suas caracter√≠sticas histol√≥gicas de parede e l√∫men?",
  options: [
    "A) Sangue arterial (oxigenado) para a placenta; parede delgada, l√∫men amplo",
    "B) Sangue venoso (desoxigenado) do feto para a placenta; parede muscular espessa, l√∫men menor",
    "C) Sangue arterial (oxigenado) do feto para o cora√ß√£o; parede fina, l√∫men vari√°vel",
    "D) Sangue venoso (desoxigenado) da placenta para o feto; parede espessa, l√∫men grande"
  ],
  correctAnswer: "B) Sangue venoso (desoxigenado) do feto para a placenta; parede muscular espessa, l√∫men menor",
  comment: "As duas art√©rias umbilicais carregam sangue venoso (pobre em oxig√™nio e rico em CO2/metab√≥litos) do feto para a placenta. Possuem parede muscular espessa e l√∫men menor.",
  topic: "Art√©rias Umbilicais"
},
{
  question: "A veia umbilical carrega que tipo de sangue, em qual dire√ß√£o, e quais s√£o suas caracter√≠sticas histol√≥gicas de parede e l√∫men?",
  options: [
    "A) Sangue venoso (desoxigenado) do feto para a placenta; parede muscular espessa, l√∫men menor",
    "B) Sangue arterial (oxigenado) da placenta para o feto; parede muscular mais delgada, l√∫men amplo",
    "C) Sangue misto (arterial e venoso) do feto para a m√£e; parede fina, l√∫men pequeno",
    "D) Sangue venoso (desoxigenado) da placenta para o feto; parede delgada, l√∫men estreito"
  ],
  correctAnswer: "B) Sangue arterial (oxigenado) da placenta para o feto; parede muscular mais delgada, l√∫men amplo",
  comment: "A veia umbilical (uma) carrega sangue arterial (rico em oxig√™nio e nutrientes) da placenta para o feto. Possui parede muscular mais delgada e l√∫men amplo.",
  topic: "Veia Umbilical"
},
{
  question: "Como a l√≥gica da circula√ß√£o do cord√£o umbilical (tipo de sangue em veia e art√©ria) se compara √† circula√ß√£o sist√™mica adulta?",
  options: [
    "A) √â id√™ntica, com veias transportando sangue oxigenado e art√©rias sangue desoxigenado",
    "B) √â o inverso, com a veia transportando sangue oxigenado e as art√©rias sangue desoxigenado",
    "C) √â completamente diferente, pois n√£o h√° trocas gasosas no feto",
    "D) √â uma circula√ß√£o fechada, sem rela√ß√£o com a sist√™mica adulta"
  ],
  correctAnswer: "B) √â o inverso, com a veia transportando sangue oxigenado e as art√©rias sangue desoxigenado",
  comment: "A professora enfatiza que essa l√≥gica de circula√ß√£o (veia com sangue oxigenado e art√©ria com sangue desoxigenado) √© o inverso da circula√ß√£o sist√™mica adulta.",
  topic: "Circula√ß√£o Fetal"
},
{
  question: "A circula√ß√£o umbilical √© comparada a qual parte da circula√ß√£o adulta e por qu√™?",
  options: [
    "A) Circula√ß√£o cerebral, devido √† alta demanda metab√≥lica",
    "B) Circula√ß√£o renal, devido √† fun√ß√£o de excre√ß√£o",
    "C) Pequena circula√ß√£o (pulmonar), pois a placenta atua como o 'pulm√£o' do feto",
    "D) Circula√ß√£o coronariana, devido √† sua import√¢ncia vital"
  ],
  correctAnswer: "C) Pequena circula√ß√£o (pulmonar), pois a placenta atua como o 'pulm√£o' do feto",
  comment: "A l√≥gica da circula√ß√£o umbilical assemelha-se √† pequena circula√ß√£o (pulmonar), pois a placenta atua como o 'pulm√£o' do feto.",
  topic: "Fun√ß√£o Placent√°ria"
},
{
  question: "Em que local do sistema reprodutor feminino ocorre a fecunda√ß√£o, geralmente?",
  options: [
    "A) No ov√°rio",
    "B) Na cavidade uterina",
    "C) Na ampola da tuba uterina",
    "D) No colo do √∫tero"
  ],
  correctAnswer: "C) Na ampola da tuba uterina",
  comment: "Ap√≥s a fecunda√ß√£o (geralmente na ampola da tuba uterina), o zigoto sofre clivagens.",
  topic: "Fecunda√ß√£o"
},
{
  question: "Ap√≥s a fecunda√ß√£o, o zigoto sofre clivagens. Qual √© a principal consequ√™ncia imediata dessas clivagens?",
  options: [
    "A) Diminui√ß√£o da massa celular",
    "B) Aumento da massa celular",
    "C) Diferencia√ß√£o em tecidos adultos",
    "D) Forma√ß√£o de gametas"
  ],
  correctAnswer: "B) Aumento da massa celular",
  comment: "Ap√≥s a fecunda√ß√£o (geralmente na ampola da tuba uterina), o zigoto sofre clivagens e aumenta sua massa celular.",
  topic: "Clivagem"
},
{
  question: "Qual outro termo √© utilizado para o processo de implanta√ß√£o do embri√£o na cavidade uterina?",
  options: [
    "A) Gastrula√ß√£o",
    "B) Neurula√ß√£o",
    "C) Nida√ß√£o",
    "D) Organog√™nese"
  ],
  correctAnswer: "C) Nida√ß√£o",
  comment: "O processo de implanta√ß√£o tamb√©m √© conhecido como nida√ß√£o.",
  topic: "Implanta√ß√£o Embrion√°ria"
},
{
  question: "Qual massa celular do blastocisto √© respons√°vel por formar o embri√£o propriamente dito?",
  options: [
    "A) Trofoblasto",
    "B) Citotrofoblasto",
    "C) Sinciciotrofoblasto",
    "D) Embrioblasto"
  ],
  correctAnswer: "D) Embrioblasto",
  comment: "O embrioblasto √© a massa interna que formar√° o embri√£o propriamente dito.",
  topic: "Blastocisto"
},
{
  question: "As c√©lulas do trofoblasto, a camada externa do blastocisto, n√£o formam o embri√£o. O que elas formam?",
  options: [
    "A) A musculatura do √∫tero",
    "B) A por√ß√£o fetal da placenta e outros anexos embrion√°rios",
    "C) Os √≥rg√£os internos do embri√£o",
    "D) As g√¥nadas fetais"
  ],
  correctAnswer: "B) A por√ß√£o fetal da placenta e outros anexos embrion√°rios",
  comment: "As c√©lulas do trofoblasto n√£o formam o embri√£o, mas sim os anexos embrion√°rios, especificamente a por√ß√£o fetal da placenta.",
  topic: "Trofoblasto"
},
{
  question: "Qual horm√¥nio √© respons√°vel por manter o endom√©trio espesso e vascularizado antes da implanta√ß√£o?",
  options: [
    "A) Estrog√™nio",
    "B) Testosterona",
    "C) Progesterona",
    "D) Ocitocina"
  ],
  correctAnswer: "C) Progesterona",
  comment: "O endom√©trio, que estava espesso e vascularizado sob a influ√™ncia da progesterona (secretada pelo corpo l√∫teo), sofre uma transforma√ß√£o chamada rea√ß√£o decidual.",
  topic: "Horm√¥nios na Implanta√ß√£o"
},
{
  question: "Qual estrutura secreta progesterona para manter o endom√©trio espesso e vascularizado antes da implanta√ß√£o?",
  options: [
    "A) O ov√°rio",
    "B) A hip√≥fise",
    "C) O corpo l√∫teo",
    "D) A tireoide"
  ],
  correctAnswer: "C) O corpo l√∫teo",
  comment: "O endom√©trio estava espesso e vascularizado sob a influ√™ncia da progesterona, secretada pelo corpo l√∫teo.",
  topic: "Ciclo Menstrual e Gesta√ß√£o"
},
{
  question: "Durante a implanta√ß√£o, em quais duas camadas o trofoblasto se diferencia inicialmente?",
  options: [
    "A) Mesoderma e Ectoderma",
    "B) Endoderma e Mesoderma",
    "C) Citotrofoblasto e Sinciciotrofoblasto",
    "D) Amnion e C√≥rio"
  ],
  correctAnswer: "C) Citotrofoblasto e Sinciciotrofoblasto",
  comment: "Durante a implanta√ß√£o, o trofoblasto se diferencia em duas camadas: o citotrofoblasto (camada interna) e o sinciciotrofoblasto (camada externa).",
  topic: "Diferencia√ß√£o do Trofoblasto"
},
{
  question: "Qual camada do trofoblasto √© descrita como uma massa multinucleada invasiva que erode o endom√©trio?",
  options: [
    "A) Citotrofoblasto",
    "B) Embrioblasto",
    "C) Sinciciotrofoblasto",
    "D) Mesoderma extraembrion√°rio"
  ],
  correctAnswer: "C) Sinciciotrofoblasto",
  comment: "O sinciciotrofoblasto √© a camada externa, uma massa multinucleada invasiva que erode o endom√©trio.",
  topic: "Sinciciotrofoblasto"
},
{
  question: "Qual √© a import√¢ncia do ac√∫mulo de glicog√™nio e lip√≠dios nas c√©lulas deciduais?",
  options: [
    "A) Conferir rigidez √† estrutura da dec√≠dua",
    "B) Serem essenciais para a nutri√ß√£o inicial do embri√£o",
    "C) Facilitar a troca gasosa entre a m√£e e o feto",
    "D) Ajudar na defesa imunol√≥gica contra pat√≥genos"
  ],
  correctAnswer: "B) Serem essenciais para a nutri√ß√£o inicial do embri√£o",
  comment: "As c√©lulas deciduais s√£o grandes, com citoplasma p√°lido devido ao ac√∫mulo de glicog√™nio e lip√≠dios, essenciais para a nutri√ß√£o inicial.",
  topic: "Dec√≠dua Basal"
},
{
  question: "Em que fase de desenvolvimento fetal as hem√°cias nucleadas s√£o t√≠picas?",
  options: [
    "A) Desenvolvimento avan√ßado, pr√≥ximo ao termo",
    "B) Desenvolvimento inicial",
    "C) Ap√≥s o nascimento",
    "D) Somente em casos de anomalias"
  ],
  correctAnswer: "B) Desenvolvimento inicial",
  comment: "Os capilares fetais cont√™m hem√°cias nucleadas, t√≠picas de fetos em desenvolvimento inicial, ou anucleadas em fases posteriores.",
  topic: "Hematopoiese Fetal"
},
{
  question: "O que a Gel√©ia de Wharton, presente no cord√£o umbilical, protege os vasos contra?",
  options: [
    "A) Infec√ß√µes bacterianas",
    "B) Varia√ß√µes de temperatura",
    "C) Compress√£o",
    "D) Defici√™ncias nutricionais"
  ],
  correctAnswer: "C) Compress√£o",
  comment: "A Gel√©ia de Wharton, rica em √°cido hialur√¥nico, protege os vasos contra compress√£o.",
  topic: "Cord√£o Umbilical"
},
{
  question: "Al√©m de anticorpos IgG, quais outros agentes podem atravessar a barreira placent√°ria, representando riscos de infec√ß√µes verticais?",
  options: [
    "A) Bact√©rias grandes",
    "B) Parasitas intestinais",
    "C) Fungos",
    "D) V√≠rus"
  ],
  correctAnswer: "D) V√≠rus",
  comment: "V√≠rus tamb√©m podem atravessar essa barreira, representando riscos de infec√ß√µes verticais (ex: rub√©ola, hepatite).",
  topic: "Infec√ß√µes Cong√™nitas"
},
{
  question: "Qual camada celular das vilosidades √© diretamente respons√°vel pela produ√ß√£o hormonal e est√° em contato direto com o sangue materno?",
  options: [
    "A) Citotrofoblasto",
    "B) Mesoderma extraembrion√°rio",
    "C) Sinciciotrofoblasto",
    "D) Endot√©lio do capilar fetal"
  ],
  correctAnswer: "C) Sinciciotrofoblasto",
  comment: "O sinciciotrofoblasto √© respons√°vel pela produ√ß√£o hormonal e est√° em contato direto com o sangue materno nos espa√ßos intervilosos.",
  topic: "Sinciciotrofoblasto"
},
{
  question: "Qual tipo de c√©lula na placenta √© referido como "c√©lulas-tronco da placenta" devido √† sua alta capacidade mit√≥tica?",
  options: [
    "A) C√©lulas deciduais",
    "B) Fibroblastos do n√∫cleo da vilosidade",
    "C) Sinciciotrofoblasto",
    "D) Citotrofoblasto"
  ],
  correctAnswer: "D) Citotrofoblasto",
  comment: "O citotrofoblasto, com sua alta capacidade mit√≥tica, √© considerado as c√©lulas-tronco da placenta.",
  topic: "Citotrofoblasto"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
</body>
</html>
