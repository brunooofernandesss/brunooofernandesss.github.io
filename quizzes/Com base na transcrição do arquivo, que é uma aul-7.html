
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Com base na transcri√ß√£o do arquivo, que √© uma aul-7</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>Com base na transcri√ß√£o do arquivo, que √© uma aul-7</h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual √© a caracter√≠stica distintiva do sistema genital feminino em compara√ß√£o com outros sistemas do corpo, mencionada na introdu√ß√£o da aula?",
  options: [
    "A) Funciona continuamente desde o nascimento.",
    "B) Permanece 'adormecido' at√© a puberdade.",
    "C) √â o √∫nico sistema com fun√ß√£o reprodutiva.",
    "D) N√£o possui √≥rg√£os externos."
  ],
  correctAnswer: "B) Permanece 'adormecido' at√© a puberdade.",
  comment: "O sistema genital, ao contr√°rio de outros sistemas que funcionam continuamente, permanece 'adormecido' at√© a puberdade.",
  topic: "Introdu√ß√£o ao Sistema Genital Feminino"
},
{
  question: "Qual √© a fun√ß√£o primordial do sistema genital feminino, compartilhada com o sistema masculino?",
  options: [
    "A) Produ√ß√£o de horm√¥nios exclusivamente.",
    "B) Regula√ß√£o da temperatura corporal.",
    "C) Reprodu√ß√£o.",
    "D) Filtragem de res√≠duos metab√≥licos."
  ],
  correctAnswer: "C) Reprodu√ß√£o.",
  comment: "A fun√ß√£o primordial compartilhada com o sistema masculino √© a reprodu√ß√£o.",
  topic: "Fun√ß√£o do Sistema Genital Feminino"
},
{
  question: "Anatomicamente, como o sistema genital feminino √© dividido?",
  options: [
    "A) Apenas em √≥rg√£os internos.",
    "B) Em √≥rg√£os superiores e inferiores.",
    "C) Em √≥rg√£os externos (per√≠neo) e internos (cavidade p√©lvica).",
    "D) Em √≥rg√£os end√≥crinos e ex√≥crinos."
  ],
  correctAnswer: "C) Em √≥rg√£os externos (per√≠neo) e internos (cavidade p√©lvica).",
  comment: "Anatomicamente, o sistema √© dividido em √≥rg√£os externos (localizados no per√≠neo, externos √† pelve) e √≥rg√£os internos (situados no interior da cavidade p√©lvica).",
  topic: "Divis√£o Anat√¥mica do Sistema Genital Feminino"
},
{
  question: "Quais s√£o os √≥rg√£os internos do sistema genital feminino, de acordo com o texto?",
  options: [
    "A) Monte do p√∫bis, l√°bios maiores e menores.",
    "B) Ov√°rios, tubas uterinas, √∫tero e vagina.",
    "C) Clit√≥ris, vest√≠bulo e gl√¢ndulas vestibulares.",
    "D) Uretra, bexiga e reto."
  ],
  correctAnswer: "B) Ov√°rios, tubas uterinas, √∫tero e vagina.",
  comment: "Os √≥rg√£os internos incluem os ov√°rios (g√¥nadas), as tubas uterinas, o √∫tero e a vagina, que funcionam como ductos acess√≥rios.",
  topic: "√ìrg√£os Internos do Sistema Genital Feminino"
},
{
  question: "Qual √© a dupla fun√ß√£o dos ov√°rios, conforme descrito no texto?",
  options: [
    "A) Produ√ß√£o de urina e de o√≥citos.",
    "B) Desenvolvimento de o√≥citos e produ√ß√£o de horm√¥nios sexuais.",
    "C) Condu√ß√£o de o√≥citos e filtra√ß√£o sangu√≠nea.",
    "D) Armazenamento de s√™men e produ√ß√£o de muco."
  ],
  correctAnswer: "B) Desenvolvimento de o√≥citos e produ√ß√£o de horm√¥nios sexuais.",
  comment: "Eles t√™m dupla fun√ß√£o: o desenvolvimento dos o√≥citos (gametas) e a fun√ß√£o de gl√¢ndula end√≥crina, produzindo horm√¥nios sexuais.",
  topic: "Fun√ß√£o dos Ov√°rios"
},
{
  question: "Qual √© o peso e a medida aproximada dos ov√°rios?",
  options: [
    "A) Pesam entre 2 a 4g e medem de 7 a 14 cm.",
    "B) Pesam entre 7 a 14g e medem de 2 a 4 cm.",
    "C) Pesam entre 14 a 28g e medem de 4 a 8 cm.",
    "D) Pesam menos de 1g e medem cerca de 1 cm."
  ],
  correctAnswer: "B) Pesam entre 7 a 14g e medem de 2 a 4 cm.",
  comment: "Os ov√°rios... pesando entre 7 a 14g e medindo de 2 a 4 cm.",
  topic: "Caracter√≠sticas dos Ov√°rios"
},
{
  question: "Posteriormente, com quais estruturas os ov√°rios se relacionam, em termos de sintopia?",
  options: [
    "A) Com a bexiga e o √∫tero.",
    "B) Com o ureter e o nervo obturat√≥rio.",
    "C) Com o reto e o canal anal.",
    "D) Com o ligamento largo e o mesov√°rio."
  ],
  correctAnswer: "B) Com o ureter e o nervo obturat√≥rio.",
  comment: "Em termos de sintopia (rela√ß√µes anat√¥micas), os ov√°rios relacionam-se posteriormente com o ureter e o nervo obturat√≥rio.",
  topic: "Sintopia dos Ov√°rios"
},
{
  question: "Com quais estruturas o ov√°rio direito e o ov√°rio esquerdo se relacionam, respectivamente, de acordo com o texto?",
  options: [
    "A) Direito com colo sigmoide; Esquerdo com √°pice do ap√™ndice vermiforme.",
    "B) Direito com bexiga; Esquerdo com reto.",
    "C) Direito com √°pice do ap√™ndice vermiforme; Esquerdo com colo sigmoide.",
    "D) Direito com ureter; Esquerdo com nervo obturat√≥rio."
  ],
  correctAnswer: "C) Direito com √°pice do ap√™ndice vermiforme; Esquerdo com colo sigmoide.",
  comment: "Do lado direito, relacionam-se com o √°pice do ap√™ndice vermiforme; do lado esquerdo, com o colo sigmoide.",
  topic: "Sintopia dos Ov√°rios"
},
{
  question: "Qual estrutura peritoneal √© uma dupla camada horizontal e posterior que sustenta o ov√°rio?",
  options: [
    "A) Mesom√©trio.",
    "B) Ligamento Suspensor do Ov√°rio.",
    "C) Mesov√°rio.",
    "D) Ligamento √ötero-ov√°rico."
  ],
  correctAnswer: "C) Mesov√°rio.",
  comment: "√â fundamental compreender as rela√ß√µes peritoneais, especificamente o Mesov√°rio, que √© uma dupla camada peritoneal horizontal e posterior.",
  topic: "Sustenta√ß√£o Ovariana"
},
{
  question: "Qual ligamento ovariano √© uma prega peritoneal por onde passam vasos sangu√≠neos (art√©ria e veia ov√°ricas), linf√°ticos e nervos?",
  options: [
    "A) Ligamento √ötero-ov√°rico.",
    "B) Ligamento Largo do √ötero.",
    "C) Mesov√°rio.",
    "D) Ligamento Suspensor do Ov√°rio."
  ],
  correctAnswer: "D) Ligamento Suspensor do Ov√°rio.",
  comment: "Ligamento Suspensor do Ov√°rio: Uma prega peritoneal por onde passam os vasos sangu√≠neos (art√©ria e veia ov√°ricas), linf√°ticos e nervos.",
  topic: "Ligamentos do Ov√°rio"
},
{
  question: "Qual ligamento curto fixa o ov√°rio √† parede lateral do √∫tero, posicionado medialmente no mesov√°rio?",
  options: [
    "A) Ligamento Suspensor do Ov√°rio.",
    "B) Ligamento √ötero-ov√°rico (ou pr√≥prio do ov√°rio).",
    "C) Ligamento Largo do √ötero.",
    "D) Ligamento Redondo do √ötero."
  ],
  correctAnswer: "B) Ligamento √ötero-ov√°rico (ou pr√≥prio do ov√°rio).",
  comment: "Ligamento √ötero-ov√°rico (ou pr√≥prio do ov√°rio): Um ligamento curto que fixa o ov√°rio √† parede lateral do √∫tero, posicionado medialmente no mesov√°rio.",
  topic: "Ligamentos do Ov√°rio"
},
{
  question: "Qual √© a medida aproximada das tubas uterinas e de onde elas se estendem?",
  options: [
    "A) Medem cerca de 5 cm e se estendem dos ov√°rios.",
    "B) Medem cerca de 10 cm e se estendem lateralmente a partir dos cornos uterinos.",
    "C) Medem cerca de 15 cm e se estendem da vagina.",
    "D) Medem cerca de 20 cm e se estendem da bexiga."
  ],
  correctAnswer: "B) Medem cerca de 10 cm e se estendem lateralmente a partir dos cornos uterinos.",
  comment: "As tubas uterinas (antigas trompas de Fal√≥pio) medem cerca de 10 cm e estendem-se lateralmente a partir dos cornos uterinos.",
  topic: "Tubas Uterinas"
},
{
  question: "Qual √© a principal fun√ß√£o das tubas uterinas e onde ocorre habitualmente a fertiliza√ß√£o?",
  options: [
    "A) Produzir horm√¥nios; no ov√°rio.",
    "B) Captar o o√≥cito e conduzi-lo ao √∫tero; na tuba uterina.",
    "C) Armazenar espermatozoides; no √∫tero.",
    "D) Regular o fluxo menstrual; na vagina."
  ],
  correctAnswer: "B) Captar o o√≥cito e conduzi-lo ao √∫tero; na tuba uterina.",
  comment: "Sua fun√ß√£o √© captar o o√≥cito liberado pelo ov√°rio e conduzi-lo at√© a cavidade uterina, sendo tamb√©m o local habitual da fertiliza√ß√£o.",
  topic: "Fun√ß√£o das Tubas Uterinas"
},
{
  question: "Qual estrutura peritoneal reveste as tubas uterinas e comp√µe a margem livre superior do ligamento largo?",
  options: [
    "A) Mesom√©trio.",
    "B) Mesov√°rio.",
    "C) Mesossalpinge.",
    "D) Perim√©trio."
  ],
  correctAnswer: "C) Mesossalpinge.",
  comment: "As tubas s√£o revestidas pelo mesossalpinge, que comp√µe a margem livre superior do ligamento largo.",
  topic: "Anatomia das Tubas Uterinas"
},
{
  question: "Em quantas partes as tubas uterinas s√£o divididas anatomicamente?",
  options: [
    "A) Duas.",
    "B) Tr√™s.",
    "C) Quatro.",
    "D) Cinco."
  ],
  correctAnswer: "C) Quatro.",
  comment: "elas s√£o divididas anatomicamente em quatro partes.",
  topic: "Segmentos das Tubas Uterinas"
},
{
  question: "Qual segmento da tuba uterina √© a extremidade distal em forma de funil, que possui f√≠mbrias, incluindo uma que se fixa ao ov√°rio?",
  options: [
    "A) Ampola.",
    "B) Istmo.",
    "C) Parte Uterina.",
    "D) Infund√≠bulo."
  ],
  correctAnswer: "D) Infund√≠bulo.",
  comment: "Infund√≠bulo: A extremidade distal em forma de funil que se abre na cavidade peritoneal atrav√©s do √≥stio abdominal. Possui processos digitiformes chamados f√≠mbrias, sendo que uma delas, a f√≠mbria ov√°rica, fixa-se diretamente ao ov√°rio para facilitar a capta√ß√£o do o√≥cito.",
  topic: "Segmentos das Tubas Uterinas"
},
{
  question: "Qual √© a parte mais longa e larga da tuba uterina, onde geralmente ocorre a fertiliza√ß√£o?",
  options: [
    "A) Istmo.",
    "B) Infund√≠bulo.",
    "C) Ampola.",
    "D) Parte Uterina."
  ],
  correctAnswer: "C) Ampola.",
  comment: "Ampola: A parte mais longa e larga da tuba, local onde geralmente ocorre a fertiliza√ß√£o.",
  topic: "Segmentos das Tubas Uterinas"
},
{
  question: "Qual segmento da tuba uterina √© uma por√ß√£o de parede espessa e l√∫men estreito que se conecta ao √∫tero?",
  options: [
    "A) Infund√≠bulo.",
    "B) Ampola.",
    "C) Istmo.",
    "D) Parte Uterina."
  ],
  correctAnswer: "C) Istmo.",
  comment: "Istmo: Uma por√ß√£o de parede espessa e l√∫men estreito que se conecta ao √∫tero.",
  topic: "Segmentos das Tubas Uterinas"
},
{
  question: "Qual segmento da tuba uterina atravessa a parede muscular do √∫tero e se abre no √≥stio uterino da tuba?",
  options: [
    "A) Ampola.",
    "B) Infund√≠bulo.",
    "C) Istmo.",
    "D) Parte Uterina (Intramural)."
  ],
  correctAnswer: "D) Parte Uterina (Intramural).",
  comment: "Parte Uterina (Intramural): O segmento curto que atravessa a parede muscular do √∫tero, abrindo-se no √≥stio uterino da tuba.",
  topic: "Segmentos das Tubas Uterinas"
},
{
  question: "Como o perit√¥nio recobre o ov√°rio, e qual √© a raz√£o para essa cobertura incompleta?",
  options: [
    "A) Totalmente recoberto; para prote√ß√£o.",
    "B) N√£o recoberto; para facilitar a vasculariza√ß√£o.",
    "C) N√£o totalmente recoberto; para permitir a ovula√ß√£o.",
    "D) Parcialmente recoberto; para suporte estrutural."
  ],
  correctAnswer: "C) N√£o totalmente recoberto; para permitir a ovula√ß√£o.",
  comment: "embora o ov√°rio tenha uma posi√ß√£o 'intraperitoneal' (dentro da cavidade), ele n√£o √© totalmente recoberto por perit√¥nio visceral para permitir a ovula√ß√£o, diferentemente do √∫tero.",
  topic: "Rela√ß√µes Peritoneais do Ov√°rio"
},
{
  question: "Qual √© o formato e o comprimento aproximado do √∫tero?",
  options: [
    "A) Formato de am√™ndoa, 4 cm.",
    "B) Formato de pera, 8 cm.",
    "C) Formato cil√≠ndrico, 10 cm.",
    "D) Formato esf√©rico, 2 cm."
  ],
  correctAnswer: "B) Formato de pera, 8 cm.",
  comment: "O √∫tero √© um √≥rg√£o muscular oco, com formato de pera, medindo aproximadamente 8 cm de comprimento.",
  topic: "Anatomia do √ötero"
},
{
  question: "Em uma mulher n√£o gr√°vida, onde o √∫tero se situa inteiramente?",
  options: [
    "A) Na pelve maior (falsa).",
    "B) Na cavidade abdominal.",
    "C) Na pelve menor (verdadeira).",
    "D) No per√≠neo."
  ],
  correctAnswer: "C) Na pelve menor (verdadeira).",
  comment: "Em uma mulher n√£o gr√°vida, o √∫tero situa-se inteiramente na pelve menor (verdadeira).",
  topic: "Localiza√ß√£o do √ötero"
},
{
  question: "Quais s√£o as tr√™s principais divis√µes do √∫tero?",
  options: [
    "A) Fundo, corpo e ampola.",
    "B) Corpo, istmo do √∫tero e colo (c√©rvice).",
    "C) Perim√©trio, miom√©trio e endom√©trio.",
    "D) Ligamento largo, mesov√°rio e mesossalpinge."
  ],
  correctAnswer: "B) Corpo, istmo do √∫tero e colo (c√©rvice).",
  comment: "O √∫tero divide-se em: Corpo, Istmo do √ötero, Colo (C√©rvice).",
  topic: "Divis√µes do √ötero"
},
{
  question: "Qual parte do √∫tero corresponde aos 2/3 superiores e possui uma face anterior (vesical) e uma face posterior (intestinal)?",
  options: [
    "A) Fundo do √∫tero.",
    "B) Colo (C√©rvice).",
    "C) Istmo do √ötero.",
    "D) Corpo do √∫tero."
  ],
  correctAnswer: "D) Corpo do √∫tero.",
  comment: "Corpo: Os 2/3 superiores. Possui uma face anterior (vesical) e uma face posterior (intestinal).",
  topic: "Anatomia do Corpo do √ötero"
},
{
  question: "Qual √© a parte superior arredondada do √∫tero, localizada acima das tubas?",
  options: [
    "A) Corpo do √∫tero.",
    "B) Istmo do √∫tero.",
    "C) Colo do √∫tero.",
    "D) Fundo do √∫tero."
  ],
  correctAnswer: "D) Fundo do √∫tero.",
  comment: "A parte superior arredondada acima das tubas √© o Fundo do √∫tero.",
  topic: "Anatomia do Fundo do √ötero"
},
{
  question: "Como √© definida a posi√ß√£o normal do √∫tero?",
  options: [
    "A) Retrovers√£o e retroflex√£o.",
    "B) Lateraliza√ß√£o e invers√£o.",
    "C) Antevers√£o e anteflex√£o.",
    "D) Verticaliza√ß√£o e retifica√ß√£o."
  ],
  correctAnswer: "C) Antevers√£o e anteflex√£o.",
  comment: "Normalmente, o √∫tero encontra-se em antevers√£o (inclinado anteriormente sobre a vagina) e anteflex√£o (o corpo flexionado sobre o colo).",
  topic: "Posi√ß√£o do √ötero"
},
{
  question: "Quais s√£o os fatores que podem variar a posi√ß√£o do √∫tero?",
  options: [
    "A) Apenas o ciclo menstrual.",
    "B) O enchimento da bexiga e do reto.",
    "C) Apenas a idade da mulher.",
    "D) Apenas o peso corporal."
  ],
  correctAnswer: "B) O enchimento da bexiga e do reto.",
  comment: "Essa posi√ß√£o varia com o enchimento da bexiga (que o empurra para tr√°s) e do reto.",
  topic: "Posi√ß√£o do √ötero"
},
{
  question: "Qual √© o nome do recesso peritoneal localizado entre o √∫tero e o reto, considerado o ponto mais baixo da cavidade peritoneal onde l√≠quidos e infec√ß√µes podem se acumular?",
  options: [
    "A) Escava√ß√£o Vesicouterina.",
    "B) Saco Peritoneal Anterior.",
    "C) Escava√ß√£o Retouterina (Saco de Douglas).",
    "D) F√≥rnice da Vagina."
  ],
  correctAnswer: "C) Escava√ß√£o Retouterina (Saco de Douglas).",
  comment: "Escava√ß√£o Retouterina (Saco de Douglas): Entre o √∫tero e o reto. √â o ponto mais baixo da cavidade peritoneal, onde l√≠quidos e infec√ß√µes podem se acumular.",
  topic: "Rela√ß√µes Peritoneais do √ötero"
},
{
  question: "Qual das camadas da parede do √∫tero √© a mais externa, formada por perit√¥nio e tecido conjuntivo?",
  options: [
    "A) Miom√©trio.",
    "B) Endom√©trio.",
    "C) Perim√©trio.",
    "D) Mesom√©trio."
  ],
  correctAnswer: "C) Perim√©trio.",
  comment: "Perim√©trio: A camada mais externa, uma t√∫nica serosa formada por perit√¥nio e tecido conjuntivo.",
  topic: "Camadas do √ötero"
},
{
  question: "Qual camada da parede do √∫tero √© a camada interm√©dia espessa de m√∫sculo liso, respons√°vel pelas contra√ß√µes no parto e c√≥licas menstruais?",
  options: [
    "A) Endom√©trio.",
    "B) Perim√©trio.",
    "C) Miom√©trio.",
    "D) Serosa."
  ],
  correctAnswer: "C) Miom√©trio.",
  comment: "Miom√©trio: A camada interm√©dia espessa de m√∫sculo liso, onde se encontram os principais vasos sangu√≠neos. Respons√°vel pelas contra√ß√µes no parto e c√≥licas menstruais.",
  topic: "Camadas do √ötero"
},
{
  question: "Qual camada da parede do √∫tero √© a mucosa interna que participa ativamente do ciclo menstrual, sofrendo modifica√ß√µes para receber o blastocisto ou descamar?",
  options: [
    "A) Perim√©trio.",
    "B) Miom√©trio.",
    "C) Endom√©trio.",
    "D) Advent√≠cia."
  ],
  correctAnswer: "C) Endom√©trio.",
  comment: "Endom√©trio: A camada mucosa interna, que adere ao miom√©trio. Participa ativamente do ciclo menstrual, sofrendo modifica√ß√µes estruturais para receber o blastocisto ou descamar durante a menstrua√ß√£o.",
  topic: "Camadas do √ötero"
},
{
  question: "Qual ligamento do colo do √∫tero se estende da por√ß√£o supravaginal at√© as paredes laterais da pelve?",
  options: [
    "A) Ligamento √ötero-ov√°rico.",
    "B) Ligamento Redondo do √ötero.",
    "C) Ligamento Suspensor do Ov√°rio.",
    "D) Ligamento transverso do colo (ou cardinal)."
  ],
  correctAnswer: "D) Ligamento transverso do colo (ou cardinal).",
  comment: "Al√©m dos ligamentos j√° citados, o √∫tero √© sustentado pelo ligamento transverso do colo (ou cardinal), que se estende da por√ß√£o supravaginal at√© as paredes laterais da pelve.",
  topic: "Ligamentos do Colo do √ötero"
},
{
  question: "Quais ligamentos ligam o colo do √∫tero ao sacro e s√£o essenciais para mant√™-lo centralizado?",
  options: [
    "A) Ligamento Largo do √ötero.",
    "B) Ligamentos Uterossacros.",
    "C) Ligamentos Redondos.",
    "D) Ligamentos Cardinais."
  ],
  correctAnswer: "B) Ligamentos Uterossacros.",
  comment: "Existem tamb√©m os ligamentos uterossacros, que ligam o colo ao sacro, sendo palp√°veis ao toque retal e essenciais para manter o √∫tero centralizado.",
  topic: "Ligamentos do Colo do √ötero"
},
{
  question: "Quais s√£o as fun√ß√µes da vagina?",
  options: [
    "A) Apenas canal para o fluxo menstrual.",
    "B) Apenas recep√ß√£o do p√™nis/s√™men.",
    "C) Canal para fluxo menstrual, parte do canal do parto e recep√ß√£o do p√™nis/s√™men.",
    "D) Produ√ß√£o de o√≥citos e horm√¥nios."
  ],
  correctAnswer: "C) Canal para fluxo menstrual, parte do canal do parto e recep√ß√£o do p√™nis/s√™men.",
  comment: "Fun√ß√µes incluem canal para fluxo menstrual, parte do canal do parto e recep√ß√£o do p√™nis/s√™men.",
  topic: "Fun√ß√µes da Vagina"
},
{
  question: "Com quais estruturas a vagina se relaciona anteriormente, de acordo com o texto?",
  options: [
    "A) Com o canal anal e reto.",
    "B) Com o fundo da bexiga e uretra.",
    "C) Com o m√∫sculo levantador do √¢nus.",
    "D) Com o colo sigmoide e ov√°rio."
  ],
  correctAnswer: "B) Com o fundo da bexiga e uretra.",
  comment: "Anteriormente relaciona-se com o fundo da bexiga e uretra.",
  topic: "Sintopia da Vagina"
},
{
  question: "O que √© o f√≥rnice da vagina?",
  options: [
    "A) A parte mais distal da vagina.",
    "B) O recesso formado ao redor do colo do √∫tero, dividido em partes anterior, posterior e laterais.",
    "C) A por√ß√£o da vagina que se abre no vest√≠bulo.",
    "D) A camada muscular mais externa da vagina."
  ],
  correctAnswer: "B) O recesso formado ao redor do colo do √∫tero, dividido em partes anterior, posterior e laterais.",
  comment: "F√≥rnice da Vagina: O recesso formado ao redor do colo do √∫tero, dividido em partes anterior, posterior e laterais.",
  topic: "Anatomia da Vagina"
},
{
  question: "Onde o Ligamento Redondo do √ötero termina ap√≥s atravessar o canal inguinal?",
  options: [
    "A) Na parede lateral da pelve.",
    "B) No sacro.",
    "C) Na pele e tecido adiposo dos l√°bios maiores.",
    "D) No ov√°rio."
  ],
  correctAnswer: "C) Na pele e tecido adiposo dos l√°bios maiores.",
  comment: "O Ligamento Redondo do √ötero, ap√≥s atravessar o canal inguinal, termina inserindo-se na pele e tecido adiposo dos l√°bios maiores.",
  topic: "Genit√°lia Externa Feminina (Vulva)"
},
{
  question: "Qual √≥rg√£o genital externo √© er√©til, sensorial, localizado na jun√ß√£o anterior dos l√°bios menores e formado por raiz, corpo e glande?",
  options: [
    "A) Monte do p√∫bis.",
    "B) L√°bios maiores.",
    "C) Clit√≥ris.",
    "D) L√°bios menores."
  ],
  correctAnswer: "C) Clit√≥ris.",
  comment: "Clit√≥ris: √ìrg√£o er√©til sensorial localizado na jun√ß√£o anterior dos l√°bios menores. Formado por raiz (ramos), corpo e glande.",
  topic: "Genit√°lia Externa Feminina (Vulva)"
},
{
  question: "Qual a fun√ß√£o exclusiva do clit√≥ris, destacada no texto?",
  options: [
    "A) Mic√ß√£o.",
    "B) Reprodu√ß√£o.",
    "C) Excita√ß√£o sexual.",
    "D) Lubrifica√ß√£o."
  ],
  correctAnswer: "C) Excita√ß√£o sexual.",
  comment: "Diferentemente do p√™nis, o clit√≥ris n√£o possui rela√ß√£o funcional com a uretra ou mic√ß√£o, servindo exclusivamente para excita√ß√£o sexual.",
  topic: "Estrutura do Clit√≥ris"
},
{
  question: "Quais estruturas se abrem no vest√≠bulo da vagina?",
  options: [
    "A) Apenas o √≥stio externo da uretra.",
    "B) Apenas o √≥stio da vagina.",
    "C) √ìstio externo da uretra, √≥stio da vagina e ductos das gl√¢ndulas vestibulares.",
    "D) Ureter e colo do √∫tero."
  ],
  correctAnswer: "C) √ìstio externo da uretra, √≥stio da vagina e ductos das gl√¢ndulas vestibulares.",
  comment: "Neste espa√ßo abrem-se: 1. √ìstio externo da uretra: Localizado anteriormente. 2. √ìstio da vagina (Introito): Localizado posteriormente √† uretra. 3. Ductos das Gl√¢ndulas Vestibulares.",
  topic: "Vest√≠bulo da Vagina"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
</body>
</html>
