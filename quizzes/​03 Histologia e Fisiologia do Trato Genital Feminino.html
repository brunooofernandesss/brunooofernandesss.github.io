
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‚Äã03 Histologia e Fisiologia do Trato Genital Feminino</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; background-color: #f4f4f4; }
        .quiz-container { max-width: 800px; width: 100%; }
        h1 { color: #333; text-align: center; margin-bottom: 30px; }
        .card { background-color: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); }
        .question { font-weight: bold; margin-bottom: 10px; color: #333; }
        .options { margin-top: 15px; }
        
        /* Estilos das op√ß√µes */
        .option, label.option, label, #newQuestionsContent label { display: flex; align-items: center; margin-bottom: 10px; padding: 10px; border: 1px solid #ddd; border-radius: 5px; cursor: pointer; transition: background-color 0.2s ease; position: relative; }
        
        /* Ocultar Radio inputs */
        .option input[type="radio"], label input[type="radio"], #newQuestionsContent input[type="radio"], #newQuestionsContent label input[type="radio"] { display: none !important; visibility: hidden !important; opacity: 0 !important; position: absolute !important; left: -9999px !important; }
        
        .option:hover, label.option:hover, label:hover, #newQuestionsContent label:hover { background-color: #e9e9e9; }
        .option.selected, label.option.selected, label.selected, #newQuestionsContent label.selected { background-color: #d1e7dd; border-color: #28a745; }
        .option.correct, label.option.correct, label.correct, #newQuestionsContent label.correct { background-color: #d4edda; border-color: #28a745; }
        .option.incorrect, label.option.incorrect, label.incorrect, #newQuestionsContent label.incorrect { background-color: #f8d7da; border-color: #dc3545; }
        
        .submit-btn { display: block; width: 100%; padding: 15px; background-color: #007bff; color: white; border: none; border-radius: 5px; font-size: 18px; cursor: pointer; transition: background-color 0.3s ease; margin-top: 30px; }
        .submit-btn:hover { background-color: #0056b3; }
        
        .results { text-align: center; margin-top: 30px; font-size: 20px; font-weight: bold; color: #333; }
        .scissor-icon { margin-right: 10px; width: 20px; height: 20px; opacity: 0.5; cursor: pointer; }
        .scissor-icon.hidden { display: none; }
        .struck-through { text-decoration: line-through; color: #888; }
        
        .comment { margin-top: 10px; padding: 10px; background-color: #f0f0f0; border-left: 4px solid #007bff; font-style: italic; color: #555; display: none; }
        .comment.show { display: block; }
        
        .card-bloco { border: 1px solid #ddd; border-radius: 6px; padding: 10px; background: #fff; margin-bottom: 20px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        
        /* Diagn√≥stico e Erros */
        .error-diagnosis-section { margin-top: 50px; padding: 30px; background-color: #ffe0b2; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.15); display: none; text-align: center; font-size: 1.1em; color: #333; }
        .error-diagnosis-section h2 { color: #e65100; margin-bottom: 20px; font-size: 1.8em; }
        .error-diagnosis-section ul { list-style: none; padding: 0; margin: 0; }
        .error-diagnosis-section li { background-color: #ff9800; color: white; padding: 8px 15px; margin: 8px 0; border-radius: 5px; display: inline-block; margin-right: 10px; font-weight: bold; }
    </style>
</head>
<body>

    <div class="quiz-container" id="quiz-container">
        <h1>‚Äã03 Histologia e Fisiologia do Trato Genital Feminino</h1>
        
        <div id="quiz"></div>
        
        <button class="submit-btn" id="verifyAnswersBtn">Verificar Respostas</button>
        <button class="generate-questions-btn submit-btn" id="generateNewQuestionsBtn" style="display:none;">Gerar Novas Perguntas</button>
        
        <div class="results card-bloco" id="results"></div>
        <div id="statusMessage" style="text-align: center; margin-top: 10px; font-weight: bold; color: #007bff;"></div>
        
        <div class="error-diagnosis-section card-bloco" id="errorDiagnosis">
            <h2>Diagn√≥stico de Erros</h2>
            <p>Parece que voc√™ precisa revisar os seguintes assuntos:</p>
            <ul id="topicsToReview"></ul>
        </div>
        
        <div class="generated-questions-section card-bloco" id="generatedQuestionsSection" style="display:none;">
            <h2>Novas Perguntas Geradas</h2>
            <div id="newQuestionsContent"></div>
        </div>
    </div>

<script>
    const quizContainer = document.getElementById("quiz");
    const resultsContainer = document.getElementById("results");
    const errorDiagnosisSection = document.getElementById("errorDiagnosis");
    const topicsToReviewList = document.getElementById("topicsToReview");
    const generateNewQuestionsBtn = document.getElementById("generateNewQuestionsBtn");
    const generatedQuestionsSection = document.getElementById("generatedQuestionsSection");
    const newQuestionsContent = document.getElementById("newQuestionsContent");
    const statusMessage = document.getElementById("statusMessage");

    let wrongQuestionIndices = [];
    let errorCountByTopic = {};  // CORRIGIDO: chaves duplas para objeto JS vazio
    let totalAnsweredQuestionsByTopic = {}; // CORRIGIDO
    let currentWrongQuestionIndex = -1;
    let hasErrors = false;

    // Inicializa display
    errorDiagnosisSection.style.display = 'none';
    topicsToReviewList.innerHTML = '';
    statusMessage.textContent = '';

    // AQUI entra a vari√°vel Python, ent√£o usamos chaves simples:
    const questions = [ {
  question: "Qual caracter√≠stica distingue o sistema genital feminino de outros sistemas do corpo, de acordo com o texto?",
  options: [
    "A) Ele funciona continuamente desde o nascimento.",
    "B) Ele permanece "adormecido" at√© a puberdade.",
    "C) Sua fun√ß√£o principal √© a manuten√ß√£o da homeostase.",
    "D) √â o √∫nico sistema sem √≥rg√£os internos.",
  ],
  correctAnswer: "B) Ele permanece "adormecido" at√© a puberdade.",
  comment: "O texto afirma que o sistema genital, ao contr√°rio de outros, permanece "adormecido" at√© a puberdade.",
  topic: "Introdu√ß√£o ao Sistema Genital Feminino"
},
{
  question: "Qual √© o formato e a faixa de peso dos ov√°rios, conforme descrito no texto?",
  options: [
    "A) Formato oval, pesando entre 15 a 20g.",
    "B) Formato de am√™ndoa, pesando entre 7 a 14g.",
    "C) Formato esf√©rico, pesando entre 5 a 10g.",
    "D) Formato de feij√£o, pesando entre 10 a 15g.",
  ],
  correctAnswer: "B) Formato de am√™ndoa, pesando entre 7 a 14g.",
  comment: "Os ov√°rios s√£o descritos como tendo formato de am√™ndoa e pesando entre 7 a 14g, com 2 a 4 cm de medida.",
  topic: "Ov√°rios - Anatomia"
},
{
  question: "Qual √© a dupla fun√ß√£o dos ov√°rios?",
  options: [
    "A) Produ√ß√£o de urina e regula√ß√£o da press√£o arterial.",
    "B) Desenvolvimento de o√≥citos e produ√ß√£o de horm√¥nios sexuais.",
    "C) Filtra√ß√£o do sangue e armazenamento de glicog√™nio.",
    "D) Produ√ß√£o de espermatozoides e secre√ß√£o de insulina.",
  ],
  correctAnswer: "B) Desenvolvimento de o√≥citos e produ√ß√£o de horm√¥nios sexuais.",
  comment: "O texto destaca que os ov√°rios t√™m dupla fun√ß√£o: o desenvolvimento dos o√≥citos (gametas) e a fun√ß√£o de gl√¢ndula end√≥crina, produzindo horm√¥nios sexuais.",
  topic: "Ov√°rios - Fun√ß√£o"
},
{
  question: "Posteriormente, com quais estruturas anat√¥micas os ov√°rios se relacionam, de acordo com o texto?",
  options: [
    "A) Bexiga urin√°ria e c√≥lon descendente.",
    "B) Ureter e nervo obturat√≥rio.",
    "C) Reto e s√≠nfise p√∫bica.",
    "D) Fundo uterino e art√©ria il√≠aca externa.",
  ],
  correctAnswer: "B) Ureter e nervo obturat√≥rio.",
  comment: "Em termos de sintopia, os ov√°rios relacionam-se posteriormente com o ureter e o nervo obturat√≥rio.",
  topic: "Ov√°rios - Sintopia"
},
{
  question: "Como o Mesov√°rio √© descrito em rela√ß√£o ao perit√¥nio?",
  options: [
    "A) Uma prega peritoneal vertical anterior.",
    "B) Uma dupla camada peritoneal horizontal e posterior.",
    "C) Um ligamento fibroso denso sem cobertura peritoneal.",
    "D) Uma camada √∫nica de perit√¥nio visceral que recobre o ov√°rio totalmente.",
  ],
  correctAnswer: "B) Uma dupla camada peritoneal horizontal e posterior.",
  comment: "O Mesov√°rio √© descrito como uma dupla camada peritoneal horizontal e posterior.",
  topic: "Ov√°rios - Perit√¥nio"
},
{
  question: "Quais estruturas passam pela prega peritoneal conhecida como Ligamento Suspensor do Ov√°rio?",
  options: [
    "A) Ducto deferente e art√©ria testicular.",
    "B) Vasos sangu√≠neos (art√©ria e veia ov√°ricas), linf√°ticos e nervos.",
    "C) Ligamento redondo do √∫tero e ureter.",
    "D) Nervo pudendo e art√©ria uterina.",
  ],
  correctAnswer: "B) Vasos sangu√≠neos (art√©ria e veia ov√°ricas), linf√°ticos e nervos.",
  comment: "O Ligamento Suspensor do Ov√°rio √© uma prega peritoneal por onde passam os vasos sangu√≠neos (art√©ria e veia ov√°ricas), linf√°ticos e nervos.",
  topic: "Ov√°rios - Ligamentos"
},
{
  question: "Qual √© a principal fun√ß√£o do Ligamento √ötero-ov√°rico (ou pr√≥prio do ov√°rio)?",
  options: [
    "A) Fixar o ov√°rio √† parede abdominal anterior.",
    "B) Fixar o ov√°rio √† parede lateral do √∫tero.",
    "C) Conectar o ov√°rio ao ligamento suspensor.",
    "D) Sustentar o ov√°rio ao assoalho p√©lvico.",
  ],
  correctAnswer: "B) Fixar o ov√°rio √† parede lateral do √∫tero.",
  comment: "O Ligamento √ötero-ov√°rico √© um ligamento curto que fixa o ov√°rio √† parede lateral do √∫tero, posicionado medialmente no mesov√°rio.",
  topic: "Ov√°rios - Ligamentos"
},
{
  question: "Qual √© o comprimento aproximado das tubas uterinas?",
  options: [
    "A) Cerca de 5 cm.",
    "B) Cerca de 10 cm.",
    "C) Cerca de 15 cm.",
    "D) Cerca de 20 cm.",
  ],
  correctAnswer: "B) Cerca de 10 cm.",
  comment: "As tubas uterinas (antigas trompas de Fal√≥pio) medem cerca de 10 cm.",
  topic: "Tubas Uterinas - Anatomia"
},
{
  question: "Al√©m de captar o o√≥cito, qual √© a outra fun√ß√£o primordial das tubas uterinas?",
  options: [
    "A) Produ√ß√£o de horm√¥nios esteroides.",
    "B) Armazenamento tempor√°rio de espermatozoides.",
    "C) Local habitual da fertiliza√ß√£o.",
    "D) Produ√ß√£o de l√≠quido peritoneal.",
  ],
  correctAnswer: "C) Local habitual da fertiliza√ß√£o.",
  comment: "A fun√ß√£o das tubas √© captar o o√≥cito e conduzi-lo, sendo tamb√©m o local habitual da fertiliza√ß√£o.",
  topic: "Tubas Uterinas - Fun√ß√£o"
},
{
  question: "Qual parte do ligamento largo √© respons√°vel por revestir as tubas uterinas?",
  options: [
    "A) Mesom√©trio.",
    "B) Mesov√°rio.",
    "C) Mesossalpinge.",
    "D) Ligamento redondo.",
  ],
  correctAnswer: "C) Mesossalpinge.",
  comment: "As tubas s√£o revestidas pelo mesossalpinge, que comp√µe a margem livre superior do ligamento largo.",
  topic: "Tubas Uterinas - Perit√¥nio"
},
{
  question: "Qual caracter√≠stica √© espec√≠fica do Infund√≠bulo das tubas uterinas?",
  options: [
    "A) √â a parte mais longa e larga, onde ocorre a fertiliza√ß√£o.",
    "B) Possui f√≠mbrias, sendo que uma delas (ov√°rica) se fixa ao ov√°rio.",
    "C) √â a por√ß√£o de parede espessa e l√∫men estreito que se conecta ao √∫tero.",
    "D) Atravessa a parede muscular do √∫tero.",
  ],
  correctAnswer: "B) Possui f√≠mbrias, sendo que uma delas (ov√°rica) se fixa ao ov√°rio.",
  comment: "O Infund√≠bulo possui processos digitiformes chamados f√≠mbrias, sendo que uma delas, a f√≠mbria ov√°rica, fixa-se diretamente ao ov√°rio para facilitar a capta√ß√£o do o√≥cito.",
  topic: "Tubas Uterinas - Segmentos"
},
{
  question: "Qual segmento da tuba uterina √© o local onde geralmente ocorre a fertiliza√ß√£o?",
  options: [
    "A) Infund√≠bulo.",
    "B) Ampola.",
    "C) Istmo.",
    "D) Parte Uterina (Intramural).",
  ],
  correctAnswer: "B) Ampola.",
  comment: "A Ampola √© a parte mais longa e larga da tuba, local onde geralmente ocorre a fertiliza√ß√£o.",
  topic: "Tubas Uterinas - Segmentos"
},
{
  question: "Como √© descrito o Istmo da tuba uterina?",
  options: [
    "A) Extremidade distal em forma de funil.",
    "B) Parte mais longa e larga da tuba.",
    "C) Por√ß√£o de parede espessa e l√∫men estreito que se conecta ao √∫tero.",
    "D) Segmento que atravessa a parede muscular do √∫tero.",
  ],
  correctAnswer: "C) Por√ß√£o de parede espessa e l√∫men estreito que se conecta ao √∫tero.",
  comment: "O Istmo √© uma por√ß√£o de parede espessa e l√∫men estreito que se conecta ao √∫tero.",
  topic: "Tubas Uterinas - Segmentos"
},
{
  question: "Por que o ov√°rio, embora intraperitoneal, n√£o √© totalmente recoberto por perit√¥nio visceral?",
  options: [
    "A) Para permitir a fixa√ß√£o de ligamentos.",
    "B) Para facilitar sua vasculariza√ß√£o.",
    "C) Para permitir a ovula√ß√£o.",
    "D) Para diferenciar-se do √∫tero.",
  ],
  correctAnswer: "C) Para permitir a ovula√ß√£o.",
  comment: "O ov√°rio n√£o √© totalmente recoberto por perit√¥nio visceral para permitir a ovula√ß√£o.",
  topic: "Ov√°rios - Perit√¥nio"
},
{
  question: "Qual o formato e o comprimento aproximado do √∫tero em uma mulher n√£o gr√°vida?",
  options: [
    "A) Formato arredondado, cerca de 5 cm.",
    "B) Formato de pera, cerca de 8 cm.",
    "C) Formato cil√≠ndrico, cerca de 10 cm.",
    "D) Formato triangular, cerca de 6 cm.",
  ],
  correctAnswer: "B) Formato de pera, cerca de 8 cm.",
  comment: "O √∫tero √© um √≥rg√£o muscular oco, com formato de pera, medindo aproximadamente 8 cm de comprimento.",
  topic: "√ötero - Anatomia Geral"
},
{
  question: "Qual a principal fun√ß√£o das paredes musculares do √∫tero, conforme o texto?",
  options: [
    "A) Produzir horm√¥nios reprodutivos.",
    "B) Absorver nutrientes para o embri√£o.",
    "C) Adaptar-se ao crescimento fetal e gerar for√ßa para a expuls√£o no parto.",
    "D) Filtrar o sangue materno para o feto.",
  ],
  correctAnswer: "C) Adaptar-se ao crescimento fetal e gerar for√ßa para a expuls√£o no parto.",
  comment: "Suas paredes musculares adaptam-se ao crescimento fetal e geram for√ßa para a expuls√£o no parto.",
  topic: "√ötero - Fun√ß√£o"
},
{
  question: "Onde o √∫tero de uma mulher n√£o gr√°vida se situa inteiramente?",
  options: [
    "A) Na pelve maior (falsa).",
    "B) Na cavidade abdominal superior.",
    "C) Na pelve menor (verdadeira).",
    "D) Acima da linha terminal da pelve.",
  ],
  correctAnswer: "C) Na pelve menor (verdadeira).",
  comment: "Em uma mulher n√£o gr√°vida, o √∫tero situa-se inteiramente na pelve menor (verdadeira).",
  topic: "√ötero - Localiza√ß√£o"
},
{
  question: "Quais s√£o as duas faces do Corpo do √∫tero?",
  options: [
    "A) Anterior (intestinal) e Posterior (vesical).",
    "B) Superior (fundal) e Inferior (cervical).",
    "C) Anterior (vesical) e Posterior (intestinal).",
    "D) Medial (tub√°ria) e Lateral (ov√°rica).",
  ],
  correctAnswer: "C) Anterior (vesical) e Posterior (intestinal).",
  comment: "O Corpo do √∫tero possui uma face anterior (vesical) e uma face posterior (intestinal).",
  topic: "√ötero - Divis√µes"
},
{
  question: "Como √© definida a por√ß√£o do Fundo do √∫tero?",
  options: [
    "A) O estreitamento entre o corpo e o colo.",
    "B) O ter√ßo inferior cil√≠ndrico.",
    "C) A parte superior arredondada acima das tubas.",
    "D) A por√ß√£o que protrui para dentro da vagina.",
  ],
  correctAnswer: "C) A parte superior arredondada acima das tubas.",
  comment: "A parte superior arredondada acima das tubas √© o Fundo do √∫tero.",
  topic: "√ötero - Divis√µes"
},
{
  question: "Qual a descri√ß√£o do Istmo do √∫tero?",
  options: [
    "A) √â o ter√ßo inferior cil√≠ndrico.",
    "B) √â a por√ß√£o supravaginal do colo.",
    "C) √â um estreitamento de cerca de 1 cm entre o corpo e o colo.",
    "D) √â a parte superior arredondada acima das tubas.",
  ],
  correctAnswer: "C) √â um estreitamento de cerca de 1 cm entre o corpo e o colo.",
  comment: "O Istmo do √ötero √© um estreitamento de cerca de 1 cm entre o corpo e o colo.",
  topic: "√ötero - Divis√µes"
},
{
  question: "Quais s√£o as duas por√ß√µes em que o Colo (C√©rvice) do √∫tero √© dividido?",
  options: [
    "A) Por√ß√£o fundal e por√ß√£o corporal.",
    "B) Por√ß√£o medial e por√ß√£o lateral.",
    "C) Por√ß√£o supravaginal e por√ß√£o vaginal.",
    "D) Por√ß√£o anterior e por√ß√£o posterior.",
  ],
  correctAnswer: "C) Por√ß√£o supravaginal e por√ß√£o vaginal.",
  comment: "O Colo divide-se em por√ß√£o supravaginal (entre o istmo e a vagina) e por√ß√£o vaginal (que protrui para dentro da vagina).",
  topic: "√ötero - Divis√µes"
},
{
  question: "Qual √© a posi√ß√£o normal do √∫tero, conforme descrito no texto?",
  options: [
    "A) Retrovers√£o e retroflex√£o.",
    "B) Antevers√£o e anteflex√£o.",
    "C) Lateralmente inclinado.",
    "D) Verticalmente alinhado.",
  ],
  correctAnswer: "B) Antevers√£o e anteflex√£o.",
  comment: "Normalmente, o √∫tero encontra-se em antevers√£o (inclinado anteriormente sobre a vagina) e anteflex√£o (o corpo flexionado sobre o colo).",
  topic: "√ötero - Posi√ß√£o"
},
{
  question: "Por que a Escava√ß√£o Retouterina (Saco de Douglas) √© clinicamente importante?",
  options: [
    "A) √â o local de fixa√ß√£o do ligamento largo do √∫tero.",
    "B) √â o ponto mais baixo da cavidade peritoneal, onde l√≠quidos e infec√ß√µes podem se acumular.",
    "C) √â o local onde a fertiliza√ß√£o geralmente ocorre.",
    "D) √â uma estrutura que n√£o varia de posi√ß√£o.",
  ],
  correctAnswer: "B) √â o ponto mais baixo da cavidade peritoneal, onde l√≠quidos e infec√ß√µes podem se acumular.",
  comment: "A Escava√ß√£o Retouterina (Saco de Douglas) √© o ponto mais baixo da cavidade peritoneal, onde l√≠quidos e infec√ß√µes podem se acumular.",
  topic: "√ötero - Rela√ß√µes Peritoneais"
},
{
  question: "Qual a composi√ß√£o do Perim√©trio, a camada mais externa da parede uterina?",
  options: [
    "A) M√∫sculo liso denso.",
    "B) Camada mucosa glandular.",
    "C) Perit√¥nio e tecido conjuntivo.",
    "D) Tecido epitelial estratificado.",
  ],
  correctAnswer: "C) Perit√¥nio e tecido conjuntivo.",
  comment: "O Perim√©trio √© a camada mais externa, uma t√∫nica serosa formada por perit√¥nio e tecido conjuntivo.",
  topic: "√ötero - Camadas Uterinas"
},
{
  question: "Qual camada uterina √© respons√°vel pelas contra√ß√µes no parto e c√≥licas menstruais?",
  options: [
    "A) Perim√©trio.",
    "B) Miom√©trio.",
    "C) Endom√©trio.",
    "D) Epim√©trio.",
  ],
  correctAnswer: "B) Miom√©trio.",
  comment: "O Miom√©trio √© a camada interm√©dia espessa de m√∫sculo liso, respons√°vel pelas contra√ß√µes no parto e c√≥licas menstruais.",
  topic: "√ötero - Camadas Uterinas"
},
{
  question: "Qual camada uterina participa ativamente do ciclo menstrual, sofrendo modifica√ß√µes estruturais para receber o blastocisto ou descamar?",
  options: [
    "A) Perim√©trio.",
    "B) Miom√©trio.",
    "C) Endom√©trio.",
    "D) Mesom√©trio.",
  ],
  correctAnswer: "C) Endom√©trio.",
  comment: "O Endom√©trio √© a camada mucosa interna que adere ao miom√©trio e participa ativamente do ciclo menstrual, sofrendo modifica√ß√µes para receber o blastocisto ou descamar.",
  topic: "√ötero - Camadas Uterinas"
},
{
  question: "Onde o ligamento transverso do colo (ou cardinal) se estende para sustentar o √∫tero?",
  options: [
    "A) Do fundo do √∫tero at√© o ov√°rio.",
    "B) Do corpo do √∫tero at√© a bexiga.",
    "C) Da por√ß√£o supravaginal do colo at√© as paredes laterais da pelve.",
    "D) Do colo at√© o sacro.",
  ],
  correctAnswer: "C) Da por√ß√£o supravaginal do colo at√© as paredes laterais da pelve.",
  comment: "O ligamento transverso do colo (ou cardinal) estende-se da por√ß√£o supravaginal at√© as paredes laterais da pelve.",
  topic: "√ötero - Ligamentos"
},
{
  question: "Qual √© a descri√ß√£o da vagina, incluindo seu comprimento e conex√µes?",
  options: [
    "A) Um tubo muscular r√≠gido de 5 a 7 cm, que conecta o √∫tero √† uretra.",
    "B) Um tubo musculomembran√°ceo distens√≠vel, de 7 a 9 cm, que conecta o colo do √∫tero ao vest√≠bulo da vagina.",
    "C) Uma cavidade glandular de 10 a 12 cm, que conecta o ov√°rio ao √∫tero.",
    "D) Um ducto fibroso n√£o distens√≠vel de 6 a 8 cm, que conecta o reto ao vest√≠bulo.",
  ],
  correctAnswer: "B) Um tubo musculomembran√°ceo distens√≠vel, de 7 a 9 cm, que conecta o colo do √∫tero ao vest√≠bulo da vagina.",
  comment: "A vagina √© um tubo musculomembran√°ceo distens√≠vel, de 7 a 9 cm, que conecta o colo do √∫tero ao vest√≠bulo da vagina.",
  topic: "Vagina - Anatomia Geral"
},
{
  question: "Com quais estruturas a vagina se relaciona anteriormente?",
  options: [
    "A) Colo do √∫tero e saco de Douglas.",
    "B) Fundo da bexiga e uretra.",
    "C) Canal anal e reto.",
    "D) M√∫sculo levantador do √¢nus.",
  ],
  correctAnswer: "B) Fundo da bexiga e uretra.",
  comment: "Anteriormente, a vagina relaciona-se com o fundo da bexiga e uretra.",
  topic: "Vagina - Sintopia"
},
{
  question: "O que √© o F√≥rnice da Vagina?",
  options: [
    "A) A parede posterior da vagina.",
    "B) O recesso formado ao redor do colo do √∫tero.",
    "C) A abertura externa da vagina.",
    "D) A camada muscular da vagina.",
  ],
  correctAnswer: "B) O recesso formado ao redor do colo do √∫tero.",
  comment: "O F√≥rnice da Vagina √© o recesso formado ao redor do colo do √∫tero, dividido em partes anterior, posterior e laterais.",
  topic: "Vagina - Anatomia"
},
{
  question: "Qual dos seguintes n√£o faz parte dos √≥rg√£os genitais externos (Vulva), de acordo com o texto?",
  options: [
    "A) Monte do p√∫bis.",
    "B) L√°bios maiores.",
    "C) Ov√°rios.",
    "D) Clit√≥ris.",
  ],
  correctAnswer: "C) Ov√°rios.",
  comment: "Os √≥rg√£os externos incluem o monte do p√∫bis, l√°bios maiores e menores, clit√≥ris, vest√≠bulo e gl√¢ndulas vestibulares. Os ov√°rios s√£o √≥rg√£os internos.",
  topic: "Genit√°lia Externa - Componentes"
},
{
  question: "Como √© descrito o Monte do P√∫bis?",
  options: [
    "A) Pregas cut√¢neas com tecido adiposo e m√∫sculo liso.",
    "B) √ìrg√£o er√©til sensorial na jun√ß√£o anterior dos l√°bios menores.",
    "C) Emin√™ncia de tecido adiposo anterior √† s√≠nfise p√∫bica, coberta por pelos ap√≥s a puberdade.",
    "D) Espa√ßo fenda entre os l√°bios menores.",
  ],
  correctAnswer: "C) Emin√™ncia de tecido adiposo anterior √† s√≠nfise p√∫bica, coberta por pelos ap√≥s a puberdade.",
  comment: "O Monte do P√∫bis √© uma emin√™ncia de tecido adiposo anterior √† s√≠nfise p√∫bica, coberta por pelos ap√≥s a puberdade.",
  topic: "Genit√°lia Externa - Monte do P√∫bis"
},
{
  question: "Onde o Ligamento Redondo do √ötero termina ap√≥s atravessar o canal inguinal?",
  options: [
    "A) Na por√ß√£o supravaginal do colo.",
    "B) Na pele e tecido adiposo dos l√°bios maiores.",
    "C) Na parede lateral da pelve.",
    "D) No mesov√°rio.",
  ],
  correctAnswer: "B) Na pele e tecido adiposo dos l√°bios maiores.",
  comment: "O Ligamento Redondo do √ötero, ap√≥s atravessar o canal inguinal, termina inserindo-se na pele e tecido adiposo dos l√°bios maiores.",
  topic: "Genit√°lia Externa - L√°bios Maiores"
},
{
  question: "Qual a principal caracter√≠stica que distingue os L√°bios Menores?",
  options: [
    "A) S√£o pregas cut√¢neas proeminentes cobertas por pelos externamente.",
    "B) S√£o pregas de pele sem pelos e sem gordura, com n√∫cleo de tecido conjuntivo esponjoso e er√©til.",
    "C) S√£o √≥rg√£os er√©teis que cont√™m corpos cavernosos.",
    "D) S√£o as gl√¢ndulas respons√°veis pela lubrifica√ß√£o do vest√≠bulo.",
  ],
  correctAnswer: "B) S√£o pregas de pele sem pelos e sem gordura, com n√∫cleo de tecido conjuntivo esponjoso e er√©til.",
  comment: "Os L√°bios Menores s√£o pregas de pele sem pelos e sem gordura, situadas medialmente, que fecham o vest√≠bulo da vagina e possuem um n√∫cleo de tecido conjuntivo esponjoso com tecido er√©til.",
  topic: "Genit√°lia Externa - L√°bios Menores"
},
{
  question: "Qual √© a fun√ß√£o exclusiva do clit√≥ris, em contraste com o p√™nis?",
  options: [
    "A) Condu√ß√£o da urina.",
    "B) Mic√ß√£o.",
    "C) Excita√ß√£o sexual.",
    "D) Reprodu√ß√£o.",
  ],
  correctAnswer: "C) Excita√ß√£o sexual.",
  comment: "Diferentemente do p√™nis, o clit√≥ris n√£o possui rela√ß√£o funcional com a uretra ou mic√ß√£o, servindo exclusivamente para excita√ß√£o sexual.",
  topic: "Clit√≥ris - Fun√ß√£o"
},
{
  question: "Por qual tipo de tecido er√©til o clit√≥ris √© composto?",
  options: [
    "A) Corpos esponjosos.",
    "B) Corpos cavernosos.",
    "C) Bulbos vestibulares.",
    "D) Tecido fibroso denso.",
  ],
  correctAnswer: "B) Corpos cavernosos.",
  comment: "O clit√≥ris √© composto por corpos cavernosos (tecido er√©til) circundados por uma f√°scia.",
  topic: "Clit√≥ris - Anatomia"
},
{
  question: "Como o prep√∫cio do clit√≥ris √© formado?",
  options: [
    "A) Pela fus√£o anterior dos l√°bios maiores.",
    "B) Pela fus√£o posterior dos l√°bios menores.",
    "C) Pela fus√£o anterior dos l√°bios menores.",
    "D) Pela separa√ß√£o dos ramos do clit√≥ris.",
  ],
  correctAnswer: "C) Pela fus√£o anterior dos l√°bios menores.",
  comment: "O prep√∫cio do clit√≥ris √© uma prega de pele formada pela fus√£o anterior dos l√°bios menores.",
  topic: "Clit√≥ris - Anatomia"
},
{
  question: "O que √© o Vest√≠bulo da Vagina?",
  options: [
    "A) A abertura externa da uretra.",
    "B) O espa√ßo fenda entre os l√°bios menores.",
    "C) A por√ß√£o interna da vagina.",
    "D) A regi√£o do monte do p√∫bis.",
  ],
  correctAnswer: "B) O espa√ßo fenda entre os l√°bios menores.",
  comment: "O vest√≠bulo √© o espa√ßo fenda entre os l√°bios menores.",
  topic: "Vest√≠bulo da Vagina - Anatomia"
},
{
  question: "Qual a fun√ß√£o principal das Gl√¢ndulas Vestibulares (maiores e menores)?",
  options: [
    "A) Produ√ß√£o de o√≥citos.",
    "B) Secre√ß√£o de horm√¥nios sexuais.",
    "C) Lubrifica√ß√£o do vest√≠bulo durante a excita√ß√£o sexual.",
    "D) Armazenamento de s√™men.",
  ],
  correctAnswer: "C) Lubrifica√ß√£o do vest√≠bulo durante a excita√ß√£o sexual.",
  comment: "Sua fun√ß√£o principal √© a lubrifica√ß√£o do vest√≠bulo durante a excita√ß√£o sexual.",
  topic: "Vest√≠bulo da Vagina - Gl√¢ndulas"
},
{
  question: "O que √© o H√≠men e onde ele se localiza?",
  options: [
    "A) Uma prega de pele que recobre o clit√≥ris.",
    "B) Um ligamento que sustenta o √∫tero.",
    "C) Uma prega de mucosa que pode ocluir o √≥stio da vagina.",
    "D) Uma gl√¢ndula localizada no vest√≠bulo.",
  ],
  correctAnswer: "C) Uma prega de mucosa que pode ocluir o √≥stio da vagina.",
  comment: "O √≥stio da vagina pode estar parcialmente ou totalmente oclu√≠do pelo h√≠men, uma prega de mucosa.",
  topic: "H√≠men"
} ];

    function buildQuiz() {
        const output = [];
        questions.forEach((currentQuestion, questionNumber) => {
            const options = [];
            for (let i = 0; i < currentQuestion.options.length; i++) {
                // Note o uso de ${...} para template literals do JS dentro da f-string
                options.push(
                    `<label class="option" data-question="${questionNumber}" data-value="${currentQuestion.options[i]}">
                        <img src="tesouras.png" class="scissor-icon" onclick="event.stopPropagation(); this.parentNode.classList.toggle('struck-through');">
                        ${currentQuestion.options[i]}
                    </label>`
                );
            }
            output.push(
                `<div class="card" id="question-${questionNumber}" data-topic="${currentQuestion.topic}">
                    <div class="question">${currentQuestion.question}</div>
                    <div class="options">${options.join("")}</div>
                    <div class="comment" id="comment-${questionNumber}"></div>
                </div>`
            );
        });
        quizContainer.innerHTML = output.join("");
    }

    function showResults() {
        wrongQuestionIndices = [];
        errorCountByTopic = {};
        totalAnsweredQuestionsByTopic = {};
        currentWrongQuestionIndex = -1;
        hasErrors = false;
        errorDiagnosisSection.style.display = 'none';
        topicsToReviewList.innerHTML = '';
        statusMessage.textContent = '';

        const allQuestionCards = document.querySelectorAll('.quiz-container .card, #newQuestionsContent .card');
        let correctAnswersCount = 0;
        let totalQuestionsAnswered = 0;

        allQuestionCards.forEach((card, index) => {
            const questionEl = card.querySelector('.question') || card.querySelector('p');
            if (!questionEl) return;
            
            const questionText = questionEl.textContent.trim();
            const optionsContainer = card.querySelector('.options') || card;
            const allOptions = optionsContainer.querySelectorAll('.option, label.option, label');
            const userAnswerElement = optionsContainer.querySelector('.option.selected, label.selected');
            const commentDiv = card.querySelector('.comment');
            const questionTopic = card.dataset.topic || "T√≥pico n√£o informado";

            // Limpa classes
            allOptions.forEach(option => { option.classList.remove('correct', 'incorrect', 'selected'); });
            if (commentDiv) commentDiv.classList.remove('show');

            let correctAnswerValue = null;
            let questionComment = null;

            // L√≥gica para Est√°ticas vs Din√¢micas
            const isStatic = card.id && card.id.startsWith('question-');
            if (isStatic) {
                const questionData = questions.find(q => q.question.trim() === questionText);
                if (questionData) {
                    correctAnswerValue = questionData.correctAnswer.trim();
                    questionComment = questionData.comment;
                }
            } else {
                const correctOpt = optionsContainer.querySelector('.option[data-answer="true"], label[data-answer="true"]');
                if (correctOpt) correctAnswerValue = correctOpt.dataset.value?.trim() || correctOpt.textContent.trim();
                
                const commentElement = card.querySelector('.comment');
                if (commentElement && commentElement.textContent.trim()) questionComment = commentElement.textContent.trim();
            }

            // Verifica resposta
            let userAnswer = null;
            if (userAnswerElement) {
                userAnswerElement.classList.add('selected');
                userAnswer = userAnswerElement.dataset.value?.trim() || userAnswerElement.textContent.trim();
                totalQuestionsAnswered++;
                totalAnsweredQuestionsByTopic[questionTopic] = (totalAnsweredQuestionsByTopic[questionTopic] || 0) + 1;

                if (userAnswer === correctAnswerValue) {
                    correctAnswersCount++;
                } else {
                    hasErrors = true;
                    errorCountByTopic[questionTopic] = (errorCountByTopic[questionTopic] || 0) + 1;
                }
            }

            // Pinta as op√ß√µes
            allOptions.forEach(option => {
                const optionValue = option.dataset.value?.trim() || option.textContent.trim();
                if (optionValue === correctAnswerValue) option.classList.add('correct');
                if (userAnswer && optionValue === userAnswer && userAnswer !== correctAnswerValue) option.classList.add('incorrect');
            });

            if (commentDiv && questionComment) {
                commentDiv.textContent = questionComment;
                commentDiv.classList.add('show');
            }
        });

        resultsContainer.textContent = `Voc√™ acertou ${correctAnswersCount} de ${totalQuestionsAnswered} quest√µes respondidas.`;

        // Diagn√≥stico
        if (hasErrors) {
            for (const topic in errorCountByTopic) {
                const errors = errorCountByTopic[topic];
                const total = totalAnsweredQuestionsByTopic[topic] || 0;
                if (total > 0) {
                    const percent = ((errors / total) * 100).toFixed(1);
                    const li = document.createElement('li');
                    li.textContent = `${topic}: ${percent}% de erros (${errors} de ${total} quest√µes)`;
                    topicsToReviewList.appendChild(li);
                }
            }
            errorDiagnosisSection.style.display = 'block';
            generatedQuestionsSection.style.display = 'block';
            generateNewQuestionsBtn.style.display = 'block';
            errorDiagnosisSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        } else {
            const li = document.createElement('li');
            li.textContent = "ü•≥ Parab√©ns! Voc√™ n√£o teve erros nas quest√µes respondidas.";
            topicsToReviewList.appendChild(li);
        }
    }

    // Listeners
    document.addEventListener("click", function (event) {
        const clickedElement = event.target;
        const optionElement = clickedElement.closest('.option');
        if (optionElement) {
            if (clickedElement.classList.contains("scissor-icon")) {
                event.stopPropagation();
                optionElement.classList.toggle("struck-through");
            } else {
                const parentCard = optionElement.closest('.card');
                const currentQuestionOptions = parentCard.querySelectorAll('.option');
                currentQuestionOptions.forEach(opt => opt.classList.remove("selected"));
                optionElement.classList.add("selected");
            }
        }
    });

    generateNewQuestionsBtn.addEventListener("click", async function() {
        statusMessage.textContent = '‚è≥ Gerando novas perguntas...';
        generateNewQuestionsBtn.disabled = true;
        
        const topics = Object.keys(errorCountByTopic).filter(topic => {
            const errorsInTopic = errorCountByTopic[topic] || 0;
            const totalAnsweredInTopic = totalAnsweredQuestionsByTopic[topic] || 0;
            return errorsInTopic > 0 && totalAnsweredInTopic > 0;
        });
        
        const topicsToSend = topics.length > 0 ? topics : ["fisiologia celular", "biologia"];

        try {
            const response = await fetch('https://www.quizia.xyz/quiz', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ topicos: topicsToSend }),
            });

            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            
            const data = await response.json();
            newQuestionsContent.innerHTML = '';

            if (data && data.html) {
                newQuestionsContent.innerHTML = data.html.replace(/```html|```/g, '');
                
                newQuestionsContent.querySelectorAll('.card').forEach((card) => {
                    // L√≥gica de limpeza e adi√ß√£o de tesouras (mantida igual)
                    const questionElement = card.querySelector('p');
                    if (questionElement && !questionElement.classList.contains('question')) questionElement.classList.add('question');
                    
                    card.querySelectorAll('label').forEach((label) => {
                        const radioInput = label.querySelector('input[type="radio"]');
                        if (radioInput) {
                            if (radioInput.hasAttribute('data-answer')) label.setAttribute('data-answer', radioInput.getAttribute('data-answer'));
                            radioInput.remove();
                        }
                        if (!label.classList.contains('option')) label.classList.add('option');
                        if (!label.dataset.value) label.dataset.value = label.textContent.trim();
                        if (!label.querySelector('.scissor-icon')) {
                            const scissorIcon = document.createElement('img');
                            scissorIcon.src = 'tesouras.png';
                            scissorIcon.className = 'scissor-icon';
                            scissorIcon.onclick = function(e) { e.stopPropagation(); label.classList.toggle('struck-through'); };
                            label.insertBefore(scissorIcon, label.firstChild);
                        }
                    });
                });
            } else {
                newQuestionsContent.innerHTML = "<p>N√£o foi poss√≠vel gerar novas perguntas.</p>";
            }
            
            generatedQuestionsSection.style.display = 'block';
            generatedQuestionsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            statusMessage.textContent = '‚úÖ Perguntas geradas com sucesso!';
            setTimeout(() => { statusMessage.textContent = '' }, 3000);
            
        } catch (error) {
            console.error('Erro:', error);
            statusMessage.textContent = '‚ùå Erro: ' + error.message;
            setTimeout(() => { statusMessage.textContent = '' }, 5000);
        } finally {
            generateNewQuestionsBtn.disabled = false;
        }
    });

    buildQuiz();
    document.getElementById("verifyAnswersBtn").addEventListener("click", showResults);
</script>
<script src="conexao_firebase.js"></script><script src="navegacao.js"></script><script type="module" src="padrao_simulado.js"></script>
</body>
</html>
